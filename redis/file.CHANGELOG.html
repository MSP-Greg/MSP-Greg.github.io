<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: CHANGELOG &mdash; Redis master</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "CHANGELOG",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Redis master</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: CHANGELOG&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<h1>Unreleased</h1>

<h1>5.2.0</h1>

<ul>
<li>Now require Ruby 2.6 because <code>redis-client</code> does.</li>
<li>Eagerly close subscribed connection when using <code>subscribe_with_timeout</code>. See #1259.</li>
<li>Add <code>exception</code> flag in <code>pipelined</code> allowing failed commands to be returned in the result array when set to <code>false</code>.</li>
</ul>

<h1>5.1.0</h1>

<ul>
<li><code>multi</code> now accept a <code>watch</code> keyword argument like <code>redis-client</code>. See #1236.</li>
<li><code>bitcount</code> and <code>bitpos</code> now accept a <code>scale:</code> argument on <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> 7+. See #1242</li>
<li>Added <code>expiretime</code> and <code>pexpiretime</code>. See #1248.</li>
</ul>

<h1>5.0.8</h1>

<ul>
<li>Fix <a href="Redis.html#without_reconnect-instance_method" title="Redis#without_reconnect (method)">Redis#without_reconnect</a> for sentinel clients. Fix #1212.</li>
<li>Add <code>sentinel_username</code>, <code>sentinel_password</code> for sentinel clients. Bump <code>redis-client</code> to <code>&gt;=0.17.0</code>. See #1213</li>
</ul>

<h1>5.0.7</h1>

<ul>
<li>Fix compatibility with <code>redis-client 0.15.0</code> when using <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> Sentinel. Fix #1209.</li>
</ul>

<h1>5.0.6</h1>

<ul>
<li>Wait for an extra <code>config.read_timeout</code> in blocking commands rather than an arbitrary 100ms. See #1175.</li>
<li>Treat ReadOnlyError as ConnectionError. See #1168.</li>
</ul>

<h1>5.0.5</h1>

<ul>
<li>Fix automatic disconnection when the process was forked. See #1157.</li>
</ul>

<h1>5.0.4</h1>

<ul>
<li>Cast <code>ttl</code> argument to integer in <code>expire</code>, <code>setex</code> and a few others.</li>
</ul>

<h1>5.0.3</h1>

<ul>
<li>Add <code>OutOfMemoryError</code> as a subclass of <code>CommandError</code></li>
</ul>

<h1>5.0.2</h1>

<ul>
<li>Fix <a href="Redis.html#close-instance_method" title="Redis#close (method)">Redis#close</a> to properly reset the fork protection check.</li>
</ul>

<h1>5.0.1</h1>

<ul>
<li>Added a fake <code>Redis::Connections.drivers</code> method to be compatible with older sidekiq versions.</li>
</ul>

<h1>5.0.0</h1>

<ul>
<li>Default client timeout decreased from 5 seconds to 1 second.</li>
<li>Eagerly and strictly cast Integer and Float parameters.</li>
<li>Allow to call <code>subscribe</code>, <code>unsubscribe</code>, <code>psubscribe</code> and <code>punsubscribe</code> from a subscribed client. See #1131.</li>
<li>Use <code>MD5</code> for hashing server nodes in <a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a>. This should improve keys distribution among servers. See #1089.</li>
<li>Changed <code>sadd</code> and <code>srem</code> to now always return an Integer.</li>
<li>Added <code>sadd?</code> and <code>srem?</code> which always return a Boolean.</li>
<li>Added support for <code>IDLE</code> paramter in <code>xpending</code>.</li>
<li>Cluster support has been moved to a <code>redis-clustering</code> companion gem.</li>
<li><code>select</code> no longer record the current database. If the client has to reconnect after <code>select</code> was used, it will reconnect to the original database.</li>
<li>Better support Float timeout in blocking commands. See #977.</li>
<li><a href="Redis.html#new-class_method" title="Redis.new (method)">Redis.new</a> will now raise an error if provided unknown options.</li>
<li>Removed positional timeout in blocking commands (<code>BLPOP</code>, etc). Timeout now must be passed as an option: <code>r.blpop(&quot;key&quot;, timeout: 2.5)</code></li>
<li>Removed <code>logger</code> option.</li>
<li>Removed <code>reconnect_delay_max</code> and <code>reconnect_delay</code>, you can pass precise sleep durations to <code>reconnect_attempts</code> instead.</li>
<li>Require Ruby 2.5+.</li>
<li>Removed the deprecated <code>queue</code> and <code>commit</code> methods. Use <code>pipelined</code> instead.</li>
<li>Removed the deprecated <code>Redis::Future#==</code>.</li>
<li>Removed the deprecated <code>pipelined</code> and <code>multi</code> signature. Commands now MUST be called on the block argument, not the original redis instance.</li>
<li>Removed <code>Redis.current</code>. You shouldn&#39;t assume there is a single global <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> connection, use a connection pool instead,
and libaries using Redis should accept a Redis instance (or connection pool) as a config. E.g. <code>MyLibrary.redis = Redis.new(...)</code>.</li>
<li>Removed the <code>synchrony</code> driver.</li>
<li>Removed <code>Redis.exists_returns_integer</code>, it&#39;s now always enabled.</li>
</ul>

<h1>4.8.1</h1>

<ul>
<li>Automatically reconnect after fork regardless of <code>reconnect_attempts</code></li>
</ul>

<h1>4.8.0</h1>

<ul>
<li>Introduce <code>sadd?</code> and <code>srem?</code> as boolean returning versions of <code>sadd</code> and <code>srem</code>.</li>
<li>Deprecate <code>sadd</code> and <code>srem</code> returning a boolean when called with a single argument.
To enable the redis 5.0 behavior you can set <code>Redis.sadd_returns_boolean = false</code>.</li>
<li>Deprecate passing <code>timeout</code> as a positional argument in blocking commands (<code>brpop</code>, <code>blop</code>, etc).</li>
</ul>

<h1>4.7.1</h1>

<ul>
<li>Gracefully handle OpenSSL 3.0 EOF Errors (<code>OpenSSL::SSL::SSLError: SSL_read: unexpected eof while reading</code>). See #1106
This happens frequently on heroku-22.</li>
</ul>

<h1>4.7.0</h1>

<ul>
<li>Support single endpoint architecture with SSL/TLS in cluster mode. See #1086.</li>
<li><code>zrem</code> and <code>zadd</code> act as noop when provided an empty list of keys. See #1097.</li>
<li>Support IPv6 URLs.</li>
<li>Add <a href="Redis.html#with-instance_method" title="Redis#with (method)">Redis#with</a> for better compatibility with <code>connection_pool</code> usage.</li>
<li>Fix the block form of <code>multi</code> called inside <code>pipelined</code>. Previously the <code>MUTLI/EXEC</code> wouldn&#39;t be sent. See #1073.</li>
</ul>

<h1>4.6.0</h1>

<ul>
<li>Deprecate <code>Redis.current</code>.</li>
<li>Deprecate calling commands on <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> inside <a href="Redis.html#pipelined-instance_method" title="Redis#pipelined (method)">Redis#pipelined</a>. See #1059.
<code>ruby
redis.pipelined do
redis.get(&quot;key&quot;)
end
</code></li>
</ul>

<p>should be replaced by:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_pipelined'>pipelined</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pipeline'>pipeline</span><span class='op'>|</span>
  <span class='id identifier rubyid_pipeline'>pipeline</span>.<span class='id identifier rubyid_get'>get</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span></code></pre>

<ul>
<li>Deprecate calling commands on <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> inside <code>Redis#multi</code>. See #1059.
<code>ruby
redis.multi do
redis.get(&quot;key&quot;)
end
</code></li>
</ul>

<p>should be replaced by:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_multi'>multi</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_transaction'>transaction</span><span class='op'>|</span>
  <span class='id identifier rubyid_transaction'>transaction</span>.<span class='id identifier rubyid_get'>get</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span></code></pre>

<ul>
<li><p>Deprecate <code>Redis#queue</code> and <code>Redis#commit</code>. See #1059.</p></li>
<li><p>Fix <code>zpopmax</code> and <code>zpopmin</code> when called inside a pipeline. See #1055.</p></li>
<li><p><a href="Redis.html#synchronize-instance_method" title="Redis#synchronize (method)">Redis#synchronize</a> is now private like it should always have been.</p></li>
<li><p>Add <a href="Redis.html#silence_deprecations=-class_method" title="Redis.silence_deprecations= (method)">Redis.silence_deprecations=</a> to turn off deprecation warnings.
If you don&#39;t wish to see warnings yet, you can set <code>Redis.silence_deprecations = true</code>.
It is however heavily recommended to fix them instead when possible.</p></li>
<li><p>Add <a href="Redis.html#raise_deprecations=-class_method" title="Redis.raise_deprecations= (method)">Redis.raise_deprecations=</a> to turn deprecation warnings into errors.
This makes it easier to identitify the source of deprecated APIs usage.
It is recommended to set <code>Redis.raise_deprecations = true</code> in development and test environments.</p></li>
<li><p>Add new options to ZRANGE. See #1053.</p></li>
<li><p>Add ZRANGESTORE command. See #1053.</p></li>
<li><p>Add SCAN support for <code>Redis::Cluster</code>. See #1049.</p></li>
<li><p>Add COPY command. See #1053. See #1048.</p></li>
<li><p>Add ZDIFFSTORE command. See #1046.</p></li>
<li><p>Add ZDIFF command. See #1044.</p></li>
<li><p>Add ZUNION command. See #1042.</p></li>
<li><p>Add HRANDFIELD command. See #1040.</p></li>
</ul>

<h1>4.5.1</h1>

<ul>
<li>Restore the accidential auth behavior of redis-rb 4.3.0 with a warning. If provided with the <code>default</code> user&#39;s password, but a wrong username,
redis-rb will first try to connect as the provided user, but then will fallback to connect as the <code>default</code> user with the provided password.
This behavior is deprecated and will be removed in Redis 4.6.0. Fix #1038.</li>
</ul>

<h1>4.5.0</h1>

<ul>
<li>Handle parts of the command using incompatible encodings. See #1037.</li>
<li>Add GET option to SET command. See #1036.</li>
<li>Add ZRANDMEMBER command. See #1035.</li>
<li>Add LMOVE/BLMOVE commands. See #1034.</li>
<li>Add ZMSCORE command. See #1032.</li>
<li>Add LT/GT options to ZADD. See #1033.</li>
<li>Add SMISMEMBER command. See #1031.</li>
<li>Add EXAT/PXAT options to SET. See #1028.</li>
<li>Add GETDEL/GETEX commands. See #1024.</li>
<li><code>Redis#exists</code> now returns an Integer by default, as warned since 4.2.0. The old behavior can be restored with <code>Redis.exists_returns_integer = false</code>.</li>
<li>Fix Redis &lt; 6 detection during connect. See #1025.</li>
<li>Fix fetching command details in <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> cluster when the first node is unhealthy. See #1026.</li>
</ul>

<h1>4.4.0</h1>

<ul>
<li><a href="Redis.html" title="Redis (class)"><code>Redis</code></a> cluster: fix cross-slot validation in pipelines. Fix ##1019.</li>
<li>Add support for <code>XAUTOCLAIM</code>. See #1018.</li>
<li>Properly issue <code>READONLY</code> when reconnecting to replicas. Fix #1017.</li>
<li>Make <code>del</code> a noop if passed an empty list of keys. See #998.</li>
<li>Add support for <code>ZINTER</code>. See #995.</li>
</ul>

<h1>4.3.1</h1>

<ul>
<li>Fix password authentication against redis server 5 and older.</li>
</ul>

<h1>4.3.0</h1>

<ul>
<li>Add the TYPE argument to scan and scan_each. See #985.</li>
<li>Support AUTH command for ACL. See #967.</li>
</ul>

<h1>4.2.5</h1>

<ul>
<li>Optimize the ruby connector write buffering. See #964.</li>
</ul>

<h1>4.2.4</h1>

<ul>
<li>Fix bytesize calculations in the ruby connector, and work on a copy of the buffer. Fix #961, #962.</li>
</ul>

<h1>4.2.3</h1>

<ul>
<li>Use io/wait instead of IO.select in the ruby connector. See #960.</li>
<li>Use exception free non blocking IOs in the ruby connector. See #926.</li>
<li>Prevent corruption of the client when an interrupt happen during inside a pipeline block. See #945.</li>
</ul>

<h1>4.2.2</h1>

<ul>
<li>Fix <code>WATCH</code> support for <a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a>. See #941.</li>
<li>Fix handling of empty stream responses. See #905, #929.</li>
</ul>

<h1>4.2.1</h1>

<ul>
<li>Fix <code>exists?</code> returning an actual boolean when called with multiple keys. See #918.</li>
<li>Setting <code>Redis.exists_returns_integer = false</code> disables warning message about new behaviour. See #920.</li>
</ul>

<h1>4.2.0</h1>

<ul>
<li>Convert commands to accept keyword arguments rather than option hashes. This both help catching typos, and reduce needless allocations.</li>
<li>Deprecate the synchrony driver. It will be removed in 5.0 and hopefully maintained as a separate gem. See #915.</li>
<li>Make <code>Redis#exists</code> variadic, will return an Integer if called with multiple keys.</li>
<li>Add <code>Redis#exists?</code> to get a Boolean if any of the keys exists.</li>
<li><code>Redis#exists</code> when called with a single key will warn that future versions will return an Integer.
Set <code>Redis.exists_returns_integer = true</code> to opt-in to the new behavior.</li>
<li>Support <code>keepttl</code> ooption in <code>set</code>. See #913.</li>
<li>Optimized initialization of Redis::Cluster. See #912.</li>
<li>Accept sentinel options even with string key. See #599.</li>
<li>Verify TLS connections by default. See #900.</li>
<li>Make <code>Redis#hset</code> variadic. It now returns an integer, not a boolean. See #910.</li>
</ul>

<h1>4.1.4</h1>

<ul>
<li>Alias <code>Redis#disconnect</code> as <code>#close</code>. See #901.</li>
<li>Handle clusters with multiple slot ranges. See #894.</li>
<li>Fix password authentication to a redis cluster. See #889.</li>
<li>Handle recursive MOVED responses. See #882.</li>
<li>Increase buffer size in the ruby connector. See #880.</li>
<li>Fix thread safety of <code>Redis.queue</code>. See #878.</li>
<li>Deprecate <code>Redis::Future#==</code> as it&#39;s likely to be a mistake. See #876.</li>
<li>Support <code>KEEPTTL</code> option for SET command. See #913.</li>
</ul>

<h1>4.1.3</h1>

<ul>
<li>Fix the client hanging forever when connecting with SSL to a non-SSL server. See #835.</li>
</ul>

<h1>4.1.2</h1>

<ul>
<li>Fix several authentication problems with sentinel. See #850 and #856.</li>
<li>Explicitly drop Ruby 2.2 support.</li>
</ul>

<h1>4.1.1</h1>

<ul>
<li>Fix error handling in multi blocks. See #754.</li>
<li>Fix geoadd to accept arrays like georadius and georadiusbymember. See #841.</li>
<li>Fix georadius command failing when long == lat. See #841.</li>
<li>Fix timeout error in xread block: 0. See #837.</li>
<li>Fix incompatibility issue with redis-objects. See #834.</li>
<li>Properly handle Errno::EADDRNOTAVAIL on connect.</li>
<li>Fix password authentication to sentinel instances. See #813.</li>
</ul>

<h1>4.1.0</h1>

<ul>
<li>Add Redis Cluster support. See #716.</li>
<li>Add streams support. See #799 and #811.</li>
<li>Add ZPOP* support. See #812.</li>
<li>Fix issues with integer-like objects as BPOP timeout</li>
</ul>

<h1>4.0.3</h1>

<ul>
<li>Fix raising command error for first command in pipeline. See #788.</li>
<li>Fix the gemspec to stop exposing a <code>build</code> executable. See #785.</li>
<li>Add <code>:reconnect_delay</code> and <code>:reconnect_delay_max</code> options. See #778.</li>
</ul>

<h1>4.0.2</h1>

<ul>
<li><p>Added <code>Redis#unlink</code>. See #766.</p></li>
<li><p><a href="Redis.html#new-class_method" title="Redis.new (method)">Redis.new</a> now accept a custom connector via <code>:connector</code>. See #591.</p></li>
<li><p><code>Redis#multi</code> no longer perform empty transactions. See #747.</p></li>
<li><p><code>Redis#hdel</code> now accepts hash keys as multiple arguments like <code>#del</code>. See #755.</p></li>
<li><p>Allow to skip SSL verification. See #745.</p></li>
<li><p>Add Geo commands: <code>geoadd</code>, <code>geohash</code>, <code>georadius</code>, <code>georadiusbymember</code>, <code>geopos</code>, <code>geodist</code>. See #730.</p></li>
</ul>

<h1>4.0.1</h1>

<ul>
<li><p><a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a> now supports <code>mget</code> and <code>mapped_mget</code>. See #687.</p></li>
<li><p><a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a> now supports <code>sscan</code> and <code>sscan_each</code>. See #572.</p></li>
<li><p><a href="Redis.html#connection-instance_method" title="Redis#connection (method)">Redis#connection</a> returns a hash with connection information.
You shouldn&#39;t need to call <a href="Redis.html#_client-instance_method" title="Redis#_client (method)">Redis#_client</a>, ever.</p></li>
<li><p><code>Redis#flushdb</code> and <code>Redis#flushall</code> now support the <code>:async</code> option. See #706.</p></li>
</ul>

<h1>4.0</h1>

<ul>
<li><p>Removed <code>Redis.connect</code>. Use <a href="Redis.html#new-class_method" title="Redis.new (method)">Redis.new</a>.</p></li>
<li><p>Removed <code>Redis#[]</code> and <code>Redis#[]=</code> aliases.</p></li>
<li><p>Added support for <code>CLIENT</code> commands. The lower-level client can be
accessed via <a href="Redis.html#_client-instance_method" title="Redis#_client (method)">Redis#_client</a>.</p></li>
<li><p>Dropped official support for Ruby &lt; 2.2.2.</p></li>
</ul>

<h1>3.3.5</h1>

<ul>
<li>Fixed Ruby 1.8 compatibility after backporting <a href="Redis.html#connection-instance_method" title="Redis#connection (method)">Redis#connection</a>. See #719.</li>
</ul>

<h1>3.3.4 (yanked)</h1>

<ul>
<li><a href="Redis.html#connection-instance_method" title="Redis#connection (method)">Redis#connection</a> returns a hash with connection information.
You shouldn&#39;t need to call <a href="Redis.html#_client-instance_method" title="Redis#_client (method)">Redis#_client</a>, ever.</li>
</ul>

<h1>3.3.3</h1>

<ul>
<li>Improved timeout handling after dropping Timeout module.</li>
</ul>

<h1>3.3.2</h1>

<ul>
<li><p>Added support for <code>SPOP</code> with COUNT. See #628.</p></li>
<li><p>Fixed connection glitches when using SSL. See #644.</p></li>
</ul>

<h1>3.3.1</h1>

<ul>
<li>Remove usage of Timeout::timeout, refactor into using low level non-blocking writes.
This fixes a memory leak due to Timeout creating threads on each invocation.</li>
</ul>

<h1>3.3.0</h1>

<ul>
<li><p>Added support for SSL/TLS. <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> doesn&#39;t support SSL natively, so you still
need to run a terminating proxy on Redis&#39; side. See #496.</p></li>
<li><p>Added <code>read_timeout</code> and <code>write_timeout</code> options. See #437, #482.</p></li>
<li><p>Added support for pub/sub with timeouts. See #329.</p></li>
<li><p>Added <code>Redis#call</code>, <code>Redis#queue</code> and <code>Redis#commit</code> as a more minimal API to
the client.</p></li>
<li><p>Deprecated <a href="Redis.html#disconnect!-instance_method" title="Redis#disconnect! (method)">Redis#disconnect!</a> in favor of <a href="Redis.html#close-instance_method" title="Redis#close (method)">Redis#close</a>.</p></li>
</ul>

<h1>3.2.2</h1>

<ul>
<li><p>Added support for <code>ZADD</code> options <code>NX</code>, <code>XX</code>, <code>CH</code>, <code>INCR</code>. See #547.</p></li>
<li><p>Added support for sentinel commands. See #556.</p></li>
<li><p>New <code>:id</code> option allows you to identify the client against <a href="Redis.html" title="Redis (class)"><code>Redis</code></a>. See #510.</p></li>
<li><p><a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a> will raise when adding two nodes with the same ID.
See #354.</p></li>
</ul>

<h1>3.2.1</h1>

<ul>
<li><p>Added support for <code>PUBSUB</code> command.</p></li>
<li><p>More low-level socket errors are now raised as <code>CannotConnectError</code>.</p></li>
<li><p>Added <code>:connect_timeout</code> option.</p></li>
<li><p>Added support for <code>:limit</code> option for <code>ZREVRANGEBYLEX</code>.</p></li>
<li><p>Fixed an issue where connections become inconsistent when using Ruby&#39;s
Timeout module outside of the client (see #501, #502).</p></li>
<li><p>Added <a href="Redis.html#disconnect!-instance_method" title="Redis#disconnect! (method)">Redis#disconnect!</a> as a public-API way of disconnecting the client
(without needing to use <code>QUIT</code>). See #506.</p></li>
<li><p>Fixed Sentinel support with Hiredis.</p></li>
<li><p>Fixed Sentinel support when using authentication and databases.</p></li>
<li><p>Improved resilience when trying to contact sentinels.</p></li>
</ul>

<h1>3.2.0</h1>

<ul>
<li><a href="Redis.html" title="Redis (class)"><code>Redis</code></a> Sentinel support.</li>
</ul>

<h1>3.1.0</h1>

<ul>
<li><p>Added debug log sanitization (#428).</p></li>
<li><p>Added support for HyperLogLog commands (Redis 2.8.9, #432).</p></li>
<li><p>Added support for <code>BITPOS</code> command (Redis 2.9.11, #412).</p></li>
<li><p>The client will now automatically reconnect after a fork (#414).</p></li>
<li><p>If you want to disable the fork-safety check and prefer to share the
connection across child processes, you can now pass the <code>inherit_socket</code>
option (#409).</p></li>
<li><p>If you want the client to attempt to reconnect more than once, you can now
pass the <code>reconnect_attempts</code> option (#347)</p></li>
</ul>

<h1>3.0.7</h1>

<ul>
<li><p>Added method <a href="Redis.html#dup-instance_method" title="Redis#dup (method)">Redis#dup</a> to duplicate a <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> connection.</p></li>
<li><p>IPv6 support.</p></li>
</ul>

<h1>3.0.6</h1>

<ul>
<li>Added support for <code>SCAN</code> and variants.</li>
</ul>

<h1>3.0.5</h1>

<ul>
<li><p>Fix calling #select from a pipeline (#309).</p></li>
<li><p>Added method <a href="Redis.html#connected%3F-instance_method" title="Redis#connected? (method)">Redis#connected?</a>.</p></li>
<li><p>Added support for <code>MIGRATE</code> (Redis 2.6).</p></li>
<li><p>Support extended SET command (#343, thanks to @benubois).</p></li>
</ul>

<h1>3.0.4</h1>

<ul>
<li><p>Ensure #watch without a block returns &quot;OK&quot; (#332).</p></li>
<li><p>Make futures identifiable (#330).</p></li>
<li><p>Fix an issue preventing STORE in a SORT with multiple GETs (#328).</p></li>
</ul>

<h1>3.0.3</h1>

<ul>
<li><p>Blocking list commands (<code>BLPOP</code>, <code>BRPOP</code>, <code>BRPOPLPUSH</code>) use a socket
timeout equal to the sum of the command&#39;s timeout and the Redis
client&#39;s timeout, instead of disabling socket timeout altogether.</p></li>
<li><p>Ruby 2.0 compatibility.</p></li>
<li><p>Added support for <code>DUMP</code> and <code>RESTORE</code> (Redis 2.6).</p></li>
<li><p>Added support for <code>BITCOUNT</code> and <code>BITOP</code> (Redis 2.6).</p></li>
<li><p>Call <code>#to_s</code> on value argument for <code>SET</code>, <code>SETEX</code>, <code>PSETEX</code>, <code>GETSET</code>,
<code>SETNX</code>, and <code>SETRANGE</code>.</p></li>
</ul>

<h1>3.0.2</h1>

<ul>
<li><p>Unescape CGI escaped password in URL.</p></li>
<li><p>Fix test to check availability of <code>UNIXSocket</code>.</p></li>
<li><p>Fix handling of score = +/- infinity for sorted set commands.</p></li>
<li><p>Replace array splats with concatenation where possible.</p></li>
<li><p>Raise if <code>EXEC</code> returns an error.</p></li>
<li><p>Passing a nil value in options hash no longer overwrites the default.</p></li>
<li><p>Allow string keys in options hash passed to <a href="Redis.html#new-class_method" title="Redis.new (method)">Redis.new</a> or
<code>Redis.connect</code>.</p></li>
<li><p>Fix uncaught error triggering unrelated error (synchrony driver).</p>

<p>See f7ffd5f1a628029691084de69e5b46699bb8b96d and #248.</p></li>
</ul>

<h1>3.0.1</h1>

<ul>
<li><p>Fix reconnect logic not kicking in on a write error.</p>

<p>See 427dbd52928af452f35aa0a57b621bee56cdcb18 and #238.</p></li>
</ul>

<h1>3.0.0</h1>

<h3>Upgrading from 2.x to 3.0</h3>

<p>The following items are the most important changes to review when
upgrading from redis-rb 2.x. A full list of changes can be found below.</p>

<ul>
<li><p>The methods for the following commands have changed the arguments they
take, their return value, or both.</p>

<ul>
<li><code>BLPOP</code>, <code>BRPOP</code>, <code>BRPOPLPUSH</code></li>
<li><code>SORT</code></li>
<li><code>MSETNX</code></li>
<li><code>ZRANGE</code>, <code>ZREVRANGE</code>, <code>ZRANGEBYSCORE</code>, <code>ZREVRANGEBYSCORE</code></li>
<li><code>ZINCRBY</code>, <code>ZSCORE</code></li>
</ul></li>
<li><p>The return value from <code>#pipelined</code> and <code>#multi</code> no longer contains
unprocessed replies, but the same replies that would be returned if
the command had not been executed in these blocks.</p></li>
<li><p>The client raises custom errors on connection errors, instead of
<code>RuntimeError</code> and errors in the <code>Errno</code> family.</p></li>
</ul>

<h3>Changes</h3>

<ul>
<li><p>Added support for scripting commands (Redis 2.6).</p>

<p>Scripts can be executed using <code>#eval</code> and <code>#evalsha</code>. Both can
commands can either take two arrays to specify <code>KEYS</code> and <code>ARGV</code>, or
take a hash containing <code>:keys</code> and <code>:argv</code> to specify <code>KEYS</code> and
<code>ARGV</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_eval'>eval</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>return ARGV[1] * ARGV[2]</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_argv'>argv</span> <span class='op'>=&gt;</span> [<span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>])
  <span class='comment'># =&gt; 6</span></code></pre>

<p>Subcommands of the <code>SCRIPT</code> command can be executed via the
<code>#script</code> method.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_script'>script</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_load'>load</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>return ARGV[1] * ARGV[2]</span><span class='tstring_end'>&quot;</span></span>)
  <span class='comment'># =&gt; &quot;58db5d365a1922f32e7aa717722141ea9c2b0cf3&quot;
</span><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_script'>script</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_exists'>exists</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>58db5d365a1922f32e7aa717722141ea9c2b0cf3</span><span class='tstring_end'>&quot;</span></span>)
  <span class='comment'># =&gt; true
</span><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_script'>script</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_flush'>flush</span>)
  <span class='comment'># =&gt; &quot;OK&quot;</span></code></pre></li>
<li><p>The repository now lives at <a href="https://github.com/redis/redis-rb">https://github.com/redis/redis-rb</a>.
Thanks, Ezra!</p></li>
<li><p>Added support for <code>PEXPIRE</code>, <code>PEXPIREAT</code>, <code>PTTL</code>, <code>PSETEX</code>,
<code>INCRYBYFLOAT</code>, <code>HINCRYBYFLOAT</code> and <code>TIME</code> (Redis 2.6).</p></li>
<li><p><code>Redis.current</code> is now thread unsafe, because the client itself is thread safe.</p>

<p>In the future you&#39;ll be able to do something like:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span>.<span class='id identifier rubyid_current'>current</span> <span class='op'>=</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'>Pool</span>.<span class='id identifier rubyid_connect'>connect</span></code></pre>

<p>This makes <code>Redis.current</code> actually usable in multi-threaded environments,
while not affecting those running a single thread.</p></li>
<li><p>Change API for <code>BLPOP</code>, <code>BRPOP</code> and <code>BRPOPLPUSH</code>.</p>

<p>Both <code>BLPOP</code> and <code>BRPOP</code> now take a single argument equal to a
string key, or an array with string keys, followed by an optional
hash with a <code>:timeout</code> key. When not specified, the timeout defaults
to <code>0</code> to not time out.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_blpop'>blpop</span>([<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list2</span><span class='tstring_end'>&quot;</span></span>]<span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=&gt;</span> <span class='float'>1.0</span>)</code></pre>

<p><code>BRPOPLPUSH</code> also takes an optional hash with a <code>:timeout</code> key as
last argument for consistency. When not specified, the timeout
defaults to <code>0</code> to not time out.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_brpoplpush'>brpoplpush</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>some_list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>another_list</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=&gt;</span> <span class='float'>1.0</span>)</code></pre></li>
<li><p>When <code>SORT</code> is passed multiple key patterns to get via the <code>:get</code>
option, it now returns an array per result element, holding all <code>GET</code>
substitutions.</p></li>
<li><p>The <code>MSETNX</code> command now returns a boolean.</p></li>
<li><p>The <code>ZRANGE</code>, <code>ZREVRANGE</code>, <code>ZRANGEBYSCORE</code> and <code>ZREVRANGEBYSCORE</code> commands
now return an array containing <code>[String, Float]</code> pairs when
<code>:with_scores =&gt; true</code> is passed.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_redis'>redis</span>.<span class='id identifier rubyid_zrange'>zrange</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>zset</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='op'>-</span><span class='int'>1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_with_scores'>with_scores</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>)
  <span class='comment'># =&gt; [[&quot;foo&quot;, 1.0], [&quot;bar&quot;, 2.0]]</span></code></pre></li>
<li><p>The <code>ZINCRBY</code> and <code>ZSCORE</code> commands now return a <code>Float</code> score instead
of a string holding a representation of the score.</p></li>
<li><p>The client now raises custom exceptions where it makes sense.</p>

<p>If by any chance you were rescuing low-level exceptions (<code>Errno::*</code>),
you should now rescue as follows:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNRESET</span>    <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/ConnectionError.html" title="Redis::ConnectionError (class)">ConnectionError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>EPIPE</span>         <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/ConnectionError.html" title="Redis::ConnectionError (class)">ConnectionError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNABORTED</span>  <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/ConnectionError.html" title="Redis::ConnectionError (class)">ConnectionError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>EBADF</span>         <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/ConnectionError.html" title="Redis::ConnectionError (class)">ConnectionError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>EINVAL</span>        <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/ConnectionError.html" title="Redis::ConnectionError (class)">ConnectionError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>EAGAIN</span>        <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/TimeoutError.html" title="Redis::TimeoutError (class)">TimeoutError</a></span>
<span class='const'>Errno</span><span class='op'>::</span><span class='const'>ECONNREFUSED</span>  <span class='tlambda'>-&gt;</span> <span class='const'><a href="Redis.html" title="Redis (class)">Redis</a></span><span class='op'>::</span><span class='const'><a href="Redis/CannotConnectError.html" title="Redis::CannotConnectError (class)">CannotConnectError</a></span></code></pre></li>
<li><p>Always raise exceptions originating from erroneous command invocation
inside pipelines and MULTI/EXEC blocks.</p>

<p>The old behavior (swallowing exceptions) could cause application bugs
to go unnoticed.</p></li>
<li><p>Implement futures for assigning values inside pipelines and MULTI/EXEC
blocks. Futures are assigned their value after the pipeline or
MULTI/EXEC block has executed.</p>

<pre class="code ruby"><code class="ruby"><span class='gvar'>$redis</span>.<span class='id identifier rubyid_pipelined'>pipelined</span> <span class='kw'>do</span>
  <span class='ivar'>@future</span> <span class='op'>=</span> <span class='gvar'>$redis</span>.<span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>key</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>

<span class='id identifier rubyid_puts'>puts</span> <span class='ivar'>@future</span>.<span class='id identifier rubyid_value'>value</span></code></pre></li>
<li><p>Ruby 1.8.6 is officially not supported.</p></li>
<li><p>Support <code>ZCOUNT</code> in <a href="Redis/Distributed.html" title="Redis::Distributed (class)"><code>::Redis::Distributed</code></a> (Michael Dungan).</p></li>
<li><p>Pipelined commands now return the same replies as when called outside
a pipeline.</p>

<p>In the past, pipelined replies were returned without post-processing.</p></li>
<li><p>Support <code>SLOWLOG</code> command (Michael Bernstein).</p></li>
<li><p>Calling <code>SHUTDOWN</code> effectively disconnects the client (Stefan Kaes).</p></li>
<li><p>Basic support for mapping commands so that they can be renamed on the
server.</p></li>
<li><p>Connecting using a URL now checks that a host is given.</p>

<p>It&#39;s just a small sanity check, cf. #126</p></li>
<li><p>Support variadic commands introduced in <a href="Redis.html" title="Redis (class)"><code>Redis</code></a> 2.4.</p></li>
</ul>

<h1>2.2.2</h1>

<ul>
<li>Added method <a href="Redis/Distributed.html#hsetnx-instance_method" title="Redis::Distributed#hsetnx (method)">Redis::Distributed#hsetnx</a>.</li>
</ul>

<h1>2.2.1</h1>

<ul>
<li><p>Internal API: Client#call and family are now called with a single array
argument, since splatting a large number of arguments (100K+) results in a
stack overflow on 1.9.2.</p></li>
<li><p>The <code>INFO</code> command can optionally take a subcommand. When the subcommand is
<code>COMMANDSTATS</code>, the client will properly format the returned statistics per
command. Subcommands for <code>INFO</code> are available since Redis v2.3.0 (unstable).</p></li>
<li><p>Change <code>IO#syswrite</code> back to the buffered <code>IO#write</code> since some Rubies do
short writes for large (1MB+) buffers and some don&#39;t (see issue #108).</p></li>
</ul>

<h1>2.2.0</h1>

<ul>
<li><p>Added method <a href="Redis.html#without_reconnect-instance_method" title="Redis#without_reconnect (method)">Redis#without_reconnect</a> that ensures the client will not try
to reconnect when running the code inside the specified block.</p></li>
<li><p>Thread-safe by default. Thread safety can be explicitly disabled by passing
<code>:thread_safe =&gt; false</code> as argument.</p></li>
<li><p>Commands called inside a MULTI/EXEC no longer raise error replies, since a
successful EXEC means the commands inside the block were executed.</p></li>
<li><p>MULTI/EXEC blocks are pipelined.</p></li>
<li><p>Don&#39;t disconnect on error replies.</p></li>
<li><p>Use <code>IO#syswrite</code> instead of <code>IO#write</code> because write buffering is not
necessary.</p></li>
<li><p>Connect to a unix socket by passing the <code>:path</code> option as argument.</p></li>
<li><p>The timeout value is coerced into a float, allowing sub-second timeouts.</p></li>
<li><p>Accept both <code>:with_scores</code> <em>and</em> <code>:withscores</code> as argument to sorted set
commands.</p></li>
<li><p>Use <a href="https://github.com/pietern/hiredis-rb">hiredis</a> (v0.3 or higher) by
requiring &quot;redis/connection/hiredis&quot;.</p></li>
<li><p>Use <a href="https://github.com/igrigorik/em-synchrony">em-synchrony</a> by requiring
&quot;redis/connection/synchrony&quot;.</p></li>
</ul>

<h1>2.1.1</h1>

<p>See commit log.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>