<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: CGI::Session &mdash; cgi Ruby-2.3.2 p139</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/custom.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/common.css' />

<script type='text/javascript'>
  var pathId = "CGI::Session",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
  <svg id='y_wait' class='' viewBox='0 0 90 90'></svg>
  <div id='tbl_cont'>
    <div id='y_list' class='d h'>
      <button id='list_sizer' class='y_sizer' title='LIST Resizer'></button>
      <header id='list_header'>
        <div id='list_title'>&#160;</div>
        <div id='list_menu'><span>&#160;</span></div>
        <input  id='list_search_text' type='search' placeholder='Search' size='12' value='' autocomplete='off' class='search_input'/>
        <svg id='list_search_icon' viewBox='0 0 30 30'>
          <path class='s_main' d='M21.189,17.213C22.022,15.726,22.5,14.014,22.5,12.188C22.5,6.493,17.884,1.875,12.188,1.875S1.875,6.493,1.875,12.188C1.875,17.882,6.491,22.5,12.188,22.5c1.826,0,3.536-0.48,5.025-1.311l6.113,6.113C23.873,27.851,24.593,28.125,25.313,28.125s1.44-0.274,1.989-0.823c1.099-1.099,1.099-2.878,0-3.977L21.189,17.213z M12.188,19.329c-3.943,0-7.14-3.197-7.14-7.142c0.0-3.943,3.197-7.14,7.14-7.14c3.941,0,7.14,3.195,7.14,7.14C19.328,16.133,16.129,19.329,12.188,19.329z'/>
          <path class='s_clear' d='M 4.414, 1.586 A 1,1 0 1,0 1.586, 4.414 L 21.586,24.414 A 1,1 0 1,0 24.414,21.586 z' />
          <path class='s_clear' d='M 1.586,21.586 A 1,1 0 1,0 4.414,24.414 L 24.414, 4.414 A 1,1 0 1,0 21.586, 1.586 z' />
        </svg>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All'></button>
      </header>
      <nav id= 'list_nav' class='y_nav l_nav'>
        <ul id='list_items'></ul>
      </nav>
    </div>
    <div id='y_toc' class='f h'>
      <button id='toc_sizer' class='y_sizer' title='TOC Resizer'></button>
      <header id='toc_header'>
        <div>Table of Contents</div>
        <button class='y_minus' title='Collapse All'></button>
        <button class='y_plus' title='Expand All' ></button>
      </header>
      <nav id= 'toc_nav' class='y_nav t_nav'>
      <ol id='toc_items'></ol>
      </nav>
    </div>
    <div id='y_main' tabindex='-1'>
      <header id='y_header'>
        <div id='y_menu'>
          <a href='../../../index.html'>Home</a> &raquo; 
          <a href='../../index.html'>Ruby-2.3.2</a> &raquo; 
          <a href='../index.html'>cgi</a> &raquo; 
          <a href='../_index.html'>Index (S)</a> &raquo; 
          <a href="../CGI.html" title="CGI (class)">CGI</a> &raquo; 
          <span class='title'>Session</span>
        </div>

        <div id='y_measure_em' class='y_measure'></div>
        <div id='y_measure_vh' class='y_measure'></div>
        <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
        <a id='list_href' href="../class_list.html"></a>
        <div id='hdr_button'>
          <button id='src' class='c' title='Source Show / Hide'>S<svg class='c' viewBox='0 0 36 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
              <rect x='20' y='0'  width='4'  height='28' rx='1.0' ry='1.0'/>
            </svg><svg class='o' viewBox='0 0 34 28'>
              <rect x='8'  y='12' width='28' height='4'  rx='1.0' ry='1.0'/>
            </svg></button>
          <button id='list_loc' class='d' title='LIST Location'>L<svg class='f' viewBox='0 0 36 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='toc_loc' class='f' title='TOC Location'>T<svg class='f' viewBox='0 0 34 28'>
            <path d='M36 0 L36 28 8 14'/></svg><svg class='d' viewBox='0 0 36 28'><path d='M 8 0 L36 14 8 28'/></svg></button>
          <button id='list_vis' title='LIST Show / Hide'>LIST</button>
          <button id='toc_vis' title='TOC Show / Hide'>TOC</button>
        </div>
        <div id='y_debug'></div>
      </header>
<div id='content' class='class'>

<h1>Class: CGI::Session</h1>

<table class='y_box'>
<colgroup>
  <col class='box_1' />
  <col class='box_2' />
</colgroup>
  <tr>
    <td class='box_1'>Inherits:</td>
    <td class='box_rel'>
      <span class='inheritName'>Object</span>
      <ul class='fullTree'>
        <li>Object</li>
        <li class='next'>CGI::Session</li>
      </ul>
      <a href='#' class='inheritanceTree'>show all</a>
    </td>
  </tr>

  <tr>
    <td class='box_1'>Child Classes:</td>
    <td>
      <a href="Session/FileStore.html" title="CGI::Session::FileStore (class)">FileStore</a>,
    <a href="Session/MemoryStore.html" title="CGI::Session::MemoryStore (class)">MemoryStore</a>,
    <a href="Session/NullStore.html" title="CGI::Session::NullStore (class)">NullStore</a>,
    <a href="Session/PStore.html" title="CGI::Session::PStore (class)">PStore</a>
    </td>
  </tr>
  <tr>
    <td class='box_1'>Child Exceptions:</td>
    <td>
      <a href="Session/NoSession.html" title="CGI::Session::NoSession (class)">NoSession</a>
    </td>
  </tr>




  <tr>
  <td class='box_1'>Defined in:</td>
  <td class='box_rel'><div class='box_min'>
<a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L151'>lib/cgi/session.rb</a><span class='defines'>,<br /><a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session/pstore.rb#L17'>lib/cgi/session/pstore.rb</a></span>
</div>  </td>
  </tr>
</table>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This file provides the <a href="" title="CGI::Session (class)">Session</a> class, which provides session support
for CGI scripts.  A session is a sequence of HTTP requests and responses
linked together and associated with a single client. Information associated
with the session is stored on the server between requests.  A session id is
passed between client and server with every request and response,
transparently to the user.  This adds state information to the otherwise
stateless HTTP request/response protocol.</p>

<h3 id="label-Lifecycle">Lifecycle</h3>

<p>A <a href="" title="CGI::Session (class)">Session</a> instance is created from a CGI object.  By default, this
<a href="" title="CGI::Session (class)">Session</a> instance will start a new session if none currently exists,
or continue the current session for this client if one does exist.  The
<code>new_session</code> option can be used to either always or never
create a new session.  See <code>#new</code>() for more details.</p>

<p><a href="#delete-instance_method" title="CGI::Session#delete (method)">#delete</a>() deletes a session from session storage.  It does not however
remove the session id from the client.  If the client makes another request
with the same id, the effect will be to start a new session with the old
session&#39;s id.</p>

<h3 id="label-Setting+and+retrieving+session+data.">Setting and retrieving session data.</h3>

<p>The Session class associates data with a session as key-value pairs. This
data can be set and retrieved by indexing the Session instance using
&#39;[]&#39;, much the same as hashes (although other hash methods are not
supported).</p>

<p>When session processing has been completed for a request, the session
should be closed using the close() method.  This will store the
session&#39;s state to persistent storage.  If you want to store the
session&#39;s state to persistent storage without finishing session
processing for this request, call the update() method.</p>

<h3 id="label-Storing+session+state">Storing session state</h3>

<p>The caller can specify what form of storage to use for the session&#39;s
data with the <code>database_manager</code> option to <a href="" title="CGI::Session (class)">Session</a>::new. 
The following storage classes are provided as part of the standard library:</p>
<dl class="rdoc-list note-list"><dt><a href="Session/FileStore.html" title="CGI::Session::FileStore (class)">FileStore</a>
<dd>
<p>stores data as plain text in a flat file.  Only</p>
</dd></dl>

<pre class="code ruby"><code class="ruby">works with String data.  This is the default
storage type.</code></pre>
<dl class="rdoc-list note-list"><dt><a href="Session/MemoryStore.html" title="CGI::Session::MemoryStore (class)">MemoryStore</a>
<dd>
<p>stores data in an in-memory hash.  The data</p>
</dd></dl>

<pre class="code ruby"><code class="ruby">only persists for as long as the current Ruby
interpreter instance does.</code></pre>
<dl class="rdoc-list note-list"><dt><a href="Session/PStore.html" title="CGI::Session::PStore (class)">PStore</a>
<dd>
<p>stores data in Marshalled format.  Provided by</p>
</dd></dl>

<pre class="code ruby"><code class="ruby">cgi/session/pstore.rb.  Supports data of any type,
and provides file-locking and transaction support.</code></pre>

<p>Custom storage types can also be created by defining a class with the
following methods:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
<span class='id identifier rubyid_restore'>restore</span>  <span class='comment'># returns hash of session data.
</span><span class='id identifier rubyid_update'>update</span>
<span class='id identifier rubyid_close'>close</span>
<span class='id identifier rubyid_delete'>delete</span>
</code></pre>

<p>Changing storage type mid-session does not work.  Note in particular that
by default the FileStore and PStore session data files have the same name. 
If your application switches from one to the other without making sure that
filenames will be different and clients still have old sessions lying
around in cookies, then things will break nastily!</p>

<h3 id="label-Maintaining+the+session+id.">Maintaining the session id.</h3>

<p>Most session state is maintained on the server.  However, a session id must
be passed backwards and forwards between client and server to maintain a
reference to this session state.</p>

<p>The simplest way to do this is via cookies.  The <a href="" title="CGI::Session (class)">Session</a> class
provides transparent support for session id communication via cookies if
the client has cookies enabled.</p>

<p>If the client has cookies disabled, the session id must be included as a
parameter of all requests sent by the client to the server.  The
<a href="" title="CGI::Session (class)">Session</a> class in conjunction with the CGI class will transparently
add the session id as a hidden input field to all forms generated using the
#form() HTML generation method.  No built-in support is provided for
other mechanisms, such as URL re-writing.  The caller is responsible for
extracting the session id from the session_id attribute and manually
encoding it in URLs and adding it as a hidden input to HTML forms created
by other mechanisms.  Also, session expiry is not automatically handled.</p>

<h3 id="label-Examples+of+use">Examples of use</h3>

<h4 id="label-Setting+the+user-27s+name">Setting the user&#39;s name</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cgi</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cgi/session</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cgi/session/pstore</span><span class='tstring_end'>&#39;</span></span>     <span class='comment'># provides CGI::Session::PStore
</span>
<span class='id identifier rubyid_cgi'>cgi</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="../CGI.html#new-class_method" title="CGI.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>html4</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='op'>::</span><span class='const'>Session</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="CGI::Session.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_cgi'>cgi</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>database_manager</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='op'>::</span><span class='const'>Session</span><span class='op'>::</span><span class='const'><a href="Session/PStore.html" title="CGI::Session::PStore (class)">PStore</a></span><span class='comma'>,</span>  <span class='comment'># use PStore
</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_key</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_rb_sess_id</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>              <span class='comment'># custom session key
</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_expires</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='int'>30</span> <span class='op'>*</span> <span class='int'>60</span><span class='comma'>,</span>     <span class='comment'># 30 minute timeout
</span>    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>pstore_sid_</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>                   <span class='comment'># PStore option
</span><span class='kw'>if</span> <span class='id identifier rubyid_cgi'>cgi</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_cgi'>cgi</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># coerce to String: cgi[] returns the
</span>    <span class='comment'># string-like CGI::QueryExtension::Value
</span>    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cgi'>cgi</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>user_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>guest</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>

<h4 id="label-Creating+a+new+session+safely">Creating a new session safely</h4>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cgi</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cgi/session</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_cgi'>cgi</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="../CGI.html#new-class_method" title="CGI.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>html4</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

<span class='comment'># We make sure to delete an old session if one exists,
</span><span class='comment'># not just to free resources, but to prevent the session
</span><span class='comment'># from being maliciously hijacked later on.
</span><span class='kw'>begin</span>
    <span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='op'>::</span><span class='const'>Session</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="CGI::Session.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_cgi'>cgi</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new_session</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
<span class='kw'>rescue</span> <span class='const'>ArgumentError</span>  <span class='comment'># if no old session
</span><span class='kw'>end</span>
<span class='id identifier rubyid_session'>session</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='op'>::</span><span class='const'>Session</span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="#new-class_method" title="CGI::Session.new (method)">new</a></span><span class='lparen'>(</span><span class='id identifier rubyid_cgi'>cgi</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new_session</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='id identifier rubyid_session'>session</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>


<h2>Instance Attribute Summary <small><a href='#' class='summary_toggle'>collapse</a></small></h2>

  <ul class="summary">
    <li>
      <span class="summary_signature">
        <a href="#new_session-instance_method" title="#new_session (instance method)">#<strong>new_session</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The id of this session.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#session_id-instance_method" title="#session_id (instance method)">#<strong>session_id</strong>  </a>
      </span>
      <span class='note title readonly'>readonly</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>The id of this session.</p>
</div>
      </span>
    </li>
  </ul>


<h2>Class Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(request, option = {})  &#x21d2; Session </a>
      </span>
      <span class='note title constructor'>constructor</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Create a new <a href="" title="CGI::Session (class)">Session</a> object for <code>request</code>.</p>
</div>
      </span>
    </li>
  </ul>
<h2>Instance Method Summary
  <small><a href='#' class='summary_toggle'>collapse</a></small>
</h2>

  <ul class='summary'>
    <li>
      <span class="summary_signature">
        <a href="#%5B%5D-instance_method" title="#[] (instance method)">#<strong>[]</strong>(key)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Retrieve the session data for key <code>key</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#%5B%5D%3D-instance_method" title="#[]= (instance method)">#<strong>[]=</strong>(key, val)  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Set the session data for key <code>key</code>.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Store session data on the server and close the session storage.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#create_new_id-instance_method" title="#create_new_id (instance method)">#<strong>create_new_id</strong>  </a>
      </span>
      <span class='note title private'>private</span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Create a new session id.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Delete the session from storage.</p>
</div>
      </span>
    </li>
    <li>
      <span class="summary_signature">
        <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>  </a>
      </span>
      <span class='summary_desc'>
        <div class='inline'>
<p>Store session data on the server.</p>
</div>
      </span>
    </li>
  </ul>


<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>
  <section class='method_details first' id="new-class_method">
  <h3 class='signature first'>
  .<strong>new</strong>(request, option = {})  &#x21d2; <tt><a href="" title="CGI::Session (class)">Session</a></tt> 
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Create a new <a href="" title="CGI::Session (class)">CGI::Session</a> object for <code>request</code>.</p>

<p><code>request</code> is an instance of the <a href="../CGI.html" title="CGI (class)">CGI</a> class (see cgi.rb).
<code>option</code> is a hash of options for initialising this
<a href="" title="CGI::Session (class)">CGI::Session</a> instance.  The following options are recognised:</p>
<dl class="rdoc-list note-list"><dt>session_key
<dd>
<p>the parameter name used for the session id. Defaults to
&#39;_session_id&#39;.</p>
</dd><dt>session_id
<dd>
<p>the session id to use.  If not provided, then it is retrieved from the
<code>session_key</code> parameter of the request, or automatically
generated for a new session.</p>
</dd><dt>new_session
<dd>
<p>if true, force creation of a new session.  If not set, a new session is
only created if none currently exists.  If false, a new session is never
created, and if none currently exists and the <code>session_id</code>
option is not set, an ArgumentError is raised.</p>
</dd><dt>database_manager
<dd>
<p>the name of the class providing storage facilities for session state
persistence.  Built-in support is provided for <code>FileStore</code> (the
default), <code>MemoryStore</code>, and <code>PStore</code> (from
cgi/session/pstore.rb).  See the documentation for these classes for more
details.</p>
</dd></dl>

<p>The following options are also recognised, but only apply if the session id
is stored in a cookie.</p>
<dl class="rdoc-list note-list"><dt>session_expires
<dd>
<p>the time the current session expires, as a <code>Time</code> object.  If
not set, the session will terminate when the user&#39;s browser is closed.</p>
</dd><dt>session_domain
<dd>
<p>the hostname domain for which this session is valid. If not set, defaults
to the hostname of the server.</p>
</dd><dt>session_secure
<dd>
<p>if <code>true</code>, this session will only work over HTTPS.</p>
</dd><dt>session_path
<dd>
<p>the path for which this session applies.  Defaults to the directory of the
CGI script.</p>
</dd></dl>

<p><code>option</code> is also passed on to the session storage class
initializer; see the documentation for each session storage class for the
options they support.</p>

<p>The retrieved or created session is automatically added to
<code>request</code> as a cookie, and also to its
<code>output_hidden</code> table, which is used to add hidden input
elements to forms.</p>

<p><strong>WARNING</strong> the <code>output_hidden</code> fields are
surrounded by a &lt;fieldset&gt; tag in HTML 4 generation, which is
<em>not</em> invisible on many browsers; you may wish to disable the use of
fieldsets with code similar to the following (see <a
href="http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-list/37805">blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-list/37805</a>)</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_cgi'>cgi</span> <span class='op'>=</span> <span class='const'><a href="../CGI.html" title="CGI (class)">CGI</a></span><span class='period'>.</span><span class='id identifier rubyid_new'><a href="../CGI.html#new-class_method" title="CGI.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>html4</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>class</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cgi'>cgi</span>
    <span class='id identifier rubyid_undef_method'>undef_method</span> <span class='symbol'>:fieldset</span>
<span class='kw'>end</span>
</code></pre>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L248'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 248</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_option'>option</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='ivar'>@new_session</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_session_key'>session_key</span> <span class='op'>=</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_key</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_session_id</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_session_id'>session_id</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new_session</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_create_new_id'>create_new_id</span>
      <span class='ivar'>@new_session</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_session_id'>session_id</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_session_key'>session_key</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='lbracket'>[</span><span class='id identifier rubyid_session_key'>session_key</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_session_id'>session_id</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='kw'>if</span> <span class='id identifier rubyid_session_id'>session_id</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:read</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_session_id'>session_id</span>
      <span class='id identifier rubyid_session_id'>session_id</span><span class='comma'>,</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_cookies'>cookies</span><span class='lbracket'>[</span><span class='id identifier rubyid_session_key'>session_key</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_session_id'>session_id</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_option'>option</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new_session</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>session_key `%s&#39; should be supplied</span><span class='tstring_end'>&quot;</span></span><span class='op'>%</span><span class='id identifier rubyid_session_key'>session_key</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_create_new_id'>create_new_id</span>
      <span class='ivar'>@new_session</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='ivar'>@session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_session_id'>session_id</span>
  <span class='id identifier rubyid_dbman'>dbman</span> <span class='op'>=</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>database_manager</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='const'><a href="Session/FileStore.html" title="CGI::Session::FileStore (class)">FileStore</a></span>
  <span class='kw'>begin</span>
    <span class='ivar'>@dbman</span> <span class='op'>=</span> <span class='id identifier rubyid_dbman'>dbman</span><span class='op'>::</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_option'>option</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'><a href="Session/NoSession.html" title="CGI::Session::NoSession (class)">NoSession</a></span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_option'>option</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new_session</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid session_id `%s&#39;</span><span class='tstring_end'>&quot;</span></span><span class='op'>%</span><span class='id identifier rubyid_session_id'>session_id</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='ivar'>@session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_create_new_id'>create_new_id</span> <span class='kw'>unless</span> <span class='id identifier rubyid_session_id'>session_id</span>
    <span class='ivar'>@new_session</span><span class='op'>=</span><span class='kw'>true</span>
    <span class='kw'>retry</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_instance_eval'>instance_eval</span> <span class='kw'>do</span>
    <span class='ivar'>@output_hidden</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='id identifier rubyid_session_key'>session_key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_session_id'>session_id</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no_hidden</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='ivar'>@output_cookies</span> <span class='op'>=</span>  <span class='lbracket'>[</span>
      <span class='const'><a href="Cookie.html" title="CGI::Cookie (class)">Cookie</a></span><span class='op'>::</span><span class='id identifier rubyid_new'><a href="Cookie.html#new-class_method" title="CGI::Cookie.new (method)">new</a></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_session_key'>session_key</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>value</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_session_id'>session_id</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expires</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_expires</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_domain</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>secure</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_secure</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>path</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>session_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='kw'>elsif</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SCRIPT_NAME</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='const'>File</span><span class='op'>::</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SCRIPT_NAME</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span><span class='rparen'>)</span>
    <span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_option'>option</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no_cookies</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='ivar'>@dbprot</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='ivar'>@dbman</span><span class='rbracket'>]</span>
  <span class='const'>ObjectSpace</span><span class='op'>::</span><span class='id identifier rubyid_define_finalizer'>define_finalizer</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='const'><a href="" title="CGI::Session (class)">Session</a></span><span class='op'>::</span><span class='id identifier rubyid_callback'><a href="#callback-class_method" title="CGI::Session.callback (method)">callback</a></span><span class='lparen'>(</span><span class='ivar'>@dbprot</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Attribute Details</h2>
  <section class='method_details first' id="new_session-instance_method">
  <h3 class='signature first'>
  #<strong>new_session</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The id of this session.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L157'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


157</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 157</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:session_id</span><span class='comma'>,</span> <span class='symbol'>:new_session</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="session_id-instance_method">
  <h3 class='signature'>
  #<strong>session_id</strong>   <span class="extras">(<span class='only'>readonly</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>The id of this session.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L157'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


157</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 157</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:session_id</span><span class='comma'>,</span> <span class='symbol'>:new_session</span>
</pre>
  </div>
</div>
</section>
<h2 class='y_details'>Instance Method Details</h2>
  <section class='method_details first' id="[]-instance_method">
  <h3 class='signature first'>
  #<strong>[]</strong>(key)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Retrieve the session data for key <code>key</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L309'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


309
310
311
312</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 309</span>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='ivar'>@data</span> <span class='op'>||=</span> <span class='ivar'>@dbman</span><span class='period'>.</span><span class='id identifier rubyid_restore'>restore</span>
  <span class='ivar'>@data</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="[]=-instance_method">
  <h3 class='signature'>
  #<strong>[]=</strong>(key, val)  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Set the session data for key <code>key</code>.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L315'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


315
316
317
318
319</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 315</span>

<span class='kw'>def</span> <span class='op'>[]=</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span><span class='rparen'>)</span>
  <span class='ivar'>@write_lock</span> <span class='op'>||=</span> <span class='kw'>true</span>
  <span class='ivar'>@data</span> <span class='op'>||=</span> <span class='ivar'>@dbman</span><span class='period'>.</span><span class='id identifier rubyid_restore'>restore</span>
  <span class='ivar'>@data</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="close-instance_method">
  <h3 class='signature'>
  #<strong>close</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Store session data on the server and close the session storage. For some
session storage types, this is a no-op.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L329'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


329
330
331
332</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 329</span>

<span class='kw'>def</span> <span class='id identifier rubyid_close'>close</span>
  <span class='ivar'>@dbman</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
  <span class='ivar'>@dbprot</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="create_new_id-instance_method">
  <h3 class='signature'>
  #<strong>create_new_id</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Create a new session id.</p>

<p>The session id is a secure random number by SecureRandom if possible,
otherwise an SHA512 hash based upon the time, a random number, and a
constant string.  This routine is used internally for automatically
generated session ids.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L171'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_new_id'>create_new_id</span>
  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>securerandom</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>begin</span>
    <span class='comment'># by OpenSSL, or system provided entropy pool
</span>    <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_hex'>hex</span><span class='lparen'>(</span><span class='int'>16</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span> <span class='const'>NotImplementedError</span>
    <span class='comment'># never happens on modern systems
</span>    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>digest</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_d'>d</span> <span class='op'>=</span> <span class='const'>Digest</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SHA512</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'>Time</span><span class='op'>::</span><span class='id identifier rubyid_now'>now</span>
    <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='const'>String</span><span class='lparen'>(</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_usec'>usec</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='const'>String</span><span class='lparen'>(</span><span class='id identifier rubyid_rand'>rand</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='const'>String</span><span class='lparen'>(</span><span class='gvar'>$$</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>foobar</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_session_id'>session_id</span> <span class='op'>=</span> <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_hexdigest'>hexdigest</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>32</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_session_id'>session_id</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="delete-instance_method">
  <h3 class='signature'>
  #<strong>delete</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Delete the session from storage.  Also closes the storage.</p>

<p>Note that the session&#39;s data is <em>not</em> automatically deleted upon
the session expiring.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L338'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


338
339
340
341</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 338</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
  <span class='ivar'>@dbman</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
  <span class='ivar'>@dbprot</span><span class='period'>.</span><span class='id identifier rubyid_clear'>clear</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>
  <section class='method_details' id="update-instance_method">
  <h3 class='signature'>
  #<strong>update</strong>  
</h3>
<div class="docstring">
  <div class="discussion">
    
<p>Store session data on the server.  For some session storage types, this is
a no-op.</p>


  </div>
</div>
<div class="tags">
  
</div>  <span class='link_repo'>[ <a href='https://github.com/ruby/ruby/blob/ruby_2_3/lib/cgi/session.rb#L323'>GitHub</a> ]</span>
<div class='source_code h'>
  <pre class='lines_num'>


323
324
325</pre>
  <div class='lines_code'>
<pre class='code ruby'
<span class='info file'># File 'lib/cgi/session.rb', line 323</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span>
  <span class='ivar'>@dbman</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<div id='footer'>
  Generated by
  <a href='http://yardoc.org' title='Yay! A Ruby Documentation Tool' target="_parent">yard</a>
  0.9.5 with <a href='https://msp-greg.github.io/yard-t2/' title='yard-t2' target="_parent">yard-t2</a> 0.6.0 (ruby-2.3.2p135)
</div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</div> <!-- tbl_cont -->
</body>
</html>