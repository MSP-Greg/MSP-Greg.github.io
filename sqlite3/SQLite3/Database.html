<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: SQLite3::Database &mdash; SQLite3 main</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "SQLite3::Database",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>SQLite3 main</a> &raquo; 
      <a href='../_index.html#alpha_D'>Index (D)</a> &raquo; 
        <a href="../SQLite3.html" title="SQLite3 (module)">SQLite3</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Database&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: SQLite3::Database</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)"><code>FunctionProxy</code></a>      </div>
    </td></tr>
    <tr><td class='box_h' colspan='2'>Super Chains via Extension / Inclusion / Inheritance</td></tr>
    <tr>
      <td colspan='2'>
        <div class='box_2'>Instance Chain:</div>
        <div class='box_22'>
          self,
          <a href="Pragmas.html" title="SQLite3::Pragmas (module)"><code>Pragmas</code></a>
        </div>
      </td>
    </tr>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="../Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L41'>lib/sqlite3/database.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L885'>ext/sqlite3/database.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>The Database class encapsulates a single connection to a <a href="../SQLite3.html" title="SQLite3 (module)"><code>::SQLite3</code></a> database. Its usage is very straightforward:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sqlite3</span><span class='tstring_end'>&#39;</span></span>

<span class='const'><a href="../SQLite3.html" title="SQLite3 (module)">SQLite3</a></span><span class='op'>::</span><span class='const'>Database</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="SQLite3::Database.new (method)">new</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data.db</span><span class='tstring_end'>&quot;</span></span> ) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_db'>db</span><span class='op'>|</span>
  <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select * from table</span><span class='tstring_end'>&quot;</span></span> ) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
    <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_row'>row</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>It wraps the lower-level methods provided by the selected driver, and includes the <a href="Pragmas.html" title="SQLite3::Pragmas (module)"><code>Pragmas</code></a> module for access to various pragma convenience methods.</p>

<p>The Database class provides type translation services as well, by which the <a href="../SQLite3.html" title="SQLite3 (module)"><code>::SQLite3</code></a> data types (which are all represented as strings) may be converted into their corresponding types (as defined in the schemas for their tables). This translation only occurs when querying data from the database–insertions and updates are all still typeless.</p>

<p>Furthermore, the <code>Database</code> class has been designed to work well with the ArrayFields module from Ara Howard. If you require the ArrayFields module before performing a query, and if you have not enabled results as hashes, then the results will all be indexible by field name.</p>

<p>Thread safety:</p>

<p>When <a href="../SQLite3.html#threadsafe%3F-class_method" title="SQLite3.threadsafe? (method)">threadsafe?</a> returns true, it is safe to share instances of the database class among threads without adding specific locking. Other object instances may require applications to provide their own locks if they are to be shared among threads.  Please see the <code>README.md</code> for more information.</p>

  </div>
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
  <h3 class='inherited'><a href="Pragmas.html" title="SQLite3::Pragmas (module)"><code>Pragmas</code></a> - Included</h3>
  <p  class='inherited'>
    <a href="Pragmas.html#AUTO_VACUUM_MODES-constant" title="SQLite3::Pragmas::AUTO_VACUUM_MODES (constant)">AUTO_VACUUM_MODES</a>, 
    <a href="Pragmas.html#ENCODINGS-constant" title="SQLite3::Pragmas::ENCODINGS (constant)">ENCODINGS</a>, 
    <a href="Pragmas.html#JOURNAL_MODES-constant" title="SQLite3::Pragmas::JOURNAL_MODES (constant)">JOURNAL_MODES</a>, 
    <a href="Pragmas.html#LOCKING_MODES-constant" title="SQLite3::Pragmas::LOCKING_MODES (constant)">LOCKING_MODES</a>, 
    <a href="Pragmas.html#SYNCHRONOUS_MODES-constant" title="SQLite3::Pragmas::SYNCHRONOUS_MODES (constant)">SYNCHRONOUS_MODES</a>, 
    <a href="Pragmas.html#TEMP_STORE_MODES-constant" title="SQLite3::Pragmas::TEMP_STORE_MODES (constant)">TEMP_STORE_MODES</a>, 
    <a href="Pragmas.html#WAL_CHECKPOINTS-constant" title="SQLite3::Pragmas::WAL_CHECKPOINTS (constant)">WAL_CHECKPOINTS</a>
  </p>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong>(file, options = {})  &#x21d2; Database </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Create a new <code>Database</code> object that opens the given file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#open-class_method" title=".open (class method)">.<strong>open</strong>(*args)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Without block works exactly as new.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#quote-class_method" title=".quote (class method)">.<strong>quote</strong>(string)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Quotes the given string, making it safe to use in an SQL statement.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature wo'>
      <a href="#busy_handler_timeout=-instance_method" title="#busy_handler_timeout= (instance method)">#<strong>busy_handler_timeout=</strong>(milliseconds)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Sets a <a href="#busy_handler-instance_method" title="SQLite3::Database#busy_handler (method)">#busy_handler</a> that releases the GVL between retries, but only retries up to the indicated number of <code>milliseconds</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#closed%3F-instance_method" title="#closed? (instance method)">#<strong>closed?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if this database instance has been closed (see <a href="#close-instance_method" title="SQLite3::Database#close (method)">#close</a>).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#collations-instance_method" title="#collations (instance method)">#<strong>collations</strong>  </a>
    </span>
    <span class='note title readonly'>readonly</span>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#extended_result_codes=-instance_method" title="#extended_result_codes= (instance method)">#<strong>extended_result_codes=</strong>(true)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Enable extended result codes in SQLite.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#readonly%3F-instance_method" title="#readonly? (instance method)">#<strong>readonly?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if the database has been open in readonly mode A helper to check before performing any operation.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature rw'>
      <a href="#results_as_hash-instance_method" title="#results_as_hash (instance method)">#<strong>results_as_hash</strong>  </a>
    </span>
    <span class='note title rw'>rw</span>
    <div class='summary_desc'>
      <div class='inline'><p>A boolean that indicates whether rows in result sets should be returned as hashes or not.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature wo'>
      <a href="#statement_timeout=-instance_method" title="#statement_timeout= (instance method)">#<strong>statement_timeout=</strong>(ms)  </a>
    </span>
    <span class='note title writeonly'>writeonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Indicates that if a query lasts longer than the indicated number of milliseconds, SQLite should interrupt that query and return an error.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature ro'>
      <a href="#transaction_active%3F-instance_method" title="#transaction_active? (instance method)">#<strong>transaction_active?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if there is a transaction active, and <code>false</code> otherwise.</p></div>
    </div>
  </li>
</ul>

<h3 class='inherited'><a href="Pragmas.html" title="SQLite3::Pragmas (module)"><code>Pragmas</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr>
      <td colspan='2'>
        <a class='i_m rw' href="Pragmas.html#application_id-instance_method" title="SQLite3::Pragmas#application_id (method)">#application_id</a>,
        <a class='i_m rw' href="Pragmas.html#application_id=-instance_method" title="SQLite3::Pragmas#application_id= (method)">#application_id=</a>,
        <a class='i_m rw' href="Pragmas.html#auto_vacuum-instance_method" title="SQLite3::Pragmas#auto_vacuum (method)">#auto_vacuum</a>,
        <a class='i_m rw' href="Pragmas.html#auto_vacuum=-instance_method" title="SQLite3::Pragmas#auto_vacuum= (method)">#auto_vacuum=</a>,
        <a class='i_m rw' href="Pragmas.html#automatic_index-instance_method" title="SQLite3::Pragmas#automatic_index (method)">#automatic_index</a>,
        <a class='i_m rw' href="Pragmas.html#automatic_index=-instance_method" title="SQLite3::Pragmas#automatic_index= (method)">#automatic_index=</a>,
        <a class='i_m rw' href="Pragmas.html#busy_timeout-instance_method" title="SQLite3::Pragmas#busy_timeout (method)">#busy_timeout</a>,
        <a class='i_m rw' href="Pragmas.html#busy_timeout=-instance_method" title="SQLite3::Pragmas#busy_timeout= (method)">#busy_timeout=</a>,
        <a class='i_m rw' href="Pragmas.html#cache_size-instance_method" title="SQLite3::Pragmas#cache_size (method)">#cache_size</a>,
        <a class='i_m rw' href="Pragmas.html#cache_size=-instance_method" title="SQLite3::Pragmas#cache_size= (method)">#cache_size=</a>,
        <a class='i_m rw' href="Pragmas.html#cache_spill-instance_method" title="SQLite3::Pragmas#cache_spill (method)">#cache_spill</a>,
        <a class='i_m rw' href="Pragmas.html#cache_spill=-instance_method" title="SQLite3::Pragmas#cache_spill= (method)">#cache_spill=</a>,
        <a class='i_m wo' href="Pragmas.html#case_sensitive_like=-instance_method" title="SQLite3::Pragmas#case_sensitive_like= (method)">#case_sensitive_like=</a>,
        <a class='i_m rw' href="Pragmas.html#cell_size_check-instance_method" title="SQLite3::Pragmas#cell_size_check (method)">#cell_size_check</a>,
        <a class='i_m rw' href="Pragmas.html#cell_size_check=-instance_method" title="SQLite3::Pragmas#cell_size_check= (method)">#cell_size_check=</a>,
        <a class='i_m rw' href="Pragmas.html#checkpoint_fullfsync-instance_method" title="SQLite3::Pragmas#checkpoint_fullfsync (method)">#checkpoint_fullfsync</a>,
        <a class='i_m rw' href="Pragmas.html#checkpoint_fullfsync=-instance_method" title="SQLite3::Pragmas#checkpoint_fullfsync= (method)">#checkpoint_fullfsync=</a>,
        <a class='i_m rw' href="Pragmas.html#count_changes-instance_method" title="SQLite3::Pragmas#count_changes (method)">#count_changes</a>,
        <a class='i_m rw' href="Pragmas.html#count_changes=-instance_method" title="SQLite3::Pragmas#count_changes= (method)">#count_changes=</a>,
        <a class='i_m rw' href="Pragmas.html#default_cache_size-instance_method" title="SQLite3::Pragmas#default_cache_size (method)">#default_cache_size</a>,
        <a class='i_m rw' href="Pragmas.html#default_cache_size=-instance_method" title="SQLite3::Pragmas#default_cache_size= (method)">#default_cache_size=</a>,
        <a class='i_m rw' href="Pragmas.html#default_synchronous-instance_method" title="SQLite3::Pragmas#default_synchronous (method)">#default_synchronous</a>,
        <a class='i_m rw' href="Pragmas.html#default_synchronous=-instance_method" title="SQLite3::Pragmas#default_synchronous= (method)">#default_synchronous=</a>,
        <a class='i_m rw' href="Pragmas.html#default_temp_store-instance_method" title="SQLite3::Pragmas#default_temp_store (method)">#default_temp_store</a>,
        <a class='i_m rw' href="Pragmas.html#default_temp_store=-instance_method" title="SQLite3::Pragmas#default_temp_store= (method)">#default_temp_store=</a>,
        <a class='i_m rw' href="Pragmas.html#defer_foreign_keys-instance_method" title="SQLite3::Pragmas#defer_foreign_keys (method)">#defer_foreign_keys</a>,
        <a class='i_m rw' href="Pragmas.html#defer_foreign_keys=-instance_method" title="SQLite3::Pragmas#defer_foreign_keys= (method)">#defer_foreign_keys=</a>,
        <a class='i_m rw' href="Pragmas.html#encoding-instance_method" title="SQLite3::Pragmas#encoding (method)">#encoding</a>,
        <a class='i_m rw' href="Pragmas.html#encoding=-instance_method" title="SQLite3::Pragmas#encoding= (method)">#encoding=</a>,
        <a class='i_m rw' href="Pragmas.html#foreign_keys-instance_method" title="SQLite3::Pragmas#foreign_keys (method)">#foreign_keys</a>,
        <a class='i_m rw' href="Pragmas.html#foreign_keys=-instance_method" title="SQLite3::Pragmas#foreign_keys= (method)">#foreign_keys=</a>,
        <a class='i_m rw' href="Pragmas.html#full_column_names-instance_method" title="SQLite3::Pragmas#full_column_names (method)">#full_column_names</a>,
        <a class='i_m rw' href="Pragmas.html#full_column_names=-instance_method" title="SQLite3::Pragmas#full_column_names= (method)">#full_column_names=</a>,
        <a class='i_m rw' href="Pragmas.html#fullfsync-instance_method" title="SQLite3::Pragmas#fullfsync (method)">#fullfsync</a>,
        <a class='i_m rw' href="Pragmas.html#fullfsync=-instance_method" title="SQLite3::Pragmas#fullfsync= (method)">#fullfsync=</a>,
        <a class='i_m wo' href="Pragmas.html#ignore_check_constraints=-instance_method" title="SQLite3::Pragmas#ignore_check_constraints= (method)">#ignore_check_constraints=</a>,
        <a class='i_m rw' href="Pragmas.html#journal_mode-instance_method" title="SQLite3::Pragmas#journal_mode (method)">#journal_mode</a>,
        <a class='i_m rw' href="Pragmas.html#journal_mode=-instance_method" title="SQLite3::Pragmas#journal_mode= (method)">#journal_mode=</a>,
        <a class='i_m rw' href="Pragmas.html#journal_size_limit-instance_method" title="SQLite3::Pragmas#journal_size_limit (method)">#journal_size_limit</a>,
        <a class='i_m rw' href="Pragmas.html#journal_size_limit=-instance_method" title="SQLite3::Pragmas#journal_size_limit= (method)">#journal_size_limit=</a>,
        <a class='i_m rw' href="Pragmas.html#legacy_file_format-instance_method" title="SQLite3::Pragmas#legacy_file_format (method)">#legacy_file_format</a>,
        <a class='i_m rw' href="Pragmas.html#legacy_file_format=-instance_method" title="SQLite3::Pragmas#legacy_file_format= (method)">#legacy_file_format=</a>,
        <a class='i_m rw' href="Pragmas.html#locking_mode-instance_method" title="SQLite3::Pragmas#locking_mode (method)">#locking_mode</a>,
        <a class='i_m rw' href="Pragmas.html#locking_mode=-instance_method" title="SQLite3::Pragmas#locking_mode= (method)">#locking_mode=</a>,
        <a class='i_m rw' href="Pragmas.html#max_page_count-instance_method" title="SQLite3::Pragmas#max_page_count (method)">#max_page_count</a>,
        <a class='i_m rw' href="Pragmas.html#max_page_count=-instance_method" title="SQLite3::Pragmas#max_page_count= (method)">#max_page_count=</a>,
        <a class='i_m rw' href="Pragmas.html#mmap_size-instance_method" title="SQLite3::Pragmas#mmap_size (method)">#mmap_size</a>,
        <a class='i_m rw' href="Pragmas.html#mmap_size=-instance_method" title="SQLite3::Pragmas#mmap_size= (method)">#mmap_size=</a>,
        <a class='i_m rw' href="Pragmas.html#page_size-instance_method" title="SQLite3::Pragmas#page_size (method)">#page_size</a>,
        <a class='i_m rw' href="Pragmas.html#page_size=-instance_method" title="SQLite3::Pragmas#page_size= (method)">#page_size=</a>,
        <a class='i_m wo' href="Pragmas.html#parser_trace=-instance_method" title="SQLite3::Pragmas#parser_trace= (method)">#parser_trace=</a>,
        <a class='i_m rw' href="Pragmas.html#query_only-instance_method" title="SQLite3::Pragmas#query_only (method)">#query_only</a>,
        <a class='i_m rw' href="Pragmas.html#query_only=-instance_method" title="SQLite3::Pragmas#query_only= (method)">#query_only=</a>,
        <a class='i_m rw' href="Pragmas.html#read_uncommitted-instance_method" title="SQLite3::Pragmas#read_uncommitted (method)">#read_uncommitted</a>,
        <a class='i_m rw' href="Pragmas.html#read_uncommitted=-instance_method" title="SQLite3::Pragmas#read_uncommitted= (method)">#read_uncommitted=</a>,
        <a class='i_m rw' href="Pragmas.html#recursive_triggers-instance_method" title="SQLite3::Pragmas#recursive_triggers (method)">#recursive_triggers</a>,
        <a class='i_m rw' href="Pragmas.html#recursive_triggers=-instance_method" title="SQLite3::Pragmas#recursive_triggers= (method)">#recursive_triggers=</a>,
        <a class='i_m rw' href="Pragmas.html#reverse_unordered_selects-instance_method" title="SQLite3::Pragmas#reverse_unordered_selects (method)">#reverse_unordered_selects</a>,
        <a class='i_m rw' href="Pragmas.html#reverse_unordered_selects=-instance_method" title="SQLite3::Pragmas#reverse_unordered_selects= (method)">#reverse_unordered_selects=</a>,
        <a class='i_m rw' href="Pragmas.html#schema_cookie-instance_method" title="SQLite3::Pragmas#schema_cookie (method)">#schema_cookie</a>,
        <a class='i_m rw' href="Pragmas.html#schema_cookie=-instance_method" title="SQLite3::Pragmas#schema_cookie= (method)">#schema_cookie=</a>,
        <a class='i_m rw' href="Pragmas.html#schema_version-instance_method" title="SQLite3::Pragmas#schema_version (method)">#schema_version</a>,
        <a class='i_m rw' href="Pragmas.html#schema_version=-instance_method" title="SQLite3::Pragmas#schema_version= (method)">#schema_version=</a>,
        <a class='i_m rw' href="Pragmas.html#secure_delete-instance_method" title="SQLite3::Pragmas#secure_delete (method)">#secure_delete</a>,
        <a class='i_m rw' href="Pragmas.html#secure_delete=-instance_method" title="SQLite3::Pragmas#secure_delete= (method)">#secure_delete=</a>,
        <a class='i_m rw' href="Pragmas.html#short_column_names-instance_method" title="SQLite3::Pragmas#short_column_names (method)">#short_column_names</a>,
        <a class='i_m rw' href="Pragmas.html#short_column_names=-instance_method" title="SQLite3::Pragmas#short_column_names= (method)">#short_column_names=</a>,
        <a class='i_m rw' href="Pragmas.html#soft_heap_limit-instance_method" title="SQLite3::Pragmas#soft_heap_limit (method)">#soft_heap_limit</a>,
        <a class='i_m rw' href="Pragmas.html#soft_heap_limit=-instance_method" title="SQLite3::Pragmas#soft_heap_limit= (method)">#soft_heap_limit=</a>,
        <a class='i_m rw' href="Pragmas.html#synchronous-instance_method" title="SQLite3::Pragmas#synchronous (method)">#synchronous</a>,
        <a class='i_m rw' href="Pragmas.html#synchronous=-instance_method" title="SQLite3::Pragmas#synchronous= (method)">#synchronous=</a>,
        <a class='i_m rw' href="Pragmas.html#temp_store-instance_method" title="SQLite3::Pragmas#temp_store (method)">#temp_store</a>,
        <a class='i_m rw' href="Pragmas.html#temp_store=-instance_method" title="SQLite3::Pragmas#temp_store= (method)">#temp_store=</a>,
        <a class='i_m rw' href="Pragmas.html#threads-instance_method" title="SQLite3::Pragmas#threads (method)">#threads</a>,
        <a class='i_m rw' href="Pragmas.html#threads=-instance_method" title="SQLite3::Pragmas#threads= (method)">#threads=</a>,
        <a class='i_m rw' href="Pragmas.html#user_cookie-instance_method" title="SQLite3::Pragmas#user_cookie (method)">#user_cookie</a>,
        <a class='i_m rw' href="Pragmas.html#user_cookie=-instance_method" title="SQLite3::Pragmas#user_cookie= (method)">#user_cookie=</a>,
        <a class='i_m rw' href="Pragmas.html#user_version-instance_method" title="SQLite3::Pragmas#user_version (method)">#user_version</a>,
        <a class='i_m rw' href="Pragmas.html#user_version=-instance_method" title="SQLite3::Pragmas#user_version= (method)">#user_version=</a>,
        <a class='i_m wo' href="Pragmas.html#vdbe_addoptrace=-instance_method" title="SQLite3::Pragmas#vdbe_addoptrace= (method)">#vdbe_addoptrace=</a>,
        <a class='i_m wo' href="Pragmas.html#vdbe_debug=-instance_method" title="SQLite3::Pragmas#vdbe_debug= (method)">#vdbe_debug=</a>,
        <a class='i_m wo' href="Pragmas.html#vdbe_listing=-instance_method" title="SQLite3::Pragmas#vdbe_listing= (method)">#vdbe_listing=</a>,
        <a class='i_m rw' href="Pragmas.html#vdbe_trace-instance_method" title="SQLite3::Pragmas#vdbe_trace (method)">#vdbe_trace</a>,
        <a class='i_m rw' href="Pragmas.html#vdbe_trace=-instance_method" title="SQLite3::Pragmas#vdbe_trace= (method)">#vdbe_trace=</a>,
        <a class='i_m rw' href="Pragmas.html#wal_autocheckpoint-instance_method" title="SQLite3::Pragmas#wal_autocheckpoint (method)">#wal_autocheckpoint</a>,
        <a class='i_m rw' href="Pragmas.html#wal_autocheckpoint=-instance_method" title="SQLite3::Pragmas#wal_autocheckpoint= (method)">#wal_autocheckpoint=</a>,
        <a class='i_m rw' href="Pragmas.html#wal_checkpoint-instance_method" title="SQLite3::Pragmas#wal_checkpoint (method)">#wal_checkpoint</a>,
        <a class='i_m rw' href="Pragmas.html#wal_checkpoint=-instance_method" title="SQLite3::Pragmas#wal_checkpoint= (method)">#wal_checkpoint=</a>,
        <a class='i_m wo' href="Pragmas.html#writable_schema=-instance_method" title="SQLite3::Pragmas#writable_schema= (method)">#writable_schema=</a>
      </td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#authorizer-instance_method" title="#authorizer (instance method)">#<strong>authorizer</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Installs (or removes) a block that will be invoked for every access to the database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#authorizer=-instance_method" title="#set_authorizer= (instance method)">#<strong>set_authorizer=</strong>(auth)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Set the authorizer for this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#build_result_set-instance_method" title="#build_result_set (instance method)">#<strong>build_result_set</strong>(stmt)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Given a statement, return a result set.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#busy_handler-instance_method" title="#busy_handler (instance method)">#<strong>busy_handler</strong> {|count| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Register a busy handler with this database instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#busy_timeout-instance_method" title="#busy_timeout (instance method)">#<strong>busy_timeout</strong>(milliseconds)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="Pragmas.html#busy_timeout=-instance_method" title="SQLite3::Pragmas#busy_timeout= (method)">Pragmas#busy_timeout=</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#busy_timeout=-instance_method" title="#busy_timeout= (instance method)">#<strong>busy_timeout=</strong>(ms)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Indicates that if a request for a resource terminates because that resource is busy, SQLite should sleep and retry for up to the indicated number of milliseconds.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#changes-instance_method" title="#changes (instance method)">#<strong>changes</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the number of changes made to this database instance by the last operation performed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#close-instance_method" title="#close (instance method)">#<strong>close</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Closes this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#collation-instance_method" title="#collation (instance method)">#<strong>collation</strong>(name, comparator)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Add a collation with name <code>name</code>, and a <code>comparator</code> object.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#commit-instance_method" title="#commit (instance method)">#<strong>commit</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Commits the current transaction.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#complete%3F-instance_method" title="#complete? (instance method)">#<strong>complete?</strong>(sql)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return <code>true</code> if the string is a valid (ie, parsable) SQL statement, and <code>false</code> otherwise.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_aggregate-instance_method" title="#create_aggregate (instance method)">#<strong>create_aggregate</strong>(name, arity, step = nil, finalize = nil, text_rep = Constants::TextRep::ANY, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new aggregate function for use in SQL statements.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_aggregate_handler-instance_method" title="#create_aggregate_handler (instance method)">#<strong>create_aggregate_handler</strong>(handler)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This is another approach to creating an aggregate function (see <a href="#create_aggregate-instance_method" title="SQLite3::Database#create_aggregate (method)">#create_aggregate</a>).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#create_function-instance_method" title="#create_function (instance method)">#<strong>create_function</strong>(name, arity, text_rep = Constants::TextRep::UTF8, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new function for use in SQL statements.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#define_aggregator-instance_method" title="#define_aggregator (instance method)">#<strong>define_aggregator</strong>(name, aggregator)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define an aggregate function named <code>name</code> using a object template object <code>aggregator</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#define_function-instance_method" title="#define_function (instance method)">#<strong>define_function</strong>(name) {|args, ...| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define a function named <code>name</code> with <code>args</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#define_function_with_flags-instance_method" title="#define_function_with_flags (instance method)">#<strong>define_function_with_flags</strong>(name, flags) {|args, ...| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Define a function named <code>name</code> with <code>args</code> using TextRep bitflags <code>flags</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#enable_load_extension-instance_method" title="#enable_load_extension (instance method)">#<strong>enable_load_extension</strong>(onoff)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Enable or disable extension loading.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#encoding-instance_method" title="#encoding (instance method)">#<strong>encoding</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Fetch the encoding set on this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#errcode-instance_method" title="#errcode (instance method)">#<strong>errcode</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return an integer representing the last error to have occurred with this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#errmsg-instance_method" title="#errmsg (instance method)">#<strong>errmsg</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Return a string describing the last error to have occurred with this database.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#execute-instance_method" title="#execute (instance method)">#<strong>execute</strong>(sql, bind_vars = [], &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Executes the given SQL statement.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#execute2-instance_method" title="#execute2 (instance method)">#<strong>execute2</strong>(sql, *bind_vars)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Executes the given SQL statement, exactly as with <a href="#execute-instance_method" title="SQLite3::Database#execute (method)">#execute</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#execute_batch-instance_method" title="#execute_batch (instance method)">#<strong>execute_batch</strong>(sql, bind_vars = [])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Executes all SQL statements in the given string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#execute_batch2-instance_method" title="#execute_batch2 (instance method)">#<strong>execute_batch2</strong>(sql, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Executes all SQL statements in the given string.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#filename-instance_method" title="#filename (instance method)">#<strong>filename</strong>(db_name = &quot;main&quot;)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the filename for the database named <code>db_name</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_first_row-instance_method" title="#get_first_row (instance method)">#<strong>get_first_row</strong>(sql, *bind_vars)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A convenience method for obtaining the first row of a result set, and discarding all others.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_first_value-instance_method" title="#get_first_value (instance method)">#<strong>get_first_value</strong>(sql, *bind_vars)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A convenience method for obtaining the first value of the first row of a result set, and discarding all other values and rows.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#interrupt-instance_method" title="#interrupt (instance method)">#<strong>interrupt</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Interrupts the currently executing operation, causing it to abort.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#last_insert_row_id-instance_method" title="#last_insert_row_id (instance method)">#<strong>last_insert_row_id</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Obtains the unique row ID of the last row to be inserted by this <code>Database</code> instance.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#load_extension-instance_method" title="#load_extension (instance method)">#<strong>load_extension</strong>(file)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Loads an SQLite extension library from the named file.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#prepare-instance_method" title="#prepare (instance method)">#<strong>prepare</strong>(sql)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a <a href="Statement.html" title="SQLite3::Statement (class)"><code>Statement</code></a> object representing the given SQL.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#query-instance_method" title="#query (instance method)">#<strong>query</strong>(sql, bind_vars = [])  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>This is a convenience method for creating a statement, binding parameters to it, and calling execute:</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#rollback-instance_method" title="#rollback (instance method)">#<strong>rollback</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Rolls the current transaction back.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#total_changes-instance_method" title="#total_changes (instance method)">#<strong>total_changes</strong>  &#x21d2; ? </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the total number of changes made to this database instance since it was opened.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#trace-instance_method" title="#trace (instance method)">#<strong>trace</strong> {|sql| ... } </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Installs (or removes) a block that will be invoked for every SQL statement executed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#transaction-instance_method" title="#transaction (instance method)">#<strong>transaction</strong>(mode = nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Begins a new transaction.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#db_filename-instance_method" title="#db_filename (instance method)">#<strong>db_filename</strong>(database_name)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the file associated with <code>database_name</code>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#define_aggregator2-instance_method" title="#define_aggregator2 (instance method)">#<strong>define_aggregator2</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#disable_quirk_mode-instance_method" title="#disable_quirk_mode (instance method)">#<strong>disable_quirk_mode</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#exec_batch-instance_method" title="#exec_batch (instance method)">#<strong>exec_batch</strong>(sql, results_as_hash)  </a>
    </span>
    <span class='note title private'>private</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is invoked by calling db.execute_batch2(sql, &amp;block).</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#open16-instance_method" title="#open16 (instance method)">#<strong>open16</strong>(file)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#open_v2-instance_method" title="#open_v2 (instance method)">#<strong>open_v2</strong>(file, mode, zvfs)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>

<h3 class='inherited'><a href="Pragmas.html" title="SQLite3::Pragmas (module)"><code>Pragmas</code></a> - Included</h3>
<div class='inherited'><table class='inherited'>
  <tbody>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#collation_list-instance_method" title="SQLite3::Pragmas#collation_list (method)">#collation_list</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#compile_options-instance_method" title="SQLite3::Pragmas#compile_options (method)">#compile_options</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Pragmas.html#data_version-instance_method" title="SQLite3::Pragmas#data_version (method)">#data_version</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#database_list-instance_method" title="SQLite3::Pragmas#database_list (method)">#database_list</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#foreign_key_check-instance_method" title="SQLite3::Pragmas#foreign_key_check (method)">#foreign_key_check</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#foreign_key_list-instance_method" title="SQLite3::Pragmas#foreign_key_list (method)">#foreign_key_list</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Pragmas.html#freelist_count-instance_method" title="SQLite3::Pragmas#freelist_count (method)">#freelist_count</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#get_boolean_pragma-instance_method" title="SQLite3::Pragmas#get_boolean_pragma (method)">#get_boolean_pragma</a></td>
      <td><div class='inline'><p>Returns <code>true</code> or <code>false</code> depending on the value of the named pragma.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#get_enum_pragma-instance_method" title="SQLite3::Pragmas#get_enum_pragma (method)">#get_enum_pragma</a></td>
      <td><div class='inline'><p>Return the value of the given pragma.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#get_int_pragma-instance_method" title="SQLite3::Pragmas#get_int_pragma (method)">#get_int_pragma</a></td>
      <td><div class='inline'><p>Returns the value of the given pragma as an integer.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#get_query_pragma-instance_method" title="SQLite3::Pragmas#get_query_pragma (method)">#get_query_pragma</a></td>
      <td><div class='inline'><p>Requests the given pragma (and parameters), and if the block is given, each row of the result set will be yielded to it.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#incremental_vacuum-instance_method" title="SQLite3::Pragmas#incremental_vacuum (method)">#incremental_vacuum</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#index_info-instance_method" title="SQLite3::Pragmas#index_info (method)">#index_info</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#index_list-instance_method" title="SQLite3::Pragmas#index_list (method)">#index_list</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#index_xinfo-instance_method" title="SQLite3::Pragmas#index_xinfo (method)">#index_xinfo</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#integrity_check-instance_method" title="SQLite3::Pragmas#integrity_check (method)">#integrity_check</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Pragmas.html#page_count-instance_method" title="SQLite3::Pragmas#page_count (method)">#page_count</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#quick_check-instance_method" title="SQLite3::Pragmas#quick_check (method)">#quick_check</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#set_boolean_pragma-instance_method" title="SQLite3::Pragmas#set_boolean_pragma (method)">#set_boolean_pragma</a></td>
      <td><div class='inline'><p>Sets the given pragma to the given boolean value.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#set_enum_pragma-instance_method" title="SQLite3::Pragmas#set_enum_pragma (method)">#set_enum_pragma</a></td>
      <td><div class='inline'><p>Set the value of the given pragma to <code>mode</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#set_int_pragma-instance_method" title="SQLite3::Pragmas#set_int_pragma (method)">#set_int_pragma</a></td>
      <td><div class='inline'><p>Set the value of the given pragma to the integer value of the <code>value</code> parameter.</p></div></td>
    </tr>
    <tr>
      <td colspan='2'>
        <a class='i_m ' href="Pragmas.html#shrink_memory-instance_method" title="SQLite3::Pragmas#shrink_memory (method)">#shrink_memory</a>,
      </td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#stats-instance_method" title="SQLite3::Pragmas#stats (method)">#stats</a></td>
      <td><div class='inline'><p>:yields: row.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m ' href="Pragmas.html#table_info-instance_method" title="SQLite3::Pragmas#table_info (method)">#table_info</a></td>
      <td><div class='inline'><p>Returns information about <code>table</code>.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Pragmas.html#tweak_default-instance_method" title="SQLite3::Pragmas#tweak_default (method)">#tweak_default</a></td>
      <td><div class='inline'><p>Since SQLite 3.3.8, the table_info pragma has returned the default value of the row as a quoted SQL value.</p></div></td>
    </tr>
    <tr class='i_ds'>
      <td><a class='i_m priv' href="Pragmas.html#version_compare-instance_method" title="SQLite3::Pragmas#version_compare (method)">#version_compare</a></td>
      <td><div class='inline'><p>Compares two version strings.</p></div></td>
    </tr>
  </tbody>
</table></div>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(file, options = {})  &#x21d2; <code>Database</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Create a new <code>Database</code> object that opens the given file.</p>

<p>Supported permissions <code>options</code>:</p>
<ul><li>
<p>the default mode is <code>READWRITE | CREATE</code></p>
</li><li>
<p><code>:readonly</code>: boolean (default false), true to set the mode to <code>READONLY</code></p>
</li><li>
<p><code>:readwrite</code>: boolean (default false), true to set the mode to <code>READWRITE</code></p>
</li><li>
<p><code>:flags</code>: set the mode to a combination of <a href="Constants/Open.html" title="SQLite3::Constants::Open (module)"><code>Constants::Open</code></a> flags.</p>
</li></ul>

<p>Supported encoding <code>options</code>:</p>
<ul><li>
<p><code>:utf16</code>: boolean (default false), is the filename’s encoding UTF-16 (only needed if the filename encoding is not UTF_16LE or BE)</p>
</li></ul>

<p>Other supported <code>options</code>:</p>
<ul><li>
<p><code>:strict</code>: boolean (default false), disallow the use of double-quoted string literals (see <a href="https://www.sqlite.org/quirks.html#double_quoted_string_literals_are_accepted">www.sqlite.org/quirks.html#double_quoted_string_literals_are_accepted</a>)</p>
</li><li>
<p><code>:results_as_hash</code>: boolean (default false), return rows as hashes instead of arrays</p>
</li><li>
<p><code>:default_transaction_mode</code>: one of <code>:deferred</code> (default), <code>:immediate</code>, or <code>:exclusive</code>. If a mode is not specified in a call to <a href="#transaction-instance_method" title="SQLite3::Database#transaction (method)">#transaction</a>, this will be the default transaction mode.</p>
</li></ul>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L94-L143'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='94' data-end='143'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 94</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span> <span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> {}<span class='comma'>,</span> <span class='id identifier rubyid_zvfs'>zvfs</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html" title="SQLite3::Constants::Open (module)">Open</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html#READWRITE-constant" title="SQLite3::Constants::Open::READWRITE (constant)">READWRITE</a></span> <span class='op'>|</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html" title="SQLite3::Constants::Open (module)">Open</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html#CREATE-constant" title="SQLite3::Constants::Open::CREATE (constant)">CREATE</a></span>

  <span class='id identifier rubyid_file'>file</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_to_path'>to_path</span> <span class='kw'>if</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span> <span class='symbeg'>:</span><span class='id identifier rubyid_to_path'>to_path</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_encoding'><a href="#encoding-instance_method" title="SQLite3::Database#encoding (method)">encoding</a></span> <span class='op'>==</span> <span class='op'>::</span><span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_16LE</span> <span class='op'>||</span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_encoding'><a href="#encoding-instance_method" title="SQLite3::Database#encoding (method)">encoding</a></span> <span class='op'>==</span> <span class='op'>::</span><span class='const'>Encoding</span><span class='op'>::</span><span class='const'>UTF_16BE</span> <span class='op'>||</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_utf16'>utf16</span>]
    <span class='id identifier rubyid_open16'><a href="#open16-instance_method" title="SQLite3::Database#open16 (method)">open16</a></span> <span class='id identifier rubyid_file'>file</span>
  <span class='kw'>else</span>
    <span class='comment'># The three primary flag values for sqlite3_open_v2 are:
</span>    <span class='comment'># SQLITE_OPEN_READONLY
</span>    <span class='comment'># SQLITE_OPEN_READWRITE
</span>    <span class='comment'># SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE -- always used for sqlite3_open and sqlite3_open16
</span>    <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html" title="SQLite3::Constants::Open (module)">Open</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html#READONLY-constant" title="SQLite3::Constants::Open::READONLY (constant)">READONLY</a></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_readonly'>readonly</span>]

    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_readwrite'>readwrite</span>]
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>conflicting options: readonly and readwrite</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_readonly'>readonly</span>]
      <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html" title="SQLite3::Constants::Open (module)">Open</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html#READWRITE-constant" title="SQLite3::Constants::Open::READWRITE (constant)">READWRITE</a></span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_flags'>flags</span>]
      <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_readonly'>readonly</span>] <span class='op'>||</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_readwrite'>readwrite</span>]
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>conflicting options: flags with readonly and/or readwrite</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_flags'>flags</span>]
    <span class='kw'>end</span>

    <span class='id identifier rubyid_open_v2'><a href="#open_v2-instance_method" title="SQLite3::Database#open_v2 (method)">open_v2</a></span> <span class='id identifier rubyid_file'>file</span>.<span class='id identifier rubyid_encode'>encode</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>utf-8</span><span class='tstring_end'>&quot;</span></span>)<span class='comma'>,</span> <span class='id identifier rubyid_mode'>mode</span><span class='comma'>,</span> <span class='id identifier rubyid_zvfs'>zvfs</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_strict'>strict</span>]
      <span class='id identifier rubyid_disable_quirk_mode'><a href="#disable_quirk_mode-instance_method" title="SQLite3::Database#disable_quirk_mode (method)">disable_quirk_mode</a></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='ivar'>@tracefunc</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@authorizer</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@busy_handler</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@progress_handler</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@collations</span> <span class='op'>=</span> {}
  <span class='ivar'>@functions</span> <span class='op'>=</span> {}
  <span class='ivar'>@results_as_hash</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_results_as_hash'><a href="#results_as_hash-instance_method" title="SQLite3::Database#results_as_hash (method)">results_as_hash</a></span>]
  <span class='ivar'>@readonly</span> <span class='op'>=</span> <span class='id identifier rubyid_mode'>mode</span> <span class='op'>&amp;</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html" title="SQLite3::Constants::Open (module)">Open</a></span><span class='op'>::</span><span class='const'><a href="Constants/Open.html#READONLY-constant" title="SQLite3::Constants::Open::READONLY (constant)">READONLY</a></span> <span class='op'>!=</span> <span class='int'>0</span>
  <span class='ivar'>@default_transaction_mode</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_default_transaction_mode'>default_transaction_mode</span>] <span class='op'>||</span> <span class='symbeg'>:</span><span class='id identifier rubyid_deferred'>deferred</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='kw'>self</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_close'><a href="#close-instance_method" title="SQLite3::Database#close (method)">close</a></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="open-class_method">
  <h3 class='signature  first'>
    .<strong>open</strong>(*args)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Without block works exactly as new. With block, like new closes the database at the end, but unlike new returns the result of the block instead of the database instance.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L50-L62'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='50' data-end='62'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 50</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_open'>open</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='id identifier rubyid_database'>database</span> <span class='op'>=</span> <span class='id identifier rubyid_new'><a href="#new-class_method" title="SQLite3::Database.new (method)">new</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_database'>database</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_database'>database</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="SQLite3::Database#close (method)">close</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_database'>database</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="quote-class_method">
  <h3 class='signature '>
    .<strong>quote</strong>(string)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Quotes the given string, making it safe to use in an SQL statement. It replaces all instances of the single-quote character with two single-quote characters. The modified string is returned.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L67-L69'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='67' data-end='69'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 67</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_quote'>quote</span>(<span class='id identifier rubyid_string'>string</span>)
  <span class='id identifier rubyid_string'>string</span>.<span class='id identifier rubyid_gsub'>gsub</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;&#39;</span><span class='tstring_end'>&quot;</span></span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="busy_handler_timeout=-instance_method">
  <h3 class='signature wo first'>
    #<strong>busy_handler_timeout=</strong>(milliseconds)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Sets a <a href="#busy_handler-instance_method" title="SQLite3::Database#busy_handler (method)">#busy_handler</a> that releases the GVL between retries, but only retries up to the indicated number of <code>milliseconds</code>. This is an alternative to <a href="#busy_timeout-instance_method" title="SQLite3::Database#busy_timeout (method)">#busy_timeout</a>, which holds the GVL while SQLite sleeps and retries.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L642-L655'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='642' data-end='655'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 642</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_busy_handler_timeout='>busy_handler_timeout=</span>(<span class='id identifier rubyid_milliseconds'>milliseconds</span>)
  <span class='id identifier rubyid_timeout_seconds'>timeout_seconds</span> <span class='op'>=</span> <span class='id identifier rubyid_milliseconds'>milliseconds</span>.<span class='id identifier rubyid_fdiv'>fdiv</span>(<span class='int'>1000</span>)

  <span class='id identifier rubyid_busy_handler'><a href="#busy_handler-instance_method" title="SQLite3::Database#busy_handler (method)">busy_handler</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_count'>count</span><span class='op'>|</span>
    <span class='id identifier rubyid_now'>now</span> <span class='op'>=</span> <span class='const'>Process</span>.<span class='id identifier rubyid_clock_gettime'>clock_gettime</span>(<span class='const'>Process</span><span class='op'>::</span><span class='const'>CLOCK_MONOTONIC</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_count'>count</span>.<span class='id identifier rubyid_zero?'>zero?</span>
      <span class='ivar'>@timeout_deadline</span> <span class='op'>=</span> <span class='id identifier rubyid_now'>now</span> <span class='op'>+</span> <span class='id identifier rubyid_timeout_seconds'>timeout_seconds</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_now'>now</span> <span class='op'>&gt;</span> <span class='ivar'>@timeout_deadline</span>
      <span class='kw'>next</span> <span class='kw'>false</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_sleep'>sleep</span>(<span class='float'>0.001</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="closed?-instance_method">
  <h3 class='signature ro'>
    #<strong>closed?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if this database instance has been closed (see <a href="#close-instance_method" title="SQLite3::Database#close (method)">#close</a>).</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L147-L156'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='147' data-end='156'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 147</span></pre>
<pre class='code cpp'>

static VALUE
closed_p(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

    if (!ctx-&gt;db) { return Qtrue; }

    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collations-instance_method">
  <h3 class='signature ro'>
    #<strong>collations</strong>   <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L42-L42'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='42' data-end='42'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 42</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbeg'>:</span><span class='id identifier rubyid_collations'>collations</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="extended_result_codes=-instance_method">
  <h3 class='signature wo'>
    #<strong>extended_result_codes=</strong>(true)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enable extended result codes in SQLite.  These result codes allow for more detailed exception reporting, such a which type of constraint is violated.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L629-L639'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='629' data-end='639'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 629</span></pre>
<pre class='code cpp'>

static VALUE
set_extended_result_codes(VALUE self, VALUE enable)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    CHECK(ctx-&gt;db, sqlite3_extended_result_codes(ctx-&gt;db, RTEST(enable) ? 1 : 0));

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="readonly?-instance_method">
  <h3 class='signature ro'>
    #<strong>readonly?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if the database has been open in readonly mode A helper to check before performing any operation</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L634-L636'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='634' data-end='636'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 634</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_readonly?'>readonly?</span>
  <span class='ivar'>@readonly</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="results_as_hash-instance_method">
  <h3 class='signature rw'>
    #<strong>results_as_hash</strong>   <span class="extras">(<span class='rw'>rw</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A boolean that indicates whether rows in result sets should be returned as hashes or not. By default, rows are returned as arrays.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L74-L74'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='74' data-end='74'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 74</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbeg'>:</span><span class='id identifier rubyid_results_as_hash'>results_as_hash</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="statement_timeout=-instance_method">
  <h3 class='signature wo'>
    #<strong>statement_timeout=</strong>(ms)   <span class="extras">(<span class='writeonly'>writeonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Indicates that if a query lasts longer than the indicated number of milliseconds, SQLite should interrupt that query and return an error. By default, SQLite does not interrupt queries. To restore the default behavior, send 0 as the <code>ms</code> parameter.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L286-L298'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='286' data-end='298'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 286</span></pre>
<pre class='code cpp'>

static VALUE
set_statement_timeout(VALUE self, VALUE milliseconds)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

    ctx-&gt;stmt_timeout = NUM2INT(milliseconds);
    int n = NUM2INT(milliseconds) == 0 ? -1 : 1000;

    sqlite3_progress_handler(ctx-&gt;db, n, rb_sqlite3_statement_timeout, (void *)ctx);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="transaction_active?-instance_method">
  <h3 class='signature ro'>
    #<strong>transaction_active?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if there is a transaction active, and <code>false</code> otherwise.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L753-L761'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='753' data-end='761'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 753</span></pre>
<pre class='code cpp'>

static VALUE
transaction_active_p(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return sqlite3_get_autocommit(ctx-&gt;db) ? Qfalse : Qtrue;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="authorizer-instance_method">
  <h3 class='signature  first'>
    #<strong>authorizer</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Installs (or removes) a block that will be invoked for every access to the database. If the block returns 0 (or <code>nil</code>), the statement is allowed to proceed. Returning 1 causes an authorization error to occur, and returning 2 causes the access to be silently denied.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L156-L158'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='156' data-end='158'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 156</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_authorizer'>authorizer</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>self</span>.<span class='id identifier rubyid_authorizer'>authorizer</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="authorizer=-instance_method">
  <h3 class='signature '>
    #<strong>set_authorizer=</strong>(auth)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Set the authorizer for this database.  <code>auth</code> must respond to <code>call</code>, and <code>call</code> must take 5 arguments.</p>

<p>Installs (or removes) a block that will be invoked for every access to the database. If the block returns 0 (or <code>true</code>), the statement is allowed to proceed. Returning 1 or false causes an authorization error to occur, and returning 2 or nil causes the access to be silently denied.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L582-L600'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='582' data-end='600'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 582</span></pre>
<pre class='code cpp'>

static VALUE
set_authorizer(VALUE self, VALUE authorizer)
{
    sqlite3RubyPtr ctx;
    int status;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    status = sqlite3_set_authorizer(
                 ctx-&gt;db, NIL_P(authorizer) ? NULL : rb_sqlite3_auth, (void *)self
             );

    CHECK(ctx-&gt;db, status);

    rb_iv_set(self, &quot;@authorizer&quot;, authorizer);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="build_result_set-instance_method">
  <h3 class='signature '>
    #<strong>build_result_set</strong>(stmt)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Given a statement, return a result set. This is not intended for general consumption :nodoc:</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L693-L699'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='693' data-end='699'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 693</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_build_result_set'>build_result_set</span> <span class='id identifier rubyid_stmt'>stmt</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_results_as_hash'><a href="#results_as_hash-instance_method" title="SQLite3::Database#results_as_hash (method)">results_as_hash</a></span>
    <span class='const'><a href="HashResultSet.html" title="SQLite3::HashResultSet (class)">HashResultSet</a></span>.<span class='id identifier rubyid_new'><a href="ResultSet.html#new-class_method" title="SQLite3::ResultSet.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_stmt'>stmt</span>)
  <span class='kw'>else</span>
    <span class='const'><a href="ResultSet.html" title="SQLite3::ResultSet (class)">ResultSet</a></span>.<span class='id identifier rubyid_new'><a href="ResultSet.html#new-class_method" title="SQLite3::ResultSet.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_stmt'>stmt</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="busy_handler-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>busy_handler</strong> {|count| ... } </span>
      <span class='overload'>#<strong>busy_handler</strong>(Class.new { def call count; end }.new)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Register a busy handler with this database instance. When a requested resource is busy, this handler will be invoked. If the handler returns <code>false</code>, the operation will be aborted; otherwise, the resource will be requested again.</p>

<p>The handler will be invoked with the name of the resource that was busy, and the number of times it has been retried.</p>

<p>See also the mutually exclusive <a href="#busy_timeout-instance_method" title="SQLite3::Database#busy_timeout (method)">#busy_timeout</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L236-L260'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='236' data-end='260'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 236</span></pre>
<pre class='code cpp'>

static VALUE
busy_handler(int argc, VALUE *argv, VALUE self)
{
    sqlite3RubyPtr ctx;
    VALUE block;
    int status;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;block);

    if (NIL_P(block) &amp;&amp; rb_block_given_p()) { block = rb_block_proc(); }
    ctx-&gt;busy_handler = block;

    status = sqlite3_busy_handler(
                 ctx-&gt;db,
                 NIL_P(block) ? NULL : rb_sqlite3_busy_handler,
                 (void *)ctx
             );

    CHECK(ctx-&gt;db, status);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="busy_timeout-instance_method">
  <h3 class='signature '>
    #<strong>busy_timeout</strong>(milliseconds)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="Pragmas.html#busy_timeout=-instance_method" title="SQLite3::Pragmas#busy_timeout= (method)">Pragmas#busy_timeout=</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L336-L336'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='336' data-end='336'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_busy_timeout'>busy_timeout</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_busy_timeout='><a href="#busy_timeout=-instance_method" title="SQLite3::Database#busy_timeout= (method)">busy_timeout=</a></span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="busy_timeout=-instance_method">
  <h3 class='signature '>
    #<strong>busy_timeout=</strong>(ms)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Indicates that if a request for a resource terminates because that resource is busy, SQLite should sleep and retry for up to the indicated number of milliseconds. By default, SQLite does not retry busy resources. To restore the default behavior, send 0 as the <code>ms</code> parameter.</p>

<p>See also the mutually exclusive <a href="#busy_handler-instance_method" title="SQLite3::Database#busy_handler (method)">#busy_handler</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L612-L622'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='612' data-end='622'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 612</span></pre>
<pre class='code cpp'>

static VALUE
set_busy_timeout(VALUE self, VALUE timeout)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    CHECK(ctx-&gt;db, sqlite3_busy_timeout(ctx-&gt;db, (int)NUM2INT(timeout)));

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="changes-instance_method">
  <h3 class='signature '>
    #<strong>changes</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the number of changes made to this database instance by the last operation performed. Note that a “delete from table” without a where clause will not affect this value.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L537-L545'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='537' data-end='545'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 537</span></pre>
<pre class='code cpp'>

static VALUE
changes(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return INT2NUM(sqlite3_changes(ctx-&gt;db));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="close-instance_method">
  <h3 class='signature '>
    #<strong>close</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Closes this database.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L126-L141'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='126' data-end='141'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 126</span></pre>
<pre class='code cpp'>

static VALUE
sqlite3_rb_close(VALUE self)
{
    sqlite3RubyPtr ctx;
    sqlite3 *db;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

    db = ctx-&gt;db;
    CHECK(db, sqlite3_close(ctx-&gt;db));

    ctx-&gt;db = NULL;

    rb_iv_set(self, &quot;-aggregators&quot;, Qnil);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="collation-instance_method">
  <h3 class='signature '>
    #<strong>collation</strong>(name, comparator)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Add a collation with name <code>name</code>, and a <code>comparator</code> object.  The <code>comparator</code> object should implement a method called “compare” that takes two parameters and returns an integer less than, equal to, or greater than 0.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L676-L694'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='676' data-end='694'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 676</span></pre>
<pre class='code cpp'>

static VALUE
collation(VALUE self, VALUE name, VALUE comparator)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    CHECK(ctx-&gt;db, sqlite3_create_collation(
              ctx-&gt;db,
              StringValuePtr(name),
              SQLITE_UTF8,
              (void *)comparator,
              NIL_P(comparator) ? NULL : rb_comparator_func));

    /* Make sure our comparator doesn&#39;t get garbage collected. */
    rb_hash_aset(rb_iv_get(self, &quot;@collations&quot;), name, comparator);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="commit-instance_method">
  <h3 class='signature '>
    #<strong>commit</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Commits the current transaction. If there is no current transaction, this will cause an error to be raised. This returns <code>true</code>, in order to allow it to be used in idioms like <code>abort? and rollback or commit</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L618-L621'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='618' data-end='621'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 618</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_commit'>commit</span>
  <span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>commit transaction</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="complete?-instance_method">
  <h3 class='signature '>
    #<strong>complete?</strong>(sql)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return <code>true</code> if the string is a valid (ie, parsable) SQL statement, and <code>false</code> otherwise.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L521-L529'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='521' data-end='529'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 521</span></pre>
<pre class='code cpp'>

static VALUE
complete_p(VALUE UNUSED(self), VALUE sql)
{
    if (sqlite3_complete(StringValuePtr(sql))) {
        return Qtrue;
    }

    return Qfalse;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_aggregate-instance_method">
  <h3 class='signature '>
    #<strong>create_aggregate</strong>(name, arity, step = nil, finalize = nil, text_rep = Constants::TextRep::ANY, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new aggregate function for use in SQL statements. Aggregate functions are functions that apply over every row in the result set, instead of over just a single row. (A very common aggregate function is the “count” function, for determining the number of rows that match a query.)</p>

<p>The new function will be added as <code>name</code>, with the given <code>arity</code>. (For variable arity functions, use -1 for the arity.)</p>

<p>The <code>step</code> parameter must be a proc object that accepts as its first parameter a <a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)"><code>Database::FunctionProxy</code></a> instance (representing the function invocation), with any subsequent parameters (up to the function’s arity). The <code>step</code> callback will be invoked once for each row of the result set.</p>

<p>The <code>finalize</code> parameter must be a <code>proc</code> object that accepts only a single parameter, the <a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)"><code>Database::FunctionProxy</code></a> instance representing the current function invocation. It should invoke <a href="Database/FunctionProxy.html#result=-instance_method" title="SQLite3::Database::FunctionProxy#result= (method)">FunctionProxy#result=</a> to store the result of the function.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_create_aggregate'>create_aggregate</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>lengths</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span> ) <span class='kw'>do</span>
  <span class='id identifier rubyid_step'>step</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_func'>func</span>[ <span class='symbeg'>:</span><span class='id identifier rubyid_total'>total</span> ] <span class='op'>||=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_func'>func</span>[ <span class='symbeg'>:</span><span class='id identifier rubyid_total'>total</span> ] <span class='op'>+=</span> ( <span class='id identifier rubyid_value'>value</span> <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>:</span> <span class='int'>0</span> )
  <span class='kw'>end</span>

  <span class='id identifier rubyid_finalize'>finalize</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_func'>func</span><span class='op'>|</span>
    <span class='id identifier rubyid_func'>func</span>.<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_func'>func</span>[ <span class='symbeg'>:</span><span class='id identifier rubyid_total'>total</span> ] <span class='op'>||</span> <span class='int'>0</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_get_first_value'><a href="#get_first_value-instance_method" title="SQLite3::Database#get_first_value (method)">get_first_value</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select lengths(name) from table</span><span class='tstring_end'>&quot;</span></span> )</code></pre>

<p>See also <a href="#create_aggregate_handler-instance_method" title="SQLite3::Database#create_aggregate_handler (method)">#create_aggregate_handler</a> for a more object-oriented approach to aggregate functions.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L406-L455'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='406' data-end='455'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 406</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_aggregate'>create_aggregate</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_arity'>arity</span><span class='comma'>,</span> <span class='id identifier rubyid_step'>step</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_finalize'>finalize</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span>
  <span class='id identifier rubyid_text_rep'>text_rep</span> <span class='op'>=</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/TextRep.html" title="SQLite3::Constants::TextRep (module)">TextRep</a></span><span class='op'>::</span><span class='const'><a href="Constants/TextRep.html#ANY-constant" title="SQLite3::Constants::TextRep::ANY (constant)">ANY</a></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)

  <span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='const'>Class</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="SQLite3::Database.new (method)">new</a></span> <span class='kw'>do</span>
    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_step'>step</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
      <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_step_with_ctx'>step_with_ctx</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_finalize'>finalize</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
      <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_finalize_with_ctx'>finalize_with_ctx</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
    <span class='id identifier rubyid_proxy'>proxy</span>.<span class='id identifier rubyid_instance_eval'>instance_eval</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_proxy'>proxy</span>.<span class='id identifier rubyid_class_eval'>class_eval</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_step_with_ctx'>step_with_ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_step'>step</span>)
      <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_finalize_with_ctx'>finalize_with_ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_finalize'>finalize</span>)
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_proxy'>proxy</span>.<span class='id identifier rubyid_class_eval'>class_eval</span> <span class='kw'>do</span>
    <span class='comment'># class instance variables
</span>    <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='ivar'>@arity</span> <span class='op'>=</span> <span class='id identifier rubyid_arity'>arity</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@name</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_arity'>arity</span>
      <span class='ivar'>@arity</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
      <span class='ivar'>@ctx</span> <span class='op'>=</span> <span class='const'><a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)">FunctionProxy</a></span>.<span class='id identifier rubyid_new'><a href="Database/FunctionProxy.html#new-class_method" title="SQLite3::Database::FunctionProxy.new (method)">new</a></span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_step'>step</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
      <span class='id identifier rubyid_step_with_ctx'>step_with_ctx</span>(<span class='ivar'>@ctx</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_finalize'>finalize</span>
      <span class='id identifier rubyid_finalize_with_ctx'>finalize_with_ctx</span>(<span class='ivar'>@ctx</span>)
      <span class='ivar'>@ctx</span>.<span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_define_aggregator2'><a href="#define_aggregator2-instance_method" title="SQLite3::Database#define_aggregator2 (method)">define_aggregator2</a></span>(<span class='id identifier rubyid_proxy'>proxy</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_aggregate_handler-instance_method">
  <h3 class='signature '>
    #<strong>create_aggregate_handler</strong>(handler)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>This is another approach to creating an aggregate function (see <a href="#create_aggregate-instance_method" title="SQLite3::Database#create_aggregate (method)">#create_aggregate</a>). Instead of explicitly specifying the name, callbacks, arity, and type, you specify a factory object (the “handler”) that knows how to obtain all of that information. The handler should respond to the following messages:</p>
<dl class="rdoc-list note-list"><dt><code>arity</code>
<dd>
<p>corresponds to the <code>arity</code> parameter of <a href="#create_aggregate-instance_method" title="SQLite3::Database#create_aggregate (method)">#create_aggregate</a>. This message is optional, and if the handler does not respond to it, the function will have an arity of -1.</p>
</dd><dt><code>name</code>
<dd>
<p>this is the name of the function. The handler <em>must</em> implement this message.</p>
</dd><dt><a href="#new-class_method" title="SQLite3::Database.new (method)">.new</a>
<dd>
<p>this must be implemented by the handler. It should return a new instance of the object that will handle a specific invocation of the function.</p>
</dd></dl>

<p>The handler instance (the object returned by the <a href="#new-class_method" title="SQLite3::Database.new (method)">.new</a> message, described above), must respond to the following messages:</p>
<dl class="rdoc-list note-list"><dt><code>step</code>
<dd>
<p>this is the method that will be called for each step of the aggregate function’s evaluation. It should implement the same signature as the <code>step</code> callback for #create_aggregate.</p>
</dd><dt><code>finalize</code>
<dd>
<p>this is the method that will be called to finalize the aggregate function’s evaluation. It should implement the same signature as the <code>finalize</code> callback for #create_aggregate.</p>
</dd></dl>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>LengthsAggregateHandler</span>
  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_arity'>arity</span><span class='semicolon'>;</span> <span class='int'>1</span><span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_name'>name</span><span class='semicolon'>;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>lengths</span><span class='tstring_end'>&#39;</span></span><span class='semicolon'>;</span> <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
    <span class='ivar'>@total</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_step'>step</span>( <span class='id identifier rubyid_ctx'>ctx</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span> )
    <span class='ivar'>@total</span> <span class='op'>+=</span> ( <span class='id identifier rubyid_name'>name</span> <span class='op'>?</span> <span class='id identifier rubyid_name'>name</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>:</span> <span class='int'>0</span> )
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_finalize'>finalize</span>( <span class='id identifier rubyid_ctx'>ctx</span> )
    <span class='id identifier rubyid_ctx'>ctx</span>.<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='ivar'>@total</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_create_aggregate_handler'>create_aggregate_handler</span>( <span class='const'>LengthsAggregateHandler</span> )
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_get_first_value'><a href="#get_first_value-instance_method" title="SQLite3::Database#get_first_value (method)">get_first_value</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select lengths(name) from A</span><span class='tstring_end'>&quot;</span></span> )</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L504-L529'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='504' data-end='529'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 504</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_aggregate_handler'>create_aggregate_handler</span>(<span class='id identifier rubyid_handler'>handler</span>)
  <span class='comment'># This is a compatibility shim so the (basically pointless) FunctionProxy
</span>  <span class='comment'># &quot;ctx&quot; object is passed as first argument to both step() and finalize().
</span>  <span class='comment'># Now its up to the library user whether he prefers to store his
</span>  <span class='comment'># temporaries as instance variables or fields in the FunctionProxy.
</span>  <span class='comment'># The library user still must set the result value with
</span>  <span class='comment'># FunctionProxy.result= as there is no backwards compatible way to
</span>  <span class='comment'># change this.
</span>  <span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='const'>Class</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="SQLite3::Database.new (method)">new</a></span>(<span class='id identifier rubyid_handler'>handler</span>) <span class='kw'>do</span>
    <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
      <span class='kw'>super</span>
      <span class='ivar'>@fp</span> <span class='op'>=</span> <span class='const'><a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)">FunctionProxy</a></span>.<span class='id identifier rubyid_new'><a href="Database/FunctionProxy.html#new-class_method" title="SQLite3::Database::FunctionProxy.new (method)">new</a></span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_step'>step</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
      <span class='kw'>super</span>(<span class='ivar'>@fp</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_finalize'>finalize</span>
      <span class='kw'>super</span>(<span class='ivar'>@fp</span>)
      <span class='ivar'>@fp</span>.<span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_define_aggregator2'><a href="#define_aggregator2-instance_method" title="SQLite3::Database#define_aggregator2 (method)">define_aggregator2</a></span>(<span class='id identifier rubyid_proxy'>proxy</span><span class='comma'>,</span> <span class='id identifier rubyid_proxy'>proxy</span>.<span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="create_function-instance_method">
  <h3 class='signature '>
    #<strong>create_function</strong>(name, arity, text_rep = Constants::TextRep::UTF8, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new function for use in SQL statements. It will be added as <code>name</code>, with the given <code>arity</code>. (For variable arity functions, use -1 for the arity.)</p>

<p>The block should accept at least one parameter–the <a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)"><code>Database::FunctionProxy</code></a> instance that wraps this function invocation–and any other arguments it needs (up to its arity).</p>

<p>The block does not return a value directly. Instead, it will invoke the <a href="Database/FunctionProxy.html#result=-instance_method" title="SQLite3::Database::FunctionProxy#result= (method)">FunctionProxy#result=</a> method on the <code>func</code> parameter and indicate the return value that way.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_create_function'>create_function</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>maim</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>1</span> ) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_func'>func</span>.<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_func'>func</span>.<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_split'>split</span>(<span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/</span></span>).<span class='id identifier rubyid_sort'>sort</span>.<span class='id identifier rubyid_join'>join</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_get_first_value'><a href="#get_first_value-instance_method" title="SQLite3::Database#get_first_value (method)">get_first_value</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select maim(name) from table</span><span class='tstring_end'>&quot;</span></span> )</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L361-L368'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='361' data-end='368'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 361</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_create_function'>create_function</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_arity'>arity</span><span class='comma'>,</span> <span class='id identifier rubyid_text_rep'>text_rep</span> <span class='op'>=</span> <span class='const'><a href="Constants.html" title="SQLite3::Constants (module)">Constants</a></span><span class='op'>::</span><span class='const'><a href="Constants/TextRep.html" title="SQLite3::Constants::TextRep (module)">TextRep</a></span><span class='op'>::</span><span class='const'><a href="Constants/TextRep.html#UTF8-constant" title="SQLite3::Constants::TextRep::UTF8 (constant)">UTF8</a></span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_define_function_with_flags'><a href="#define_function_with_flags-instance_method" title="SQLite3::Database#define_function_with_flags (method)">define_function_with_flags</a></span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_text_rep'>text_rep</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span>
    <span class='id identifier rubyid_fp'>fp</span> <span class='op'>=</span> <span class='const'><a href="Database/FunctionProxy.html" title="SQLite3::Database::FunctionProxy (class)">FunctionProxy</a></span>.<span class='id identifier rubyid_new'><a href="Database/FunctionProxy.html#new-class_method" title="SQLite3::Database::FunctionProxy.new (method)">new</a></span>
    <span class='id identifier rubyid_block'>block</span>.<span class='id identifier rubyid_call'>call</span>(<span class='id identifier rubyid_fp'>fp</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
    <span class='id identifier rubyid_fp'>fp</span>.<span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="db_filename-instance_method">
  <h3 class='signature priv'>
    #<strong>db_filename</strong>(database_name)   <span class="extras">(<span class='priv'>private</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the file associated with <code>database_name</code>.  Can return nil or an empty string if the database is temporary, or in-memory.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L841-L853'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='841' data-end='853'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 841</span></pre>
<pre class='code cpp'>

static VALUE
db_filename(VALUE self, VALUE db_name)
{
    sqlite3RubyPtr ctx;
    const char *fname;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    fname = sqlite3_db_filename(ctx-&gt;db, StringValueCStr(db_name));

    if (fname) { return SQLITE3_UTF8_STR_NEW2(fname); }
    return Qnil;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="define_aggregator-instance_method">
  <h3 class='signature '>
    #<strong>define_aggregator</strong>(name, aggregator)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define an aggregate function named <code>name</code> using a object template object <code>aggregator</code>. <code>aggregator</code> must respond to <code>step</code> and <code>finalize</code>. <code>step</code> will be called with row information and <code>finalize</code> must return the return value for the aggregator function.</p>

<p>_API Change:_ <code>aggregator</code> must also implement <code>clone</code>. The provided <code>aggregator</code> object will serve as template that is cloned to provide the individual instances of the aggregate function. Regular ruby objects already provide a suitable <code>clone</code>. The functions arity is the arity of the <code>step</code> method.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L541-L575'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='541' data-end='575'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 541</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_define_aggregator'>define_aggregator</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_aggregator'>aggregator</span>)
  <span class='comment'># Previously, this has been implemented in C. Now this is just yet
</span>  <span class='comment'># another compatibility shim
</span>  <span class='id identifier rubyid_proxy'>proxy</span> <span class='op'>=</span> <span class='const'>Class</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="SQLite3::Database.new (method)">new</a></span> <span class='kw'>do</span>
    <span class='ivar'>@template</span> <span class='op'>=</span> <span class='id identifier rubyid_aggregator'>aggregator</span>
    <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_template'>template</span>
      <span class='ivar'>@template</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@name</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_arity'>arity</span>
      <span class='comment'># this is what sqlite3_obj_method_arity did before
</span>      <span class='ivar'>@template</span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_step'>step</span>).<span class='id identifier rubyid_arity'>arity</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
      <span class='ivar'>@klass</span> <span class='op'>=</span> <span class='kw'>self</span>.<span class='id identifier rubyid_class'>class</span>.<span class='id identifier rubyid_template'>template</span>.<span class='id identifier rubyid_clone'>clone</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_step'>step</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
      <span class='ivar'>@klass</span>.<span class='id identifier rubyid_step'>step</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id identifier rubyid_finalize'>finalize</span>
      <span class='ivar'>@klass</span>.<span class='id identifier rubyid_finalize'>finalize</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_define_aggregator2'><a href="#define_aggregator2-instance_method" title="SQLite3::Database#define_aggregator2 (method)">define_aggregator2</a></span>(<span class='id identifier rubyid_proxy'>proxy</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>)
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="define_aggregator2-instance_method">
  <h3 class='signature priv'>
    #<strong>define_aggregator2</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L900'>GitHub</a> ]</span>

</section>

<section class='method_details' id="define_function-instance_method">
  <h3 class='signature '>
    #<strong>define_function</strong>(name) {|args, ...| ... }   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define a function named <code>name</code> with <code>args</code>.  The arity of the block will be used as the arity for the function defined.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L464-L468'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='464' data-end='468'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 464</span></pre>
<pre class='code cpp'>

static VALUE
define_function(VALUE self, VALUE name)
{
    return define_function_with_flags(self, name, INT2FIX(SQLITE_UTF8));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="define_function_with_flags-instance_method">
  <h3 class='signature '>
    #<strong>define_function_with_flags</strong>(name, flags) {|args, ...| ... }   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Define a function named <code>name</code> with <code>args</code> using TextRep bitflags <code>flags</code>.  The arity of the block will be used as the arity for the function defined.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L429-L457'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='429' data-end='457'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 429</span></pre>
<pre class='code cpp'>

static VALUE
define_function_with_flags(VALUE self, VALUE name, VALUE flags)
{
    sqlite3RubyPtr ctx;
    VALUE block;
    int status;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    block = rb_block_proc();

    status = sqlite3_create_function(
                 ctx-&gt;db,
                 StringValuePtr(name),
                 rb_proc_arity(block),
                 NUM2INT(flags),
                 (void *)block,
                 rb_sqlite3_func,
                 NULL,
                 NULL
             );

    CHECK(ctx-&gt;db, status);

    rb_hash_aset(rb_iv_get(self, &quot;@functions&quot;), name, block);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="disable_quirk_mode-instance_method">
  <h3 class='signature priv'>
    #<strong>disable_quirk_mode</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L104-L120'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='104' data-end='120'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 104</span></pre>
<pre class='code cpp'>

static VALUE
rb_sqlite3_disable_quirk_mode(VALUE self)
{
#if defined SQLITE_DBCONFIG_DQS_DDL
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

    if (!ctx-&gt;db) { return Qfalse; }

    sqlite3_db_config(ctx-&gt;db, SQLITE_DBCONFIG_DQS_DDL, 0, (void *)0);
    sqlite3_db_config(ctx-&gt;db, SQLITE_DBCONFIG_DQS_DML, 0, (void *)0);

    return Qtrue;
#else
    return Qfalse;
#endif
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="enable_load_extension-instance_method">
  <h3 class='signature '>
    #<strong>enable_load_extension</strong>(onoff)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enable or disable extension loading.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L726-L745'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='726' data-end='745'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 726</span></pre>
<pre class='code cpp'>

static VALUE
enable_load_extension(VALUE self, VALUE onoff)
{
    sqlite3RubyPtr ctx;
    int onoffparam;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    if (Qtrue == onoff) {
        onoffparam = 1;
    } else if (Qfalse == onoff) {
        onoffparam = 0;
    } else {
        onoffparam = (int)NUM2INT(onoff);
    }

    CHECK(ctx-&gt;db, sqlite3_enable_load_extension(ctx-&gt;db, onoffparam));

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="encoding-instance_method">
  <h3 class='signature '>
    #<strong>encoding</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Fetch the encoding set on this database</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L148-L150'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='148' data-end='150'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 148</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_encoding'>encoding</span>
  <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PRAGMA encoding</span><span class='tstring_end'>&quot;</span></span>) { <span class='op'>|</span><span class='id identifier rubyid_stmt'>stmt</span><span class='op'>|</span> <span class='const'>Encoding</span>.<span class='id identifier rubyid_find'>find</span>(<span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_first'>first</span>) }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="errcode-instance_method">
  <h3 class='signature '>
    #<strong>errcode</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return an integer representing the last error to have occurred with this database.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L506-L514'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='506' data-end='514'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 506</span></pre>
<pre class='code cpp'>

static VALUE
errcode_(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return INT2NUM(sqlite3_errcode(ctx-&gt;db));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="errmsg-instance_method">
  <h3 class='signature '>
    #<strong>errmsg</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Return a string describing the last error to have occurred with this database.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L491-L499'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='491' data-end='499'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 491</span></pre>
<pre class='code cpp'>

static VALUE
errmsg(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return rb_str_new2(sqlite3_errmsg(ctx-&gt;db));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="exec_batch-instance_method">
  <h3 class='signature priv'>
    #<strong>exec_batch</strong>(sql, results_as_hash)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is invoked by calling db.execute_batch2(sql, &amp;block)</p>

<p>Executes all statements in a given string separated by semicolons. If a query is made, all values returned are strings (except for ‘NULL’ values which return nil), so the user may parse values with a block. If no query is made, an empty array will be returned.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L810-L834'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='810' data-end='834'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 810</span></pre>
<pre class='code cpp'>

static VALUE
exec_batch(VALUE self, VALUE sql, VALUE results_as_hash)
{
    sqlite3RubyPtr ctx;
    int status;
    VALUE callback_ary = rb_ary_new();
    char *errMsg;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    if (results_as_hash == Qtrue) {
        status = sqlite3_exec(ctx-&gt;db, StringValuePtr(sql), (sqlite3_callback)hash_callback_function,
                              (void *)callback_ary,
                              &amp;errMsg);
    } else {
        status = sqlite3_exec(ctx-&gt;db, StringValuePtr(sql), (sqlite3_callback)regular_callback_function,
                              (void *)callback_ary,
                              &amp;errMsg);
    }

    CHECK_MSG(ctx-&gt;db, status, errMsg);

    return callback_ary;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="execute-instance_method">
  <h3 class='signature '>
    #<strong>execute</strong>(sql, bind_vars = [], &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Executes the given SQL statement. If additional parameters are given, they are treated as bind variables, and are bound to the placeholders in the query.</p>

<p>Note that if any of the values passed to this are hashes, then the key/value pairs are each bound separately, with the key being used as the name of the placeholder to bind the value to.</p>

<p>The block is optional. If given, it will be invoked for each row returned by the query. Otherwise, any results are accumulated into an array and returned wholesale.</p>

<p>See also <a href="#execute2-instance_method" title="SQLite3::Database#execute2 (method)">#execute2</a>, <a href="#query-instance_method" title="SQLite3::Database#query (method)">#query</a>, and <a href="#execute_batch-instance_method" title="SQLite3::Database#execute_batch (method)">#execute_batch</a> for additional ways of executing statements.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L197-L210'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='197' data-end='210'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 197</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_execute'>execute</span> <span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_vars'>bind_vars</span> <span class='op'>=</span> []<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>(<span class='id identifier rubyid_sql'>sql</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stmt'>stmt</span><span class='op'>|</span>
    <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_bind_params'>bind_params</span>(<span class='id identifier rubyid_bind_vars'>bind_vars</span>)
    <span class='id identifier rubyid_stmt'>stmt</span> <span class='op'>=</span> <span class='id identifier rubyid_build_result_set'><a href="#build_result_set-instance_method" title="SQLite3::Database#build_result_set (method)">build_result_set</a></span> <span class='id identifier rubyid_stmt'>stmt</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
      <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span>
        <span class='kw'>yield</span> <span class='id identifier rubyid_row'>row</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_to_a'>to_a</span>.<span class='id identifier rubyid_freeze'>freeze</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="execute2-instance_method">
  <h3 class='signature '>
    #<strong>execute2</strong>(sql, *bind_vars)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Executes the given SQL statement, exactly as with <a href="#execute-instance_method" title="SQLite3::Database#execute (method)">#execute</a>. However, the first row returned (either via the block, or in the returned array) is always the names of the columns. Subsequent rows correspond to the data from the result set.</p>

<p>Thus, even if the query itself returns no rows, this method will always return at least one row–the names of the columns.</p>

<p>See also <a href="#execute-instance_method" title="SQLite3::Database#execute (method)">#execute</a>, <a href="#query-instance_method" title="SQLite3::Database#query (method)">#query</a>, and <a href="#execute_batch-instance_method" title="SQLite3::Database#execute_batch (method)">#execute_batch</a> for additional ways of executing statements.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L222-L234'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='222' data-end='234'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 222</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_execute2'>execute2</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_bind_vars'>bind_vars</span>)
  <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>(<span class='id identifier rubyid_sql'>sql</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stmt'>stmt</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span>(<span class='op'>*</span><span class='id identifier rubyid_bind_vars'>bind_vars</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_columns'>columns</span>
      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='op'>|</span> <span class='kw'>yield</span> <span class='id identifier rubyid_row'>row</span> }
    <span class='kw'>else</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_each_with_object'>each_with_object</span>([<span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_columns'>columns</span>]) { <span class='op'>|</span><span class='id identifier rubyid_row'>row</span><span class='comma'>,</span> <span class='id identifier rubyid_arr'>arr</span><span class='op'>|</span>
               <span class='id identifier rubyid_arr'>arr</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_row'>row</span>
             }
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="execute_batch-instance_method">
  <h3 class='signature '>
    #<strong>execute_batch</strong>(sql, bind_vars = [])  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Executes all SQL statements in the given string. By contrast, the other means of executing queries will only execute the first statement in the string, ignoring all subsequent statements. This will execute each one in turn. The same bind parameters, if given, will be applied to each statement.</p>

<p>This always returns the result of the last statement.</p>

<p>See also <a href="#execute_batch2-instance_method" title="SQLite3::Database#execute_batch2 (method)">#execute_batch2</a> for additional ways of executing statements.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L246-L264'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='246' data-end='264'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 246</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_execute_batch'>execute_batch</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_vars'>bind_vars</span> <span class='op'>=</span> [])
  <span class='id identifier rubyid_sql'>sql</span> <span class='op'>=</span> <span class='id identifier rubyid_sql'>sql</span>.<span class='id identifier rubyid_strip'>strip</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>until</span> <span class='id identifier rubyid_sql'>sql</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>(<span class='id identifier rubyid_sql'>sql</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stmt'>stmt</span><span class='op'>|</span>
      <span class='kw'>unless</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_closed?'><a href="#closed%3F-instance_method" title="SQLite3::Database#closed? (method)">closed?</a></span>
        <span class='comment'># FIXME: this should probably use sqlite3&#39;s api for batch execution
</span>        <span class='comment'># This implementation requires stepping over the results.
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_bind_vars'>bind_vars</span>.<span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_bind_parameter_count'>bind_parameter_count</span>
          <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_bind_params'>bind_params</span>(<span class='id identifier rubyid_bind_vars'>bind_vars</span>)
        <span class='kw'>end</span>
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_step'>step</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_sql'>sql</span> <span class='op'>=</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_remainder'>remainder</span>.<span class='id identifier rubyid_strip'>strip</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="execute_batch2-instance_method">
  <h3 class='signature '>
    #<strong>execute_batch2</strong>(sql, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Executes all SQL statements in the given string. By contrast, the other means of executing queries will only execute the first statement in the string, ignoring all subsequent statements. This will execute each one in turn. Bind parameters cannot be passed to <code>#execute_batch2</code>.</p>

<p>If a query is made, all values will be returned as strings. If no query is made, an empty array will be returned.</p>

<p>Because all values except for ‘NULL’ are returned as strings, a block can be passed to parse the values accordingly.</p>

<p>See also <a href="#execute_batch-instance_method" title="SQLite3::Database#execute_batch (method)">#execute_batch</a> for additional ways of executing statements.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L279-L288'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='279' data-end='288'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 279</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_execute_batch2'>execute_batch2</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_exec_batch'><a href="#exec_batch-instance_method" title="SQLite3::Database#exec_batch (method)">exec_batch</a></span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='ivar'>@results_as_hash</span>)
    <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_val'>val</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_exec_batch'><a href="#exec_batch-instance_method" title="SQLite3::Database#exec_batch (method)">exec_batch</a></span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='ivar'>@results_as_hash</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="filename-instance_method">
  <h3 class='signature '>
    #<strong>filename</strong>(db_name = &quot;main&quot;)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the filename for the database named <code>db_name</code>.  <code>db_name</code> defaults to “main”.  Main return <code>nil</code> or an empty string if the database is temporary or in-memory.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L179-L181'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='179' data-end='181'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 179</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_filename'>filename</span> <span class='id identifier rubyid_db_name'>db_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_db_filename'><a href="#db_filename-instance_method" title="SQLite3::Database#db_filename (method)">db_filename</a></span> <span class='id identifier rubyid_db_name'>db_name</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_first_row-instance_method">
  <h3 class='signature '>
    #<strong>get_first_row</strong>(sql, *bind_vars)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A convenience method for obtaining the first row of a result set, and discarding all others. It is otherwise identical to <a href="#execute-instance_method" title="SQLite3::Database#execute (method)">#execute</a>.</p>

<p>See also <a href="#get_first_value-instance_method" title="SQLite3::Database#get_first_value (method)">#get_first_value</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L318-L320'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='318' data-end='320'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 318</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_first_row'>get_first_row</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_bind_vars'>bind_vars</span>)
  <span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_bind_vars'>bind_vars</span>).<span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_first_value-instance_method">
  <h3 class='signature '>
    #<strong>get_first_value</strong>(sql, *bind_vars)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A convenience method for obtaining the first value of the first row of a result set, and discarding all other values and rows. It is otherwise identical to <a href="#execute-instance_method" title="SQLite3::Database#execute (method)">#execute</a>.</p>

<p>See also <a href="#get_first_row-instance_method" title="SQLite3::Database#get_first_row (method)">#get_first_row</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L327-L334'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='327' data-end='334'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 327</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_get_first_value'>get_first_value</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_bind_vars'>bind_vars</span>)
  <span class='id identifier rubyid_query'><a href="#query-instance_method" title="SQLite3::Database#query (method)">query</a></span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_vars'>bind_vars</span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rs'>rs</span><span class='op'>|</span>
    <span class='kw'>if</span> (<span class='id identifier rubyid_row'>row</span> <span class='op'>=</span> <span class='id identifier rubyid_rs'>rs</span>.<span class='id identifier rubyid_next'>next</span>)
      <span class='kw'>return</span> <span class='ivar'>@results_as_hash</span> <span class='op'>?</span> <span class='id identifier rubyid_row'>row</span>[<span class='id identifier rubyid_rs'>rs</span>.<span class='id identifier rubyid_columns'>columns</span>[<span class='int'>0</span>]] <span class='op'>:</span> <span class='id identifier rubyid_row'>row</span>[<span class='int'>0</span>]
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="interrupt-instance_method">
  <h3 class='signature '>
    #<strong>interrupt</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Interrupts the currently executing operation, causing it to abort.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L474-L484'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='474' data-end='484'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 474</span></pre>
<pre class='code cpp'>

static VALUE
interrupt(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    sqlite3_interrupt(ctx-&gt;db);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="last_insert_row_id-instance_method">
  <h3 class='signature '>
    #<strong>last_insert_row_id</strong>    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Obtains the unique row ID of the last row to be inserted by this <code>Database</code> instance.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L305-L313'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='305' data-end='313'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 305</span></pre>
<pre class='code cpp'>

static VALUE
last_insert_row_id(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return LL2NUM(sqlite3_last_insert_rowid(ctx-&gt;db));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="load_extension-instance_method">
  <h3 class='signature '>
    #<strong>load_extension</strong>(file)    </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Loads an SQLite extension library from the named file. Extension loading must be enabled using db.enable_load_extension(true) prior to calling this API.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L703-L718'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='703' data-end='718'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 703</span></pre>
<pre class='code cpp'>

static VALUE
load_extension(VALUE self, VALUE file)
{
    sqlite3RubyPtr ctx;
    int status;
    char *errMsg;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    status = sqlite3_load_extension(ctx-&gt;db, StringValuePtr(file), 0, &amp;errMsg);

    CHECK_MSG(ctx-&gt;db, status, errMsg);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open16-instance_method">
  <h3 class='signature priv'>
    #<strong>open16</strong>(file)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L855-L877'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='855' data-end='877'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 855</span></pre>
<pre class='code cpp'>

static VALUE
rb_sqlite3_open16(VALUE self, VALUE file)
{
    int status;
    sqlite3RubyPtr ctx;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

#if defined TAINTING_SUPPORT
#if defined StringValueCStr
    StringValuePtr(file);
    rb_check_safe_obj(file);
#else
    Check_SafeStr(file);
#endif
#endif

    status = sqlite3_open16(utf16_string_value_ptr(file), &amp;ctx-&gt;db);

    CHECK(ctx-&gt;db, status)

    return INT2NUM(status);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="open_v2-instance_method">
  <h3 class='signature priv'>
    #<strong>open_v2</strong>(file, mode, zvfs)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L75-L102'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='75' data-end='102'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 75</span></pre>
<pre class='code cpp'>

static VALUE
rb_sqlite3_open_v2(VALUE self, VALUE file, VALUE mode, VALUE zvfs)
{
    sqlite3RubyPtr ctx;
    int status;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);

#if defined TAINTING_SUPPORT
#  if defined StringValueCStr
    StringValuePtr(file);
    rb_check_safe_obj(file);
#  else
    Check_SafeStr(file);
#  endif
#endif

    status = sqlite3_open_v2(
                 StringValuePtr(file),
                 &amp;ctx-&gt;db,
                 NUM2INT(mode),
                 NIL_P(zvfs) ? NULL : StringValuePtr(zvfs)
             );

    CHECK(ctx-&gt;db, status)

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="prepare-instance_method">
  <h3 class='signature '>
    #<strong>prepare</strong>(sql)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a <a href="Statement.html" title="SQLite3::Statement (class)"><code>Statement</code></a> object representing the given SQL. This does not execute the statement; it merely prepares the statement for execution.</p>

<p>The Statement can then be executed using <a href="Statement.html#execute-instance_method" title="SQLite3::Statement#execute (method)">Statement#execute</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L165-L174'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='165' data-end='174'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 165</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare'>prepare</span> <span class='id identifier rubyid_sql'>sql</span>
  <span class='id identifier rubyid_stmt'>stmt</span> <span class='op'>=</span> <span class='const'><a href="../SQLite3.html" title="SQLite3 (module)">SQLite3</a></span><span class='op'>::</span><span class='const'><a href="Statement.html" title="SQLite3::Statement (class)">Statement</a></span>.<span class='id identifier rubyid_new'><a href="Statement.html#new-class_method" title="SQLite3::Statement.new (method)">new</a></span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_sql'>sql</span>)
  <span class='kw'>return</span> <span class='id identifier rubyid_stmt'>stmt</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='kw'>begin</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_stmt'>stmt</span>
  <span class='kw'>ensure</span>
    <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="SQLite3::Database#close (method)">close</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_stmt'>stmt</span>.<span class='id identifier rubyid_closed?'><a href="#closed%3F-instance_method" title="SQLite3::Database#closed? (method)">closed?</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="query-instance_method">
  <h3 class='signature '>
    #<strong>query</strong>(sql, bind_vars = [])  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>This is a convenience method for creating a statement, binding parameters to it, and calling execute:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_query'>query</span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select * from foo where a=?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> [<span class='int'>5</span>])
<span class='comment'># is the same as
</span><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_db'>db</span>.<span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>( <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>select * from foo where a=?</span><span class='tstring_end'>&quot;</span></span> ).<span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span>( <span class='int'>5</span> )</code></pre>

<p>You must be sure to call <a href="#close-instance_method" title="SQLite3::Database#close (method)">#close</a> on the <a href="ResultSet.html" title="SQLite3::ResultSet (class)"><code>ResultSet</code></a> instance that is returned, or you could have problems with locks on the table. If called with a block, <a href="#close-instance_method" title="SQLite3::Database#close (method)">#close</a> will be invoked implicitly when the block terminates.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L301-L312'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='301' data-end='312'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 301</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_query'>query</span>(<span class='id identifier rubyid_sql'>sql</span><span class='comma'>,</span> <span class='id identifier rubyid_bind_vars'>bind_vars</span> <span class='op'>=</span> [])
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_prepare'><a href="#prepare-instance_method" title="SQLite3::Database#prepare (method)">prepare</a></span>(<span class='id identifier rubyid_sql'>sql</span>).<span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span>(<span class='id identifier rubyid_bind_vars'>bind_vars</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_result'>result</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_result'>result</span>.<span class='id identifier rubyid_close'><a href="#close-instance_method" title="SQLite3::Database#close (method)">close</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="rollback-instance_method">
  <h3 class='signature '>
    #<strong>rollback</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Rolls the current transaction back. If there is no current transaction, this will cause an error to be raised. This returns <code>true</code>, in order to allow it to be used in idioms like <code>abort? and rollback or commit</code>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L627-L630'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='627' data-end='630'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 627</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_rollback'>rollback</span>
  <span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rollback transaction</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="total_changes-instance_method">
  <h3 class='signature '>
    #<strong>total_changes</strong>  &#x21d2; ?   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the total number of changes made to this database instance since it was opened.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L163-L171'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='163' data-end='171'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 163</span></pre>
<pre class='code cpp'>

static VALUE
total_changes(VALUE self)
{
    sqlite3RubyPtr ctx;
    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    return INT2NUM(sqlite3_total_changes(ctx-&gt;db));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="trace-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>trace</strong> {|sql| ... } </span>
      <span class='overload'>#<strong>trace</strong>(Class.new { def call sql; end }.new)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Installs (or removes) a block that will be invoked for every SQL statement executed. The block receives one parameter: the SQL statement executed. If the block is <code>nil</code>, any existing tracer will be uninstalled.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/ext/sqlite3/database.c#L189-L207'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='189' data-end='207'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'ext/sqlite3/database.c', line 189</span></pre>
<pre class='code cpp'>

static VALUE
trace(int argc, VALUE *argv, VALUE self)
{
    sqlite3RubyPtr ctx;
    VALUE block;

    TypedData_Get_Struct(self, sqlite3Ruby, &amp;database_type, ctx);
    REQUIRE_OPEN_DB(ctx);

    rb_scan_args(argc, argv, &quot;01&quot;, &amp;block);

    if (NIL_P(block) &amp;&amp; rb_block_given_p()) { block = rb_block_proc(); }

    rb_iv_set(self, &quot;@tracefunc&quot;, block);

    sqlite3_trace(ctx-&gt;db, NIL_P(block) ? NULL : tracefunc, (void *)self);

    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="transaction-instance_method">
  <h3 class='signature '>
    #<strong>transaction</strong>(mode = nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Begins a new transaction. Note that nested transactions are not allowed by SQLite, so attempting to nest a transaction will result in a runtime exception.</p>

<p>The <code>mode</code> parameter may be either <code>:deferred</code>, <code>:immediate</code>, or <code>:exclusive</code>. If <code>nil</code> is specified, the default transaction mode, which was passed to <code>#initialize</code>, is used.</p>

<p>If a block is given, the database instance is yielded to it, and the transaction is committed when the block terminates. If the block raises an exception, a rollback will be performed instead. Note that if a block is given, <a href="#commit-instance_method" title="SQLite3::Database#commit (method)">#commit</a> and <a href="#rollback-instance_method" title="SQLite3::Database#rollback (method)">#rollback</a> should never be called explicitly or you’ll get an error when the block terminates.</p>

<p>If a block is not given, it is the caller’s responsibility to end the transaction explicitly, either by calling <a href="#commit-instance_method" title="SQLite3::Database#commit (method)">#commit</a>, or by calling <a href="#rollback-instance_method" title="SQLite3::Database#rollback (method)">#rollback</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/sparklemotion/sqlite3-ruby/blob/main/lib/sqlite3/database.rb#L595-L612'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='595' data-end='612'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/sqlite3/database.rb', line 595</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_transaction'>transaction</span>(<span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_mode'>mode</span> <span class='op'>=</span> <span class='ivar'>@default_transaction_mode</span> <span class='kw'>if</span> <span class='id identifier rubyid_mode'>mode</span>.<span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_execute'><a href="#execute-instance_method" title="SQLite3::Database#execute (method)">execute</a></span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>begin </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_mode'>mode</span><span class='embexpr_end'>}</span><span class='tstring_content'> transaction</span><span class='tstring_end'>&quot;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_abort'>abort</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>begin</span>
      <span class='kw'>yield</span> <span class='kw'>self</span>
    <span class='kw'>rescue</span>
      <span class='id identifier rubyid_abort'>abort</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_raise'>raise</span>
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_abort'>abort</span> <span class='kw'>and</span> <span class='id identifier rubyid_rollback'><a href="#rollback-instance_method" title="SQLite3::Database#rollback (method)">rollback</a></span> <span class='kw'>or</span> <span class='id identifier rubyid_commit'><a href="#commit-instance_method" title="SQLite3::Database#commit (method)">commit</a></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>