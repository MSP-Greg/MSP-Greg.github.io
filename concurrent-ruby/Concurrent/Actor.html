<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Concurrent::Actor &mdash; Concurrent Ruby master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Concurrent::Actor",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Concurrent</a> &raquo; 
      <a href='../_index.html#alpha_A'>Index (A)</a> &raquo; 
        <a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Actor&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Concurrent::Actor</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Namespace Children</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Modules:</div>
      <div class='box_11'>
          <a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)"><code>Behaviour</code></a>,
        <a href="Actor/InternalDelegations.html" title="Concurrent::Actor::InternalDelegations (module)"><code>InternalDelegations</code></a>,
        <a href="Actor/PublicDelegations.html" title="Concurrent::Actor::PublicDelegations (module)"><code>PublicDelegations</code></a>,
        <a href="Actor/TypeCheck.html" title="Concurrent::Actor::TypeCheck (module)"><code>TypeCheck</code></a>,
        <a href="Actor/Utils.html" title="Concurrent::Actor::Utils (module)"><code>Utils</code></a>      </div>
    </td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Classes:</div>
      <div class='box_11'>
          <a href="Actor/AbstractContext.html" title="Concurrent::Actor::AbstractContext (class)"><code>AbstractContext</code></a>,
        <a href="Actor/ActorTerminated.html" title="Concurrent::Actor::ActorTerminated (class)"><code>ActorTerminated</code></a>,
        <a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a>,
        <a href="Actor/Core.html" title="Concurrent::Actor::Core (class)"><code>Core</code></a>,
        <a href="Actor/DefaultDeadLetterHandler.html" title="Concurrent::Actor::DefaultDeadLetterHandler (class)"><code>DefaultDeadLetterHandler</code></a>,
        <a href="Actor/Envelope.html" title="Concurrent::Actor::Envelope (class)"><code>Envelope</code></a>,
        <a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)"><code>Reference</code></a>,
        <a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>,
        <a href="Actor/Root.html" title="Concurrent::Actor::Root (class)"><code>Root</code></a>,
        <a href="Actor/UnknownMessage.html" title="Concurrent::Actor::UnknownMessage (class)"><code>UnknownMessage</code></a>      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L17'>lib/concurrent-ruby-edge/concurrent/actor.rb</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour.rb#L2'>lib/concurrent-ruby-edge/concurrent/actor/behaviour.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/context.rb#L6'>lib/concurrent-ruby-edge/concurrent/actor/context.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/core.rb#L8'>lib/concurrent-ruby-edge/concurrent/actor/core.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/default_dead_letter_handler.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/default_dead_letter_handler.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/envelope.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/envelope.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/errors.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/errors.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/internal_delegations.rb#L5'>lib/concurrent-ruby-edge/concurrent/actor/internal_delegations.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/public_delegations.rb#L2'>lib/concurrent-ruby-edge/concurrent/actor/public_delegations.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/reference.rb#L5'>lib/concurrent-ruby-edge/concurrent/actor/reference.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/root.rb#L5'>lib/concurrent-ruby-edge/concurrent/actor/root.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/type_check.rb#L2'>lib/concurrent-ruby-edge/concurrent/actor/type_check.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/utils.rb#L2'>lib/concurrent-ruby-edge/concurrent/actor/utils.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/abstract.rb#L6'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/abstract.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/awaits.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/awaits.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/buffer.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/buffer.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/errors_on_unknown_message.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/errors_on_unknown_message.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/executes_context.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/executes_context.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/linking.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/linking.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/pausing.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/pausing.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/removes_child.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/removes_child.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/sets_results.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/sets_results.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/supervising.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/supervising.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/behaviour/termination.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/behaviour/termination.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/utils/ad_hoc.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/utils/ad_hoc.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/utils/balancer.rb#L4'>lib/concurrent-ruby-edge/concurrent/actor/utils/balancer.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/utils/broadcast.rb#L5'>lib/concurrent-ruby-edge/concurrent/actor/utils/broadcast.rb</a>,<br/> <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/utils/pool.rb#L5'>lib/concurrent-ruby-edge/concurrent/actor/utils/pool.rb</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>**Edge Features** are under active development and may change frequently.</p>
<ul><li>
<p>Deprecations are not added before incompatible changes.</p>
</li><li>
<p><a href="Edge.html" title="Concurrent::Edge (module)"><code>Edge</code></a> version: <em>major</em> is always 0, <em>minor</em> bump means incompatible change, <em>patch</em> bump means compatible change.</p>
</li><li>
<p><a href="Edge.html" title="Concurrent::Edge (module)"><code>Edge</code></a> features may also lack tests and documentation.</p>
</li><li>
<p>Features developed in <code>concurrent-ruby-edge</code> are expected to move to <code>concurrent-ruby</code> when finalised.</p>
</li></ul>
</div>
  </div>


<p><h3>Actor model</h3>

<ul>
<li> Light-weighted running on thread-pool.</li>
<li> Inspired by Akka and Erlang.</li>
<li> Modular.</li>
</ul>

<p>This Actor model implementation makes actors very cheap to create and discard.
Thousands of actors can be created, allowing you to break the program into smaller 
maintainable pieces, without violating the single responsibility principle.</p>

<h4>What is an actor model?</h4>

<p>Actor-based concurrency is all the rage in some circles. Originally described in 1973, the actor model is a paradigm 
for creating asynchronous, concurrent objects  that is becoming increasingly popular. Much has changed since actors 
were first  written about four decades ago, which has led to a serious fragmentation within  the actor community. 
There is <em>no</em> universally accepted, strict definition of &quot;actor&quot; and actor implementations differ widely between 
languages and libraries.  </p>

<p><a href="http://en.wikipedia.org/wiki/Actor_model" target="_parent" title="Wiki">Wiki</a> definition is pretty good:
<em>The actor model in computer science is a mathematical model of concurrent computation
that treats <strong>actors</strong> as the universal primitives of concurrent digital computation:
in response to a message that it receives, an actor can make local decisions,
create more actors, send more messages, and determine how to respond to the next
message received.</em></p>

<h4>Why?</h4>

<p>Concurrency is hard to get right, actors are one of many ways how to simplify the problem.</p>

<h4>Quick example</h4>

<p>An example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Counter</span> <span class='op'>&lt;</span> <span class='const'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'>Actor</span><span class='op'>::</span><span class='const'><a href="Actor/Context.html" title="Concurrent::Actor::Context (class)">Context</a></span>
  <span class='comment'># Include context of an actor which gives this class access to reference
</span>  <span class='comment'># and other information about the actor
</span>
  <span class='comment'># use initialize as you wish
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../Concurrent.html#initialize-instance_method" title="Concurrent#initialize (method)">initialize</a></span>(<span class='id identifier rubyid_initial_value'>initial_value</span>)
    <span class='ivar'>@count</span> <span class='op'>=</span> <span class='id identifier rubyid_initial_value'>initial_value</span>
  <span class='kw'>end</span>

  <span class='comment'># override on_message to define actor&#39;s behaviour
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_on_message'>on_message</span>(<span class='id identifier rubyid_message'>message</span>)
    <span class='kw'>if</span> <span class='const'>Integer</span> <span class='op'>===</span> <span class='id identifier rubyid_message'>message</span>
      <span class='ivar'>@count</span> <span class='op'>+=</span> <span class='id identifier rubyid_message'>message</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span> <span class='comment'>#
</span>
<span class='comment'>### Create new actor naming the instance &#39;first&#39;.
</span><span class='comment'>### Return value is a reference to the actor, the actual actor is never returned.
</span><span class='id identifier rubyid_counter'>counter</span> <span class='op'>=</span> <span class='const'>Counter</span>.<span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='int'>5</span>)

<span class='comment'>### Tell a message and forget returning self.
</span><span class='id identifier rubyid_counter'>counter</span>.<span class='id identifier rubyid_tell'>tell</span>(<span class='int'>1</span>)
<span class='id identifier rubyid_counter'>counter</span> <span class='op'>&lt;&lt;</span> <span class='int'>1</span>
<span class='comment'>### (First counter now contains 7.)
</span>
<span class='comment'>### Send a messages asking for a result.
</span><span class='id identifier rubyid_counter'>counter</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='int'>0</span>).<span class='id identifier rubyid_class'>class</span>
<span class='id identifier rubyid_counter'>counter</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='int'>0</span>).<span class='id identifier rubyid_value'>value</span></code></pre>

<p>class Adder &lt; <a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>
  def initialize(init)
    @count = init
  end</p>

<p>def on_message(message)
    case message
    when :add
      @count += 1
    else
      # pass to ErrorsOnUnknownMessage behaviour, which will just fail
      pass
    end
  end
end </p>

<h3><code>link: true</code> makes the actor linked to root actor and supervised</h3>

<h3>which is default behavior</h3>

<p>adder = <code>Adder.spawn</code>(name: <code>:adder</code>, link: true, args: [1])
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedd8e3d40 /adder (Adder)>
adder.parent
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedbaa1e90 / (Concurrent::Actor::Root)></p>

<h3>tell and forget</h3>

<p>adder.tell(:add).tell(:add)
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedd8e3d40 /adder (Adder)></p>

<h3>ask to get result</h3>

<p>adder.ask!(:add)                                   # =&gt; 4</p>

<h3>fail the actor</h3>

<p>adder.ask!(:bad) rescue $!
    # =&gt; #<Concurrent::Actor::UnknownMessage: :bad from #<Thread:0x007fbedb8809b8>&gt;</p>

<h3>actor is restarted with initial values</h3>

<p>adder.ask!(:add)                                   # =&gt; 2
adder.ask!(:terminate!)                            # =&gt; true</p>

<h4>Spawning actors</h4>

<ul>
<li>  <a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">.spawn</a> and <a href="#spawn!-class_method" title="Concurrent::Actor.spawn! (method)">.spawn!</a></li>
<li>  <a href="Actor/AbstractContext.html#spawn-class_method" title="Concurrent::Actor::AbstractContext.spawn (method)">AbstractContext.spawn</a> and <a href="Actor/AbstractContext.html#spawn!-class_method" title="Concurrent::Actor::AbstractContext.spawn! (method)">AbstractContext.spawn!</a> </li>
</ul>

<h4>Sending messages</h4>

<ul>
<li>  <a href="Actor/Reference.html#tell-instance_method" title="Concurrent::Actor::Reference#tell (method)">Reference#tell</a> 
Sends the message asynchronously to the actor and immediately returns <code>self</code> (the reference) allowing to chain message telling.</li>
<li>  <a href="Actor/Reference.html#ask-instance_method" title="Concurrent::Actor::Reference#ask (method)">Reference#ask</a>
</li>
<li>  <a href="Actor/Reference.html#ask!-instance_method" title="Concurrent::Actor::Reference#ask! (method)">Reference#ask!</a>
Sends the message synchronously and blocks until the message is processed. Raises on error.</li>
</ul>

<p>Messages are processed in same order as they are sent by a sender. It may interleaved with
messages from other senders though.</p>

<h5>Immutability</h5>

<p>Messages sent between actors should be <strong>immutable</strong>. Gems like</p>

<ul>
<li><a href="https://github.com/pitr-ch/algebrick" target="_parent" title="Algebrick">Algebrick</a> - Typed struct on steroids based on
algebraic types and pattern matching</li>
<li><a href="https://github.com/hamstergem/hamster" target="_parent" title="Hamster">Hamster</a> - Efficient, Immutable, Thread-Safe
Collection classes for Ruby</li>
</ul>

<p>are very helpful.</p>

<p>require &#39;algebrick&#39;                                # =&gt; true</p>

<h3>Actor message protocol definition with Algebrick</h3>

<p>Protocol = <code>Algebrick.type</code> do
  variants Add      = type { fields! a: Numeric, b: Numeric },
           Subtract = type { fields! a: Numeric, b: Numeric }
end                                                # =&gt; Protocol(Add | Subtract)</p>

<p>class Calculator &lt; <a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>
  include Algebrick::Matching</p>

<p>def on_message(message)
    # pattern matching on the message with deconstruction
    # ~ marks values which are passed to the block
    match message,
          (on Add.(~any, ~any) do |a, b|
            a + b
          end),
          # or using multi-assignment
          (on ~Subtract do |(a, b)|
            a - b
          end)
  end
end </p>

<p>calculator = <code>Calculator.spawn</code>(&#39;calculator&#39;)
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedba52d90 /calculator (Calculator)>
addition = calculator.ask Add[1, 2]
    # =&gt; &lt;#Concurrent::Promises::Future:0x7fbedc05f7b0 pending&gt;
subtraction = calculator.ask Subtract[1, 0.5]
    # =&gt; &lt;#Concurrent::Promises::Future:0x7fbedd891388 pending&gt;
results = (addition &amp; subtraction)
    # =&gt; &lt;#Concurrent::Promises::Future:0x7fbedc04eeb0 pending&gt;
results.value!                                     # =&gt; [3, 0.5]</p>

<p>calculator.ask! :terminate!                        # =&gt; true</p>

<h4>Actor definition</h4>

<p>New actor is defined by subclassing <a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>, <a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a> and defining its abstract methods. <a href="Actor/AbstractContext.html" title="Concurrent::Actor::AbstractContext (class)"><code>AbstractContext</code></a> can be subclassed directly to implement more specific behaviour see <a href="Actor/Root.html" title="Concurrent::Actor::Root (class)"><code>Root</code></a> implementation.</p>
<ul><li>
<p><a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a></p>

<p>&gt; Basic Context of an <code>Actor</code>. It supports only linking and it simply terminates on error. Uses <a href="Actor/Behaviour.html#basic_behaviour_definition-class_method" title="Concurrent::Actor::Behaviour.basic_behaviour_definition (method)">Behaviour.basic_behaviour_definition</a>:</p>
</li><li>
<p><a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>.</p>

<p>&gt; <a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a> of an <code>Actor</code> for robust systems. It supports supervision, linking, pauses on error. Uses <a href="Actor/Behaviour.html#restarting_behaviour_definition-class_method" title="Concurrent::Actor::Behaviour.restarting_behaviour_definition (method)">Behaviour.restarting_behaviour_definition</a></p>
</li></ul>

<p>Example of ac actor definition:</p>

<p><pre class="code ruby"><span class='const'>Message</span> <span class='op'>=</span> {<span class='const'>Struct</span>.<span class='id identifier rubyid_new'>new</span>} <span class='symbeg'>:</span><span class='id identifier rubyid_action'>action</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span> 

<span class='kw'>class</span> <span class='const'>AnActor</span> <span class='op'>&lt;</span> {<span class='const'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'>Actor</span><span class='op'>::</span><span class='const'><a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)">RestartingContext</a></span>}
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../Concurrent.html#initialize-instance_method" title="Concurrent#initialize (method)">initialize</a></span>(<span class='id identifier rubyid_init'>init</span>)
    <span class='ivar'>@counter</span> <span class='op'>=</span> <span class='id identifier rubyid_init'>init</span>
  <span class='kw'>end</span>

  <span class='comment'># override #on_message to define actor&#39;s behaviour on message received
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_on_message'>on_message</span>(<span class='id identifier rubyid_message'>message</span>)
    <span class='kw'>case</span> <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_action'>action</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_add'>add</span>
      <span class='ivar'>@counter</span> <span class='op'>=</span> <span class='ivar'>@counter</span> <span class='op'>+</span> <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_value'>value</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_subtract'>subtract</span>
      <span class='ivar'>@counter</span> <span class='op'>=</span> <span class='ivar'>@counter</span> <span class='op'>-</span> <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_value'>value</span>
    <span class='kw'>when</span> <span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span>
      <span class='ivar'>@counter</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_pass'>pass</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># set counter to zero when there is an error
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_on_event'>on_event</span>(<span class='id identifier rubyid_event'>event</span>)
    <span class='kw'>if</span> <span class='id identifier rubyid_event'>event</span> <span class='op'>==</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reset'>reset</span>
      <span class='ivar'>@counter</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># ignore initial value
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span> 

<span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>=</span> {<span class='const'>AnActor</span>.<span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span>} <span class='id identifier rubyid_name'>name</span><span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>an_actor</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='op'>:</span> <span class='int'>10</span> 
<span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>&lt;&lt;</span> {<span class='const'>Message</span>.<span class='id identifier rubyid_new'>new</span>}(<span class='symbeg'>:</span><span class='id identifier rubyid_add'>add</span><span class='comma'>,</span> <span class='int'>1</span>) <span class='op'>&lt;&lt;</span> {<span class='const'>Message</span>.<span class='id identifier rubyid_new'>new</span>}(<span class='symbeg'>:</span><span class='id identifier rubyid_subtract'>subtract</span><span class='comma'>,</span> <span class='int'>2</span>) 
<span class='id identifier rubyid_an_actor'>an_actor</span>.<span class='id identifier rubyid_ask!'>ask!</span>(<span class='const'>Message</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>nil</span>))            <span class='comment'># =&gt; 9
</span><span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_boo'>boo</span> <span class='op'>&lt;&lt;</span> {<span class='const'>Message</span>.<span class='id identifier rubyid_new'>new</span>}(<span class='symbeg'>:</span><span class='id identifier rubyid_add'>add</span><span class='comma'>,</span> <span class='int'>1</span>) 
<span class='id identifier rubyid_an_actor'>an_actor</span>.<span class='id identifier rubyid_ask!'>ask!</span>(<span class='const'>Message</span>.<span class='id identifier rubyid_new'>new</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>nil</span>))            <span class='comment'># =&gt; 1
</span><span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='comment'># =&gt; #&lt;Concurrent::Actor::Reference:0x7fbedc137688 /an_actor (AnActor)&gt;</span></pre></p>

<p>See methods of <a href="Actor/AbstractContext.html" title="Concurrent::Actor::AbstractContext (class)"><code>AbstractContext</code></a> what else can be tweaked, e.g <a href="Actor/AbstractContext.html#default_reference_class-instance_method" title="Concurrent::Actor::AbstractContext#default_reference_class (method)">AbstractContext#default_reference_class</a></p>

<h4>Reference</h4>

<p><a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)"><code>Reference</code></a> is public interface of <code>Actor</code> instances. It is used for sending messages and can be freely passed around the application. It also provides some basic information about the actor, see <a href="Actor/PublicDelegations.html" title="Concurrent::Actor::PublicDelegations (module)"><code>PublicDelegations</code></a>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>AdHoc</span>.<span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>printer</span><span class='tstring_end'>&#39;</span></span>) { <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_message'>message</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_message'>message</span> } }
<span class='comment'># =&gt; #&lt;Concurrent::Actor::Reference:0x7fd0d2883218 /printer (Concurrent::Actor::Utils::AdHoc)&gt;
</span><span class='comment'>#                                   ^object_id     ^path     ^context class</span></code></pre>
</p>

<h4>Garbage collection</h4>

<p>Spawned actor cannot be garbage-collected until it&#39;s terminated. There is a reference held in the parent actor.</p>

<h4>Parent-child relationship, name, and path</h4>

<ul>
<li>  <a href="Actor/Core.html#name-instance_method" title="Concurrent::Actor::Core#name (method)">Core#name</a> 
The name of actor instance, it should be uniq (not enforced). Allows easier orientation between actor instances.</li>
<li>  <a href="Actor/Core.html#path-instance_method" title="Concurrent::Actor::Core#path (method)">Core#path</a>
Path of this actor. It is used for easier orientation and logging. Path is constructed recursively with: <code>parent.path + self.name</code> up to a <a href="#root-class_method" title="Concurrent::Actor.root (method)">.root</a>, e.g. <code>/an_actor/its_child</code>.</li>
<li>  <a href="Actor/Core.html#parent-instance_method" title="Concurrent::Actor::Core#parent (method)">Core#parent</a>
A parent <code>Actor</code>. When actor is spawned the <a href="#current-class_method" title="Concurrent::Actor.current (method)">.current</a> becomes its parent. When actor is spawned from a thread outside of an actor (<a href="#current-class_method" title="Concurrent::Actor.current (method)">.current</a> is nil) <a href="#root-class_method" title="Concurrent::Actor.root (method)">.root</a> is assigned. </li>
</ul>

<h4>Behaviour</h4>

<p>Actors have modular architecture, which is achieved by combining a light core with chain of behaviours. Each message or internal event propagates through the chain allowing the behaviours react based on their responsibility.</p>
<ul><li>
<p><a href="Actor/Behaviour/Linking.html" title="Concurrent::Actor::Behaviour::Linking (class)"><code>Actor::Behaviour::Linking</code></a>:</p>

<p>&gt; Links the actor to other actors and sends actor’s events to them, like: <code>:terminated</code>, <code>:paused</code>, <code>:resumed</code>, errors, etc. Linked actor needs to handle those messages.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_listener'>listener</span> <span class='op'>=</span> <span class='const'>AdHoc</span>.<span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span> <span class='label'>name:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_listener'>listener</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_lambda'>lambda</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_message'>message</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_message'>message</span>
    <span class='kw'>when</span> <span class='const'><a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)">Reference</a></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_ask!'>ask!</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_linked?'>linked?</span>)
        <span class='id identifier rubyid_message'>message</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_unlink'>unlink</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_message'>message</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_link'>link</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>got event </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span>.<span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_envelope'>envelope</span>.<span class='id identifier rubyid_sender'>sender</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>=</span> <span class='const'>AdHoc</span>.<span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span> <span class='label'>name:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_an_actor'>an_actor</span><span class='comma'>,</span> <span class='label'>supervise:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>behaviour_definition:</span> <span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span>.<span class='id identifier rubyid_restarting_behaviour_definition'><a href="Actor/Behaviour.html#restarting_behaviour_definition-class_method" title="Concurrent::Actor::Behaviour.restarting_behaviour_definition (method)">restarting_behaviour_definition</a></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_message'>message</span><span class='op'>|</span> <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>failed</span><span class='tstring_end'>&#39;</span></span>}
<span class='kw'>end</span>

<span class='comment'># link the actor
</span><span class='id identifier rubyid_listener'>listener</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='id identifier rubyid_an_actor'>an_actor</span>).<span class='id identifier rubyid_wait'>wait</span>
<span class='id identifier rubyid_an_actor'>an_actor</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_fail'>fail</span>).<span class='id identifier rubyid_wait'>wait</span>
<span class='comment'># unlink the actor
</span><span class='id identifier rubyid_listener'>listener</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='id identifier rubyid_an_actor'>an_actor</span>).<span class='id identifier rubyid_wait'>wait</span>
<span class='id identifier rubyid_an_actor'>an_actor</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_fail'>fail</span>).<span class='id identifier rubyid_wait'>wait</span>
<span class='id identifier rubyid_an_actor'>an_actor</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_terminate!'>terminate!</span></code></pre>

<p>produces only two events, other events happened after unlinking</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_got'>got</span> <span class='id identifier rubyid_event'>event</span> <span class='comment'>#&lt;RuntimeError: failed&gt; from #&lt;Concurrent::Actor::Reference /an_actor (Concurrent::Actor::Utils::AdHoc)&gt;
</span><span class='id identifier rubyid_got'>got</span> <span class='id identifier rubyid_event'>event</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reset'>reset</span> <span class='id identifier rubyid_from'>from</span> <span class='comment'>#&lt;Concurrent::Actor::Reference /an_actor (Concurrent::Actor::Utils::AdHoc)&gt;</span></code></pre>
</p>
</li><li>
<p><a href="Actor/Behaviour/Awaits.html" title="Concurrent::Actor::Behaviour::Awaits (class)"><code>Actor::Behaviour::Awaits</code></a>:</p>

<p>&gt; Accepts <code>:await</code> messages. Which allows to wait on <code>Actor</code> to process all previously send messages.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_actor'>actor</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_a'>a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_b'>b</span>
<span class='id identifier rubyid_actor'>actor</span>.<span class='id identifier rubyid_ask'>ask</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_await'>await</span>).<span class='id identifier rubyid_wait'>wait</span> <span class='comment'># blocks until :a and :b are processed</span></code></pre>
</p>
</li><li>
<p><a href="Actor/Behaviour/Pausing.html" title="Concurrent::Actor::Behaviour::Pausing (class)"><code>Actor::Behaviour::Pausing</code></a>:</p>

<p>&gt; Allows to pause actors on errors. When paused all arriving messages are collected and processed after the actor is resumed or reset. Resume will simply continue with next message. Reset also reinitialized context.</p>
</li><li>
<p><a href="Actor/Behaviour/Supervising.html" title="Concurrent::Actor::Behaviour::Supervising (class)"><code>Actor::Behaviour::Supervising</code></a>:</p>

<p>&gt; Handles supervised actors. Handle configures what to do with failed child: :terminate!, :resume!, :reset!, or :restart!. Strategy sets <code>:one_for_one</code> (restarts just failed actor) or <code>:one_for_all</code> (restarts all child actors).</p>
</li><li>
<p><a href="Actor/Behaviour/Supervising.html" title="Concurrent::Actor::Behaviour::Supervising (class)"><code>Actor::Behaviour::Supervising</code></a>:</p>

<p>&gt; Handles supervised actors. Handle configures what to do with failed child: :terminate!, :resume!, :reset!, or :restart!. Strategy sets <code>:one_for_one</code> (restarts just failed actor) or <code>:one_for_all</code> (restarts all child actors).</p>
</li><li>
<p><a href="Actor/Behaviour/ExecutesContext.html" title="Concurrent::Actor::Behaviour::ExecutesContext (class)"><code>Actor::Behaviour::ExecutesContext</code></a>:</p>

<p>&gt; Delegates messages and events to <a href="Actor/AbstractContext.html" title="Concurrent::Actor::AbstractContext (class)"><code>AbstractContext</code></a> instance.</p>
</li><li>
<p><a href="Actor/Behaviour/ErrorsOnUnknownMessage.html" title="Concurrent::Actor::Behaviour::ErrorsOnUnknownMessage (class)"><code>Actor::Behaviour::ErrorsOnUnknownMessage</code></a>:</p>

<p>&gt; Simply fails when message arrives here. It’s usually the last behaviour.</p>
</li><li>
<p><a href="Actor/Behaviour/Termination.html" title="Concurrent::Actor::Behaviour::Termination (class)"><code>Actor::Behaviour::Termination</code></a>:</p>

<p>&gt; Handles actor termination. Waits until all its children are terminated, can be configured on behaviour initialization.</p>
</li><li>
<p><a href="Actor/Behaviour/RemovesChild.html" title="Concurrent::Actor::Behaviour::RemovesChild (class)"><code>Actor::Behaviour::RemovesChild</code></a>:</p>

<p>&gt; Removes terminated children.</p>
</li></ul>

<p>If needed new behaviours can be added, or old one removed to get required behaviour.</p>
<ul><li>
<p><a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a> uses <a href="Array.html" title="Concurrent::Array (class)"><code>Array</code></a> of behaviours and their construction parameters.</p>

<pre class="code ruby"><code class="ruby">[[<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/SetResults.html" title="Concurrent::Actor::Behaviour::SetResults (class)">SetResults</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_terminate!'>terminate!</span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/RemovesChild.html" title="Concurrent::Actor::Behaviour::RemovesChild (class)">RemovesChild</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Termination.html" title="Concurrent::Actor::Behaviour::Termination (class)">Termination</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Linking.html" title="Concurrent::Actor::Behaviour::Linking (class)">Linking</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Awaits.html" title="Concurrent::Actor::Behaviour::Awaits (class)">Awaits</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/ExecutesContext.html" title="Concurrent::Actor::Behaviour::ExecutesContext (class)">ExecutesContext</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/ErrorsOnUnknownMessage.html" title="Concurrent::Actor::Behaviour::ErrorsOnUnknownMessage (class)">ErrorsOnUnknownMessage</a></span>]]</code></pre>
</p>
</li><li>
<p><a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a> uses <a href="Array.html" title="Concurrent::Array (class)"><code>Array</code></a> of behaviours and their construction parameters.</p>

<pre class="code ruby"><code class="ruby">[[<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/SetResults.html" title="Concurrent::Actor::Behaviour::SetResults (class)">SetResults</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_pause!'>pause!</span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/RemovesChild.html" title="Concurrent::Actor::Behaviour::RemovesChild (class)">RemovesChild</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Termination.html" title="Concurrent::Actor::Behaviour::Termination (class)">Termination</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Linking.html" title="Concurrent::Actor::Behaviour::Linking (class)">Linking</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Pausing.html" title="Concurrent::Actor::Behaviour::Pausing (class)">Pausing</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Supervising.html" title="Concurrent::Actor::Behaviour::Supervising (class)">Supervising</a></span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_reset!'>reset!</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_one_for_one'>one_for_one</span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/Awaits.html" title="Concurrent::Actor::Behaviour::Awaits (class)">Awaits</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/ExecutesContext.html" title="Concurrent::Actor::Behaviour::ExecutesContext (class)">ExecutesContext</a></span>]<span class='comma'>,</span>
 [<span class='const'><a href="Actor/Behaviour.html" title="Concurrent::Actor::Behaviour (module)">Behaviour</a></span><span class='op'>::</span><span class='const'><a href="Actor/Behaviour/ErrorsOnUnknownMessage.html" title="Concurrent::Actor::Behaviour::ErrorsOnUnknownMessage (class)">ErrorsOnUnknownMessage</a></span>]]</code></pre>
</p>
</li></ul>
</p>

<h4>IO cooperation</h4>

<p>Actors are running on shared thread poll which allows user to create many actors cheaply.
Downside is that these actors cannot be directly used to do IO or other blocking operations.
Blocking operations could starve the <a href="../Concurrent.html#global_fast_executor-class_method" title="Concurrent.global_fast_executor (method)">global_fast_executor</a>. However there are two options:</p>

<ul>
<li>Create an regular actor which will schedule blocking operations in <a href="../Concurrent.html#global_io_executor-class_method" title="Concurrent.global_io_executor (method)">global_io_executor</a>
(which is intended for blocking operations) sending results back to self in messages.</li>
<li>Create an actor using <a href="../Concurrent.html#global_io_executor-class_method" title="Concurrent.global_io_executor (method)">global_io_executor</a> instead of <a href="../Concurrent.html#global_fast_executor-class_method" title="Concurrent.global_fast_executor (method)">global_fast_executor</a>, e.g.
<code>AnIOActor.spawn name: :blocking, executor: Concurrent.global_io_executor</code>.</li>
</ul>

<h5>Example</h5>

<p>require &#39;concurrent&#39;                               # =&gt; false</p>

<h3><a href="../Concurrent.html#use_simple_logger-class_method" title="Concurrent.use_simple_logger (method)">use_simple_logger</a>(:WARN, STDOUT)</h3>

<h3>First option is to use operation pool</h3>

<p>class ActorDoingIO &lt; <a href="Actor/RestartingContext.html" title="Concurrent::Actor::RestartingContext (class)"><code>RestartingContext</code></a>
  def on_message(message)
    # do IO operation
  end</p>

<p>def default_executor
    Concurrent.global_io_executor
  end
end </p>

<p>actor_doing_io = <code>ActorDoingIO.spawn</code> <code>:actor_doing_io</code>
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedc146e80 /actor_doing_io (ActorDoingIO)>
actor_doing_io.executor == <a href="../Concurrent.html#global_io_executor-class_method" title="Concurrent.global_io_executor (method)">global_io_executor</a>
    # =&gt; true</p>

<h3>It can be also built into a pool so there is not too many IO operations</h3>

<p>class IOWorker &lt; <a href="Actor/Context.html" title="Concurrent::Actor::Context (class)"><code>Context</code></a>
  def on_message(io_job)
    # do IO work
    sleep 0.1
    puts &quot;#<code>path</code> second:#<code>(Time.now.to_f*100).floor</code> message:#<code>io_job</code>&quot;
  end</p>

<p>def default_executor
    Concurrent.global_io_executor
  end
end </p>

<p>pool = <code>Concurrent::Actor::Utils::Pool.spawn</code>(&#39;pool&#39;, 2) do |index|
  IOWorker.spawn(name: &quot;worker-#<code>index</code>&quot;)
end
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedba83378 /pool (Concurrent::Actor::Utils::Pool)></p>

<p>pool &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3 &lt;&lt; 4 &lt;&lt; 5 &lt;&lt; 6
    # =&gt; #<Concurrent::Actor::Reference:0x7fbedba83378 /pool (Concurrent::Actor::Utils::Pool)></p>

<h3>prints two lines each second</h3>

<h3>/pool/worker-0 second:1414677666 message:1</h3>

<h3>/pool/worker-1 second:1414677666 message:2</h3>

<h3>/pool/worker-0 second:1414677667 message:3</h3>

<h3>/pool/worker-1 second:1414677667 message:4</h3>

<h3>/pool/worker-0 second:1414677668 message:5</h3>

<h3>/pool/worker-1 second:1414677668 message:6</h3>

<p>sleep 1                                            # =&gt; 1</p>

<h4>Dead letter routing</h4>

<p>see <a href="Actor/AbstractContext.html#dead_letter_routing-instance_method" title="Concurrent::Actor::AbstractContext#dead_letter_routing (method)">AbstractContext#dead_letter_routing</a> description:</p>

<blockquote>
<p>Defines an actor responsible for dead letters. Any rejected message send with <a href="Actor/Reference.html#tell-instance_method" title="Concurrent::Actor::Reference#tell (method)">Reference#tell</a> is sent there, a message with future is considered already monitored for failures. Default behaviour is to use <a href="Actor/AbstractContext.html#dead_letter_routing-instance_method" title="Concurrent::Actor::AbstractContext#dead_letter_routing (method)">AbstractContext#dead_letter_routing</a> of the parent, so if no <a href="Actor/AbstractContext.html#dead_letter_routing-instance_method" title="Concurrent::Actor::AbstractContext#dead_letter_routing (method)">AbstractContext#dead_letter_routing</a> method is overridden in parent-chain the message ends up in <code>Actor.root.dead_letter_routing</code> agent which will log warning.</p>
</blockquote>

<h4>FAQ</h4>

<h5>What happens if I try to supervise using a normal Context?</h5>

<p>Alleged supervisor will receive errors from its supervised actors. They&#39;ll have to be handled manually.</p>

<h5>How to change supervision strategy?</h5>

<p>Use option <code>behaviour_definition: {Behaviour.restarting_behaviour_definition}(:resume!)</code> or 
<code>behaviour_definition: {Behaviour.restarting_behaviour_definition}(:reset!, :one_for_all)</code></p>

<h5>How to change behaviors?</h5>

<p>Any existing behavior can be subclassed </p>

<h5>How to implement custom restarting?</h5>

<p>By subclassing <a href="Actor/Behaviour/Pausing.html" title="Concurrent::Actor::Behaviour::Pausing (class)"><code>Actor::Behaviour::Pausing</code></a> and overriding <a href="Actor/Behaviour/Pausing.html#restart!-instance_method" title="Concurrent::Actor::Behaviour::Pausing#restart! (method)">Behaviour::Pausing#restart!</a>. Implementing 
<a href="Actor/AbstractContext.html#on_event-instance_method" title="Concurrent::Actor::AbstractContext#on_event (method)">AbstractContext#on_event</a> could be also considered.</p>

<p><em>We&#39;ll be happy to answer any other questions, 
just <a href="https://github.com/ruby-concurrency/concurrent-ruby/issues/new" target="_parent" title="open an Issue">open an Issue</a> or find us on 
<a href="https://gitter.im/ruby-concurrency/concurrent-ruby">https://gitter.im/ruby-concurrency/concurrent-ruby</a>.</em></p>

<h4>Speed</h4>

<p>Simple benchmark Actor vs Celluloid, the numbers are looking good
but you know how it is with benchmarks. Source code is in
<code>examples/actor/celluloid_benchmark.rb</code>. It sends numbers between x actors
and adding 1 until certain limit is reached.</p>

<p>Benchmark legend:</p>

<ul>
<li>mes.  - number of messages send between the actors</li>
<li>act.  - number of actors exchanging the messages</li>
<li>impl. - which gem is used</li>
</ul>

<h5>JRUBY</h5>

<pre class="code ruby"><code class="ruby"><span class='const'>Rehearsal</span> <span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span>
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_concurrent'>concurrent</span>  <span class='float'>26.140000</span>   <span class='float'>0.610000</span>  <span class='float'>26.750000</span> (  <span class='float'>7.761000</span>)
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>41.440000</span>   <span class='float'>5.270000</span>  <span class='float'>46.710000</span> ( <span class='float'>17.535000</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>  <span class='float'>11.340000</span>   <span class='float'>0.180000</span>  <span class='float'>11.520000</span> (  <span class='float'>3.498000</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>19.310000</span>  <span class='float'>10.680000</span>  <span class='float'>29.990000</span> ( <span class='float'>14.619000</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_concurrent'>concurrent</span>  <span class='float'>10.640000</span>   <span class='float'>0.180000</span>  <span class='float'>10.820000</span> (  <span class='float'>3.563000</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>17.840000</span>  <span class='float'>19.850000</span>  <span class='float'>37.690000</span> ( <span class='float'>18.892000</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>  <span class='float'>14.120000</span>   <span class='float'>0.290000</span>  <span class='float'>14.410000</span> (  <span class='float'>4.618000</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>19.060000</span>  <span class='float'>28.920000</span>  <span class='float'>47.980000</span> ( <span class='float'>25.185000</span>)
<span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span> <span class='id identifier rubyid_total'>total</span><span class='op'>:</span> <span class='float'>225.870000</span><span class='id identifier rubyid_sec'>sec</span>

 <span class='id identifier rubyid_mes'>mes</span>. <span class='id identifier rubyid_act'>act</span>.      <span class='id identifier rubyid_impl'>impl</span>.       <span class='id identifier rubyid_user'>user</span>     <span class='id identifier rubyid_system'>system</span>      <span class='id identifier rubyid_total'>total</span>        <span class='id identifier rubyid_real'>real</span>
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>7.320000</span>   <span class='float'>0.530000</span>   <span class='float'>7.850000</span> (  <span class='float'>3.637000</span>)
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>13.780000</span>   <span class='float'>4.730000</span>  <span class='float'>18.510000</span> ( <span class='float'>10.756000</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>9.270000</span>   <span class='float'>0.140000</span>   <span class='float'>9.410000</span> (  <span class='float'>3.020000</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>16.540000</span>  <span class='float'>10.920000</span>  <span class='float'>27.460000</span> ( <span class='float'>14.308000</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>9.970000</span>   <span class='float'>0.160000</span>  <span class='float'>10.130000</span> (  <span class='float'>3.445000</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>15.930000</span>  <span class='float'>20.840000</span>  <span class='float'>36.770000</span> ( <span class='float'>18.272000</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>  <span class='float'>11.580000</span>   <span class='float'>0.240000</span>  <span class='float'>11.820000</span> (  <span class='float'>3.723000</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>19.440000</span>  <span class='float'>29.060000</span>  <span class='float'>48.500000</span> ( <span class='float'>25.227000</span>) (<span class='int'>1</span>)</code></pre>

<h5>MRI 2.1.0</h5>

<pre class="code ruby"><code class="ruby"><span class='const'>Rehearsal</span> <span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span>
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>4.180000</span>   <span class='float'>0.080000</span>   <span class='float'>4.260000</span> (  <span class='float'>4.269435</span>)
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_celluloid'>celluloid</span>    <span class='float'>7.740000</span>   <span class='float'>3.100000</span>  <span class='float'>10.840000</span> ( <span class='float'>10.043875</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>5.900000</span>   <span class='float'>1.310000</span>   <span class='float'>7.210000</span> (  <span class='float'>6.565067</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>12.820000</span>   <span class='float'>5.810000</span>  <span class='float'>18.630000</span> ( <span class='float'>17.320765</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>6.080000</span>   <span class='float'>1.640000</span>   <span class='float'>7.720000</span> (  <span class='float'>6.931294</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>17.130000</span>   <span class='float'>8.320000</span>  <span class='float'>25.450000</span> ( <span class='float'>23.786146</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>6.940000</span>   <span class='float'>2.030000</span>   <span class='float'>8.970000</span> (  <span class='float'>7.927330</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>20.980000</span>  <span class='float'>12.040000</span>  <span class='float'>33.020000</span> ( <span class='float'>30.849578</span>)
<span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span> <span class='id identifier rubyid_total'>total</span><span class='op'>:</span> <span class='float'>116.100000</span><span class='id identifier rubyid_sec'>sec</span>

 <span class='id identifier rubyid_mes'>mes</span>. <span class='id identifier rubyid_act'>act</span>.      <span class='id identifier rubyid_impl'>impl</span>.       <span class='id identifier rubyid_user'>user</span>     <span class='id identifier rubyid_system'>system</span>      <span class='id identifier rubyid_total'>total</span>        <span class='id identifier rubyid_real'>real</span>
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>3.730000</span>   <span class='float'>0.100000</span>   <span class='float'>3.830000</span> (  <span class='float'>3.822688</span>)
<span class='int'>50000</span>    <span class='int'>2</span> <span class='id identifier rubyid_celluloid'>celluloid</span>    <span class='float'>7.900000</span>   <span class='float'>2.910000</span>  <span class='float'>10.810000</span> (  <span class='float'>9.924014</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>5.420000</span>   <span class='float'>1.230000</span>   <span class='float'>6.650000</span> (  <span class='float'>6.025579</span>)
<span class='int'>50000</span>  <span class='int'>500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>12.720000</span>   <span class='float'>5.540000</span>  <span class='float'>18.260000</span> ( <span class='float'>16.889517</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>5.420000</span>   <span class='float'>0.910000</span>   <span class='float'>6.330000</span> (  <span class='float'>5.896689</span>)
<span class='int'>50000</span> <span class='int'>1000</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>16.090000</span>   <span class='float'>8.040000</span>  <span class='float'>24.130000</span> ( <span class='float'>22.347102</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_concurrent'>concurrent</span>   <span class='float'>5.580000</span>   <span class='float'>0.760000</span>   <span class='float'>6.340000</span> (  <span class='float'>6.038535</span>)
<span class='int'>50000</span> <span class='int'>1500</span> <span class='id identifier rubyid_celluloid'>celluloid</span>   <span class='float'>20.000000</span>  <span class='float'>11.680000</span>  <span class='float'>31.680000</span> ( <span class='float'>29.590774</span>) (<span class='int'>1</span>)</code></pre>

<p><em>Note (1):</em> Celluloid is using thread per actor so this bench is creating about 1500
native threads. Actor is using constant number of threads.</p>

  </div>
</div>
<div class='tags'>
  
</div>
</div>
<h2 id='t2_cnst' class='h2_sum'>Constant Summary</h2>
<div>
<ul class='constants summary full'>
  <li>
    <span id='Error-constant' class='summary_signature'>Error =</span>
    <br/>
    <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor/errors.rb#L5-L5'># File 'lib/concurrent-ruby-edge/concurrent/actor/errors.rb', line 5</a>    <pre class='code ruby'><span class='const'>Class</span>.<span class='id identifier rubyid_new'>new</span>(<span class='const'>StandardError</span>)</pre>
  </li>
</ul>
</div>

<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#current-class_method" title=".current (class method)">.<strong>current</strong>  &#x21d2; Reference<sup>?</sup> </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#root-class_method" title=".root (class method)">.<strong>root</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>A root actor, a default parent of all actors spawned outside an actor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#spawn-class_method" title=".spawn (class method)">.<strong>spawn</strong>(*args, &amp;block)  &#x21d2; Reference </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Spawns a new actor.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#spawn!-class_method" title=".spawn! (class method)">.<strong>spawn!</strong>(*args, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>as <a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">.spawn</a> but it’ll block until actor is initialized or it’ll raise exception on error.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_spawn_options-class_method" title="to_spawn_options (class method)">.<strong>to_spawn_options</strong>(context_class, name, *args)  </a>
    </span>
  </li>
</ul>
</div>  <!-- class_method_summary -->
<h2 class='y_details'>Class Method Details</h2>
<section class='method_details first' id="current-class_method">
  <h3 class='signature  first'>
    .<strong>current</strong>  &#x21d2; <a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)">Reference</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)">Reference</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>current executing actor if any</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L34-L36'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='34' data-end='36'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby-edge/concurrent/actor.rb', line 34</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_current'>current</span>
  <span class='const'>Thread</span>.<span class='id identifier rubyid_current'>current</span>[<span class='symbeg'>:</span><span class='id identifier rubyid___current_actor__'>__current_actor__</span>]
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="root-class_method">
  <h3 class='signature '>
    .<strong>root</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>A root actor, a default parent of all actors spawned outside an actor</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L49-L51'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='49' data-end='51'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby-edge/concurrent/actor.rb', line 49</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_root'><a href="../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span>
  <span class='ivar'>@root</span>.<span class='id identifier rubyid_value!'>value!</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="spawn-class_method">
  <h3 class='signature '>
    .<strong>spawn</strong>(*args, &amp;block)  &#x21d2; <a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)">Reference</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Spawns a new actor. <a href="Actor/AbstractContext.html#spawn-class_method" title="Concurrent::Actor::AbstractContext.spawn (method)">AbstractContext.spawn</a> allows to omit class parameter. To see the list of available options see <code>Core#initialize</code></p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
        <p class='example_title'><div class='inline'>
<p>by class and name</p>
</div></p>
      <pre class='example code ruby'><code><span class='const'>Actor</span>.<span class='id identifier rubyid_spawn'>spawn</span>(<span class='const'>AdHoc</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_ping1'>ping1</span>) { <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_message'>message</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_message'>message</span> } }</code></pre>
        <p class='example_title'><div class='inline'>
<p>by option hash</p>
</div></p>
      <pre class='example code ruby'><code><span class='id identifier rubyid_inc2'>inc2</span> <span class='op'>=</span> <span class='const'>Actor</span>.<span class='id identifier rubyid_spawn'>spawn</span>(<span class='label'>class:</span>    <span class='const'>AdHoc</span><span class='comma'>,</span>
                   <span class='label'>name:</span>     <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>increment by 2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                   <span class='label'>args:</span>     [<span class='int'>2</span>]<span class='comma'>,</span>
                   <span class='label'>executor:</span> <span class='const'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span>.<span class='id identifier rubyid_global_io_executor'><a href="../Concurrent.html#global_io_executor-class_method" title="Concurrent.global_io_executor (method)">global_io_executor</a></span>) <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_increment_by'>increment_by</span><span class='op'>|</span>
  <span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_number'>number</span><span class='op'>|</span> <span class='id identifier rubyid_number'>number</span> <span class='op'>+</span> <span class='id identifier rubyid_increment_by'>increment_by</span> }
<span class='kw'>end</span>
<span class='id identifier rubyid_inc2'>inc2</span>.<span class='id identifier rubyid_ask!'>ask!</span>(<span class='int'>2</span>) <span class='comment'># =&gt; 4</span></code></pre>
  </div>
<p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>block</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>for context_class instantiation</p>
</div>
  </li>
  <li>
    <span class='name'>args</span>
    <span class='type'></span>
&mdash;    <div class='inline'>
<p>see <a href="#to_spawn_options-class_method" title="Concurrent::Actor.to_spawn_options (method)">.to_spawn_options</a></p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="Actor/Reference.html" title="Concurrent::Actor::Reference (class)">Reference</a>)</span>
&mdash;    <div class='inline'>
<p>never the actual actor</p>
</div>
  </li>
</ul>
  <p class='tag_title'>See Also:</p>
  <ul class='see'>
      <li><a href="Actor/AbstractContext.html#spawn-class_method" title="Concurrent::Actor::AbstractContext.spawn (method)">AbstractContext.spawn</a></li>
          <li><code>Core#initialize</code></li>
      </ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L72-L82'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='72' data-end='82'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby-edge/concurrent/actor.rb', line 72</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_spawn'>spawn</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_to_spawn_options'><a href="#to_spawn_options-class_method" title="Concurrent::Actor.to_spawn_options (method)">to_spawn_options</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_executor'><a href="../Concurrent.html#executor-class_method" title="Concurrent.executor (method)">executor</a></span>] <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_executor'><a href="../Concurrent.html#executor-class_method" title="Concurrent.executor (method)">executor</a></span>].<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='const'><a href="ImmediateExecutor.html" title="Concurrent::ImmediateExecutor (class)">ImmediateExecutor</a></span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ImmediateExecutor is not supported</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='const'>Actor</span>.<span class='id identifier rubyid_current'><a href="#current-class_method" title="Concurrent::Actor.current (method)">current</a></span>
    <span class='const'><a href="Actor/Core.html" title="Concurrent::Actor::Core (class)">Core</a></span>.<span class='id identifier rubyid_new'><a href="Actor/Core.html#new-class_method" title="Concurrent::Actor::Core.new (method)">new</a></span>(<span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>parent:</span> <span class='const'>Actor</span>.<span class='id identifier rubyid_current'><a href="#current-class_method" title="Concurrent::Actor.current (method)">current</a></span>)<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>).<span class='id identifier rubyid_reference'><a href="Actor/Core.html#reference-instance_method" title="Concurrent::Actor::Core#reference (method)">reference</a></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_root'><a href="../top-level-namespace.html" title="Top Level Namespace (root)">root</a></span>.<span class='id identifier rubyid_ask'>ask</span>([<span class='symbeg'>:</span><span class='id identifier rubyid_spawn'>spawn</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span>]).<span class='id identifier rubyid_value!'>value!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="spawn!-class_method">
  <h3 class='signature '>
    .<strong>spawn!</strong>(*args, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>as <a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">.spawn</a> but it’ll block until actor is initialized or it’ll raise exception on error</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L85-L87'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='85' data-end='87'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby-edge/concurrent/actor.rb', line 85</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_spawn!'>spawn!</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_spawn'><a href="#spawn-class_method" title="Concurrent::Actor.spawn (method)">spawn</a></span>(<span class='id identifier rubyid_to_spawn_options'><a href="#to_spawn_options-class_method" title="Concurrent::Actor.to_spawn_options (method)">to_spawn_options</a></span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>).<span class='id identifier rubyid_merge'>merge</span>(<span class='label'>initialized:</span> <span class='id identifier rubyid_future'>future</span> <span class='op'>=</span> <span class='const'><a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'><a href="Promises.html" title="Concurrent::Promises (module)">Promises</a></span>.<span class='id identifier rubyid_resolvable_future'><a href="Promises/FactoryMethods.html#resolvable_future-instance_method" title="Concurrent::Promises::FactoryMethods#resolvable_future (method)">resolvable_future</a></span>)<span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>).<span class='id identifier rubyid_tap'>tap</span> { <span class='id identifier rubyid_future'>future</span>.<span class='id identifier rubyid_wait!'>wait!</span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_spawn_options-class_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>.<strong>to_spawn_options</strong>(context_class, name, *args)  </span>
      <span class='overload'>.<strong>to_spawn_options</strong>(opts)  </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby-edge/concurrent/actor.rb#L96-L104'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='96' data-end='104'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby-edge/concurrent/actor.rb', line 96</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_to_spawn_options'>to_spawn_options</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_is_a?'>is_a?</span>(<span class='op'>::</span><span class='const'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span>)
    <span class='id identifier rubyid_args'>args</span>.<span class='id identifier rubyid_first'>first</span>
  <span class='kw'>else</span>
    { <span class='label'>class:</span> <span class='id identifier rubyid_args'>args</span>[<span class='int'>0</span>]<span class='comma'>,</span>
      <span class='label'>name:</span>  <span class='id identifier rubyid_args'>args</span>[<span class='int'>1</span>]<span class='comma'>,</span>
      <span class='label'>args:</span>  <span class='id identifier rubyid_args'>args</span>[<span class='int'>2</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span>] }
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>