<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Concurrent::Map &mdash; Concurrent Ruby master</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Concurrent::Map",
    relpath = '../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../'>Concurrent</a> &raquo; 
      <a href='../_index.html#alpha_M'>Index (M)</a> &raquo; 
        <a href="../Concurrent.html" title="Concurrent (module)">Concurrent</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Map&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Concurrent::Map</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2 o'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Collection.html#MapImplementation-constant" title="Concurrent::Collection::MapImplementation (constant)">Concurrent::Collection::MapImplementation</a></span>
        <ul class='fullTree'>
          <li><a href="../Object.html" title="Object (class)"><code>::Object</code></a></li>
          <li class='next'>Concurrent::Map</li>
        </ul>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L39'>lib/concurrent-ruby/concurrent/map.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p><code>Map</code> is a hash-like object and should have much better performance characteristics, especially under high concurrency, than <a href="Hash.html" title="Concurrent::Hash (class)"><code>Hash</code></a>. However, ‘Concurrent::Map `is not strictly semantically equivalent to a ruby <a href="Hash.html" title="Concurrent::Hash (class)"><code>Hash</code></a> – for instance, it does not necessarily retain ordering by insertion time as <a href="Hash.html" title="Concurrent::Hash (class)"><code>Hash</code></a> does. For most uses it should do fine though, and we recommend you consider <code>Map</code> instead of <a href="Hash.html" title="Concurrent::Hash (class)"><code>Hash</code></a> for your concurrency-safe hash needs.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title=".new (class method)">.<strong>new</strong>(options = nil, &amp;default_proc)  &#x21d2; Map </a>
    </span>
    <span class='note title constructor'>constructor</span>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">#<strong>empty?</strong>  &#x21d2; true, false </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Is map empty?</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(key)  &#x21d2; Object </a>
      (also: #get)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a value with key.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#[]=-instance_method" title="#[]= (instance method)">#<strong>[]=</strong>(key, value)  &#x21d2; Object </a>
      (also: #put)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p><a href="Set.html" title="Concurrent::Set (class)"><code>Set</code></a> a value with key.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#compute-instance_method" title="#compute (instance method)">#<strong>compute</strong>(key) {|old_value| ... } &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Compute and store new value for key.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#compute_if_absent-instance_method" title="#compute_if_absent (instance method)">#<strong>compute_if_absent</strong>(key) { ... } &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Compute and store new value for key if the key is absent.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#compute_if_present-instance_method" title="#compute_if_present (instance method)">#<strong>compute_if_present</strong>(key) {|old_value| ... } &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Compute and store new value for key if the key is present.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>(key)  &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Delete key and its value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#delete_pair-instance_method" title="#delete_pair (instance method)">#<strong>delete_pair</strong>(key, value)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Delete pair and its value if current value equals the provided value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each-instance_method" title="#each (instance method)">#<strong>each</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">#each_pair</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each_key-instance_method" title="#each_key (instance method)">#<strong>each_key</strong> {|key| ... } &#x21d2; self </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Iterates over each key.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each_pair-instance_method" title="#each_pair (instance method)">#<strong>each_pair</strong> {|key, value| ... } &#x21d2; self </a>
      (also: #each, #each)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Iterates over each key value pair.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#each_value-instance_method" title="#each_value (instance method)">#<strong>each_value</strong> {|value| ... } &#x21d2; self </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Iterates over each value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#fetch-instance_method" title="#fetch (instance method)">#<strong>fetch</strong>(key, default_value = NULL) {|key| ... } &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get a value with key, or default_value when key is absent, or fail when no default_value is given.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#fetch_or_store-instance_method" title="#fetch_or_store (instance method)">#<strong>fetch_or_store</strong>(key, default_value = NULL) {|key| ... } &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Fetch value with key, or store default value when key is absent, or fail when no default_value is given.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get-instance_method" title="#get (instance method)">#<strong>get</strong>(key)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]-instance_method" title="Concurrent::Map#[] (method)">#[]</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#get_and_set-instance_method" title="#get_and_set (instance method)">#<strong>get_and_set</strong>(key, value)  &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Get the current value under key and set new value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#key-instance_method" title="#key (instance method)">#<strong>key</strong>(value)  &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Find key of a value.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#keys-instance_method" title="#keys (instance method)">#<strong>keys</strong>  &#x21d2; ::Array&lt;Object&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>All keys.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#merge_pair-instance_method" title="#merge_pair (instance method)">#<strong>merge_pair</strong>(key, value) {|old_value| ... } &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>If the key is absent, the value is stored, otherwise new value is computed with a block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#put-instance_method" title="#put (instance method)">#<strong>put</strong>(key, value)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]=-instance_method" title="Concurrent::Map#[]= (method)">#[]=</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#put_if_absent-instance_method" title="#put_if_absent (instance method)">#<strong>put_if_absent</strong>(key, value)  &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Insert value into map with key if key is absent in one atomic step.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#replace_if_exists-instance_method" title="#replace_if_exists (instance method)">#<strong>replace_if_exists</strong>(key, new_value)  &#x21d2; Object<sup>?</sup> </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Replaces current value with new_value if key exists This method is atomic.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#replace_pair-instance_method" title="#replace_pair (instance method)">#<strong>replace_pair</strong>(key, old_value, new_value)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Replaces old_value with new_value if key exists and current value matches old_value This method is atomic.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#size-instance_method" title="#size (instance method)">#<strong>size</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>The size of map.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#value%3F-instance_method" title="#value? (instance method)">#<strong>value?</strong>(value)  &#x21d2; true, false </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Is the value stored in the map.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#values-instance_method" title="#values (instance method)">#<strong>values</strong>  &#x21d2; ::Array&lt;Object&gt; </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>All values.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#initialize_copy-instance_method" title="#initialize_copy (instance method)">#<strong>initialize_copy</strong>(other)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#marshal_dump-instance_method" title="#marshal_dump (instance method)">#<strong>marshal_dump</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#marshal_load-instance_method" title="#marshal_load (instance method)">#<strong>marshal_load</strong>(hash)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#populate_from-instance_method" title="#populate_from (instance method)">#<strong>populate_from</strong>(hash)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#raise_fetch_no_key-instance_method" title="#raise_fetch_no_key (instance method)">#<strong>raise_fetch_no_key</strong>  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
  <li>
    <span class='summary_signature priv'>
      <a href="#validate_options_hash!-instance_method" title="#validate_options_hash! (instance method)">#<strong>validate_options_hash!</strong>(options)  </a>
    </span>
    <span class='note title private'>private</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong>(options = nil, &amp;default_proc)  &#x21d2; <code>Map</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>options</span>
    <span class='type'>(<a href="Hash.html" title="Concurrent::Hash (class)">Hash</a>, <code>nil</code>)</span>
    <em class='default'>(defaults to: <tt>nil</tt>)</em>
&mdash;    <div class='inline'>
<p>options to set the <code>:initial_capacity</code> or <code>:load_factor</code>. Ignored on some Rubies.</p>
</div>
  </li>
  <li>
    <span class='name'>default_proc</span>
    <span class='type'>(<code>Proc</code>)</span>
&mdash;    <div class='inline'>
<p>Optional block to compute the default value if the key is not set, like <code>Hash#default_proc</code></p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L133-L142'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='133' data-end='142'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 133</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../Concurrent.html#initialize-instance_method" title="Concurrent#initialize (method)">initialize</a></span>(<span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_default_proc'>default_proc</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='op'>::</span><span class='const'><a href="Hash.html" title="Concurrent::Hash (class)">Hash</a></span>)
    <span class='id identifier rubyid_validate_options_hash!'><a href="#validate_options_hash!-instance_method" title="Concurrent::Map#validate_options_hash! (method)">validate_options_hash!</a></span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>

  <span class='kw'>super</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='ivar'>@default_proc</span> <span class='op'>=</span> <span class='id identifier rubyid_default_proc'>default_proc</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="empty?-instance_method">
  <h3 class='signature ro first'>
    #<strong>empty?</strong>  &#x21d2; <code>true</code>, <code>false</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is map empty?</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L291-L294'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='291' data-end='294'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 291</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='kw'>return</span> <span class='kw'>false</span> }
  <span class='kw'>true</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="[]-instance_method">
  <h3 class='signature  first'>
    #<strong>[]</strong>(key)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> 
    <span class='aliases'>Also known as: <span class='names'>#get</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get a value with key</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>the value</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L147-L159'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='147' data-end='159'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 147</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='op'>[]</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>super</span> <span class='comment'># non-falsy value is an existing mapping, return it right away
</span>    <span class='id identifier rubyid_value'>value</span>
    <span class='comment'># re-check is done with get_or_default(key, NULL) instead of a simple !key?(key) in order to avoid a race condition, whereby by the time the current thread gets to the key?(key) call
</span>    <span class='comment'># a key =&gt; value mapping might have already been created by a different thread (key?(key) would then return true, this elsif branch wouldn&#39;t be taken and an incorrect nil value
</span>    <span class='comment'># would be returned)
</span>    <span class='comment'># note: nil == value check is not technically necessary
</span>  <span class='kw'>elsif</span> <span class='ivar'>@default_proc</span> <span class='op'>&amp;&amp;</span> <span class='kw'>nil</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>&amp;&amp;</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span> <span class='op'>==</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_get_or_default'>get_or_default</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span>))
    <span class='ivar'>@default_proc</span>.<span class='id identifier rubyid_call'>call</span>(<span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>)
  <span class='kw'>else</span>
    <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="[]=-instance_method">
  <h3 class='signature '>
    #<strong>[]=</strong>(key, value)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> 
    <span class='aliases'>Also known as: <span class='names'>#put</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p><a href="Set.html" title="Concurrent::Set (class)"><code>Set</code></a> a value with key</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>the new value</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L49-L49'>GitHub</a> ]</span>

</section>

<section class='method_details' id="compute-instance_method">
  <h3 class='signature '>
    #<strong>compute</strong>(key) {|old_value| ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Compute and store new value for key. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>compute new value from old one</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>old_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>old_value, or nil when key is absent</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value, when nil the key is removed</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value or nil</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L72-L72'>GitHub</a> ]</span>

</section>

<section class='method_details' id="compute_if_absent-instance_method">
  <h3 class='signature '>
    #<strong>compute_if_absent</strong>(key) { ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Compute and store new value for key if the key is absent. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>new value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>new value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>new value or current value</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L55-L55'>GitHub</a> ]</span>

</section>

<section class='method_details' id="compute_if_present-instance_method">
  <h3 class='signature '>
    #<strong>compute_if_present</strong>(key) {|old_value| ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Compute and store new value for key if the key is present. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>new value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>old_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value, when nil the key is removed</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value or nil</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L63-L63'>GitHub</a> ]</span>

</section>

<section class='method_details' id="delete-instance_method">
  <h3 class='signature '>
    #<strong>delete</strong>(key)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Delete key and its value. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>old value or nil when the key was absent</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L115-L115'>GitHub</a> ]</span>

</section>

<section class='method_details' id="delete_pair-instance_method">
  <h3 class='signature '>
    #<strong>delete_pair</strong>(key, value)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Delete pair and its value if current value equals the provided value. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>true if deleted</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L121-L121'>GitHub</a> ]</span>

</section>

<section class='method_details' id="each-instance_method">
  <h3 class='signature '>
    #<strong>each</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">#each_pair</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L279-L279'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='279' data-end='279'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 279</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_each'>each</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> <span class='kw'>unless</span> <span class='id identifier rubyid_method_defined?'>method_defined?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_each'>each</span>)
</pre>
  </div>
</div>
</section>

<section class='method_details' id="each_key-instance_method">
  <h3 class='signature '>
    #<strong>each_key</strong> {|key| ... } &#x21d2; <code>self</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Iterates over each key. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>for each key in the map</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L255-L257'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='255' data-end='257'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 255</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_each_key'>each_key</span>
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='kw'>yield</span> <span class='id identifier rubyid_k'>k</span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="each_pair-instance_method">
  <h3 class='signature '>
    #<strong>each_pair</strong> {|key, value| ... } &#x21d2; <code>self</code> 
    <span class='aliases'>Also known as: <span class='names'>#each, #each</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Iterates over each key value pair. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>for each key value pair in the map</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L274-L277'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='274' data-end='277'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 274</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_each_pair'>each_pair</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_enum_for'>enum_for</span> <span class='symbeg'>:</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>super</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="each_value-instance_method">
  <h3 class='signature '>
    #<strong>each_value</strong> {|value| ... } &#x21d2; <code>self</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>Iterates over each value. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>for each value in the map</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L264-L266'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='264' data-end='266'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 264</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_each_value'>each_value</span>
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='kw'>yield</span> <span class='id identifier rubyid_v'>v</span> }
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fetch-instance_method">
  <h3 class='signature '>
    #<strong>fetch</strong>(key, default_value = NULL) {|key| ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>The “fetch-then-act” methods of <code>Map</code> are not atomic. <code>Map</code> is intended to be use as a concurrency primitive with strong happens-before guarantees. It is not intended to be used as a high-level abstraction supporting complex operations. All read and write operations are thread safe, but no guarantees are made regarding race conditions between the fetch operation and yielding to the block. Additionally, this method does not support recursion. This is due to internal constraints that are very unlikely to change in the near future.</p>
</div>
  </div>


<p>Get a value with key, or default_value when key is absent, or fail when no default_value is given.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>default_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
    <em class='default'>(defaults to: <tt>NULL</tt>)</em>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>default value for a key</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>default value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>the value or default value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>KeyError</code>)</span>
&mdash;    <div class='inline'>
<p>when key is missing and no default_value is provided</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L183-L193'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='183' data-end='193'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 183</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_fetch'>fetch</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='id identifier rubyid_default_value'>default_value</span> <span class='op'>=</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span>)
  <span class='kw'>if</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span> <span class='op'>!=</span> (<span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_get_or_default'>get_or_default</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span>))
    <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='kw'>yield</span> <span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>
  <span class='kw'>elsif</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span> <span class='op'>!=</span> <span class='id identifier rubyid_default_value'>default_value</span>
    <span class='id identifier rubyid_default_value'>default_value</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise_fetch_no_key'><a href="#raise_fetch_no_key-instance_method" title="Concurrent::Map#raise_fetch_no_key (method)">raise_fetch_no_key</a></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="fetch_or_store-instance_method">
  <h3 class='signature '>
    #<strong>fetch_or_store</strong>(key, default_value = NULL) {|key| ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Fetch value with key, or store default value when key is absent, or fail when no default_value is given. This is a two step operation, therefore not atomic. The store can overwrite other concurrently stored value.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>default_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
    <em class='default'>(defaults to: <tt>NULL</tt>)</em>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>default value for a key</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>default value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>the value or default value</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L205-L209'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='205' data-end='209'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 205</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_fetch_or_store'>fetch_or_store</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='id identifier rubyid_default_value'>default_value</span> <span class='op'>=</span> <span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span>)
  <span class='id identifier rubyid_fetch'><a href="#fetch-instance_method" title="Concurrent::Map#fetch (method)">fetch</a></span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_put'><a href="#put-instance_method" title="Concurrent::Map#put (method)">put</a></span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>) <span class='op'>:</span> (<span class='const'><a href="../Concurrent.html#NULL-constant" title="Concurrent::NULL (constant)">NULL</a></span> <span class='op'>==</span> <span class='id identifier rubyid_default_value'>default_value</span> <span class='op'>?</span> <span class='id identifier rubyid_raise_fetch_no_key'><a href="#raise_fetch_no_key-instance_method" title="Concurrent::Map#raise_fetch_no_key (method)">raise_fetch_no_key</a></span> <span class='op'>:</span> <span class='id identifier rubyid_default_value'>default_value</span>))
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get-instance_method">
  <h3 class='signature '>
    #<strong>get</strong>(key)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]-instance_method" title="Concurrent::Map#[] (method)">#[]</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L162-L162'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='162' data-end='162'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 162</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>[]</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="get_and_set-instance_method">
  <h3 class='signature '>
    #<strong>get_and_set</strong>(key, value)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Get the current value under key and set new value. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>old value or nil when the key was absent</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L108-L108'>GitHub</a> ]</span>

</section>

<section class='method_details' id="initialize_copy-instance_method">
  <h3 class='signature priv'>
    #<strong>initialize_copy</strong>(other)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L331-L334'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='331' data-end='334'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 331</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize_copy'>initialize_copy</span>(<span class='id identifier rubyid_other'>other</span>)
  <span class='kw'>super</span>
  <span class='id identifier rubyid_populate_from'><a href="#populate_from-instance_method" title="Concurrent::Map#populate_from (method)">populate_from</a></span>(<span class='id identifier rubyid_other'>other</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature priv'>
    #<strong>inspect</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L321-L323'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='321' data-end='323'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 321</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_format'>format</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%s entries=%d default_proc=%s&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_to_s'>to_s</span>[<span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span>]<span class='comma'>,</span> <span class='id identifier rubyid_size'><a href="#size-instance_method" title="Concurrent::Map#size (method)">size</a></span>.<span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='ivar'>@default_proc</span>.<span class='id identifier rubyid_inspect'>inspect</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="key-instance_method">
  <h3 class='signature '>
    #<strong>key</strong>(value)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Find key of a value.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>key or nil when not found</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L284-L287'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='284' data-end='287'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 284</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_key'>key</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='kw'>return</span> <span class='id identifier rubyid_k'>k</span> <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='id identifier rubyid_value'>value</span> }
  <span class='kw'>nil</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="keys-instance_method">
  <h3 class='signature '>
    #<strong>keys</strong>  &#x21d2; <code>::Array</code>&lt;<a href="../Object.html" title="Object (class)">Object</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>All keys</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>::Array</code>&lt;<a href="../Object.html" title="Object (class)">Object</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>keys</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L236-L240'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='236' data-end='240'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 236</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_arr'>arr</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_arr'>arr</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_k'>k</span> }
  <span class='id identifier rubyid_arr'>arr</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_dump-instance_method">
  <h3 class='signature priv'>
    #<strong>marshal_dump</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>TypeError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L305-L310'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='305' data-end='310'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 305</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_marshal_dump'>marshal_dump</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>TypeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>can&#39;t dump hash with default proc</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@default_proc</span>
  <span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> {}
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span> }
  <span class='id identifier rubyid_h'>h</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="marshal_load-instance_method">
  <h3 class='signature priv'>
    #<strong>marshal_load</strong>(hash)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L313-L316'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='313' data-end='316'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 313</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_marshal_load'>marshal_load</span>(<span class='id identifier rubyid_hash'>hash</span>)
  <span class='id identifier rubyid_initialize'><a href="../Concurrent.html#initialize-instance_method" title="Concurrent#initialize (method)">initialize</a></span>
  <span class='id identifier rubyid_populate_from'><a href="#populate_from-instance_method" title="Concurrent::Map#populate_from (method)">populate_from</a></span>(<span class='id identifier rubyid_hash'>hash</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="merge_pair-instance_method">
  <h3 class='signature '>
    #<strong>merge_pair</strong>(key, value) {|old_value| ... } &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>Atomic methods taking a block do not allow the <code>self</code> instance to be used within the block. Doing so will cause a deadlock.</p>
</div>
  </div>


<p>If the key is absent, the value is stored, otherwise new value is computed with a block. This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Yields:</p>
<ul class='yield'>
  <li>
    <span class='type'></span>
    <div class='inline'>
<p>compute new value from old one</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Parameters:</p>
<ul class='yieldparam'>
  <li>
    <span class='name'>old_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
&mdash;    <div class='inline'>
<p>old value</p>
</div>
  </li>
</ul>
<p class='tag_title'>Yield Returns:</p>
<ul class='yieldreturn'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value, when nil the key is removed</p>
</div>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>new value or nil</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L81-L81'>GitHub</a> ]</span>

</section>

<section class='method_details' id="populate_from-instance_method">
  <h3 class='signature priv'>
    #<strong>populate_from</strong>(hash)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L336-L339'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='336' data-end='339'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 336</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_populate_from'>populate_from</span>(<span class='id identifier rubyid_hash'>hash</span>)
  <span class='id identifier rubyid_hash'>hash</span>.<span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='kw'>self</span>[<span class='id identifier rubyid_k'>k</span>] <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span> }
  <span class='kw'>self</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="put-instance_method">
  <h3 class='signature '>
    #<strong>put</strong>(key, value)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]=-instance_method" title="Concurrent::Map#[]= (method)">#[]=</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L163-L163'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='163' data-end='163'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 163</span></pre>
<pre class='code ruby'>

<span class='id identifier rubyid_alias_method'>alias_method</span> <span class='symbeg'>:</span><span class='id identifier rubyid_put'>put</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='op'>[]=</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="put_if_absent-instance_method">
  <h3 class='signature '>
    #<strong>put_if_absent</strong>(key, value)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Insert value into map with key if key is absent in one atomic step.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>the previous value when key was present or nil when there was no key</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L215-L222'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='215' data-end='222'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 215</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_put_if_absent'>put_if_absent</span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_computed'>computed</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_result'>result</span>   <span class='op'>=</span> <span class='id identifier rubyid_compute_if_absent'><a href="#compute_if_absent-instance_method" title="Concurrent::Map#compute_if_absent (method)">compute_if_absent</a></span>(<span class='id identifier rubyid_key'><a href="#key-instance_method" title="Concurrent::Map#key (method)">key</a></span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_computed'>computed</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_computed'>computed</span> <span class='op'>?</span> <span class='kw'>nil</span> <span class='op'>:</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="raise_fetch_no_key-instance_method">
  <h3 class='signature priv'>
    #<strong>raise_fetch_no_key</strong>   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Raises:</p>
<ul class='raise'>
  <li>
    <span class='type'>(<code>KeyError</code>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L327-L329'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='327' data-end='329'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 327</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_raise_fetch_no_key'>raise_fetch_no_key</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>KeyError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>key not found</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="replace_if_exists-instance_method">
  <h3 class='signature '>
    #<strong>replace_if_exists</strong>(key, new_value)  &#x21d2; <a href="../Object.html" title="Object (class)">Object</a><sup>?</sup> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Replaces current value with new_value if key exists This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>new_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>, <code>nil</code>)</span>
&mdash;    <div class='inline'>
<p>old value or nil</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L101-L101'>GitHub</a> ]</span>

</section>

<section class='method_details' id="replace_pair-instance_method">
  <h3 class='signature '>
    #<strong>replace_pair</strong>(key, old_value, new_value)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Replaces old_value with new_value if key exists and current value matches old_value This method is atomic.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>key</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>old_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
  <li>
    <span class='name'>new_value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>
<p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>true</code>, <code>false</code>)</span>
&mdash;    <div class='inline'>
<p>true if replaced</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[ <a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L92-L92'>GitHub</a> ]</span>

</section>

<section class='method_details' id="size-instance_method">
  <h3 class='signature '>
    #<strong>size</strong>  &#x21d2; <code>Integer</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>The size of map.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>Integer</code>)</span>
&mdash;    <div class='inline'>
<p>size</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L298-L302'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='298' data-end='302'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 298</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_count'>count</span> <span class='op'>+=</span> <span class='int'>1</span> }
  <span class='id identifier rubyid_count'>count</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="validate_options_hash!-instance_method">
  <h3 class='signature priv'>
    #<strong>validate_options_hash!</strong>(options)   <span class="extras">(<span class='priv'>private</span>)</span>
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L341-L348'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='341' data-end='348'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 341</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_validate_options_hash!'>validate_options_hash!</span>(<span class='id identifier rubyid_options'>options</span>)
  <span class='kw'>if</span> (<span class='id identifier rubyid_initial_capacity'>initial_capacity</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_initial_capacity'>initial_capacity</span>]) <span class='op'>&amp;&amp;</span> (<span class='op'>!</span><span class='id identifier rubyid_initial_capacity'>initial_capacity</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Integer</span>) <span class='op'>||</span> <span class='id identifier rubyid_initial_capacity'>initial_capacity</span> <span class='op'>&lt;</span> <span class='int'>0</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:initial_capacity must be a positive Integer</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> (<span class='id identifier rubyid_load_factor'>load_factor</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_load_factor'>load_factor</span>]) <span class='op'>&amp;&amp;</span> (<span class='op'>!</span><span class='id identifier rubyid_load_factor'>load_factor</span>.<span class='id identifier rubyid_kind_of?'>kind_of?</span>(<span class='const'>Numeric</span>) <span class='op'>||</span> <span class='id identifier rubyid_load_factor'>load_factor</span> <span class='op'>&lt;=</span> <span class='int'>0</span> <span class='op'>||</span> <span class='id identifier rubyid_load_factor'>load_factor</span> <span class='op'>&gt;</span> <span class='int'>1</span>)
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:load_factor must be a number between 0 and 1</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="value?-instance_method">
  <h3 class='signature '>
    #<strong>value?</strong>(value)  &#x21d2; <code>true</code>, <code>false</code> 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Is the value stored in the map. Iterates over all values.</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Parameters:</p>
<ul class='param'>
  <li>
    <span class='name'>value</span>
    <span class='type'>(<a href="../Object.html" title="Object (class)">Object</a>)</span>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L227-L232'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='227' data-end='232'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 227</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_value?'>value?</span>(<span class='id identifier rubyid_value'>value</span>)
  <span class='id identifier rubyid_each_value'><a href="#each_value-instance_method" title="Concurrent::Map#each_value (method)">each_value</a></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span>.<span class='id identifier rubyid_equal?'>equal?</span>(<span class='id identifier rubyid_v'>v</span>)
  <span class='kw'>end</span>
  <span class='kw'>false</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="values-instance_method">
  <h3 class='signature '>
    #<strong>values</strong>  &#x21d2; <code>::Array</code>&lt;<a href="../Object.html" title="Object (class)">Object</a>&gt; 
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>All values</p>

  </div>
</div>
<div class='tags'>
  <p class='tag_title'>Returns:</p>
<ul class='return'>
  <li>
    <span class='type'>(<code>::Array</code>&lt;<a href="../Object.html" title="Object (class)">Object</a>&gt;)</span>
&mdash;    <div class='inline'>
<p>values</p>
</div>
  </li>
</ul>

</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/map.rb#L244-L248'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='244' data-end='248'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/map.rb', line 244</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
  <span class='id identifier rubyid_arr'>arr</span> <span class='op'>=</span> []
  <span class='id identifier rubyid_each_pair'><a href="#each_pair-instance_method" title="Concurrent::Map#each_pair (method)">each_pair</a></span> { <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_arr'>arr</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span> }
  <span class='id identifier rubyid_arr'>arr</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>