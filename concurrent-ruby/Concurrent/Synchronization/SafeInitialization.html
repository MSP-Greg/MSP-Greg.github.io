<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: Concurrent::Synchronization::SafeInitialization &mdash; Concurrent Ruby master</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Concurrent::Synchronization::SafeInitialization",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Concurrent</a> &raquo; 
      <a href='../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../Concurrent.html" title="Concurrent (module)">Concurrent</a> &raquo; 
        <a href="../Synchronization.html" title="Concurrent::Synchronization (module)">Synchronization</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>SafeInitialization&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: Concurrent::Synchronization::SafeInitialization</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Extended In:</div>
      <div class='box_11'>
        <a href="../MutexAtomicBoolean.html" title="Concurrent::MutexAtomicBoolean (class)"><code>MutexAtomicBoolean</code></a>,
          <a href="../MutexAtomicFixnum.html" title="Concurrent::MutexAtomicFixnum (class)"><code>MutexAtomicFixnum</code></a>,
          <a href="../MutexAtomicReference.html" title="Concurrent::MutexAtomicReference (class)"><code>MutexAtomicReference</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/synchronization/safe_initialization.rb#L28'>lib/concurrent-ruby/concurrent/synchronization/safe_initialization.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>**Private Implementation:** This abstraction is a private, internal implementation detail. It should never be used directly.</p>
</div>
  </div>


<p>By extending this module, a class and all its children are marked to be constructed safely. Meaning that all writes (ivar initializations) are made visible to all readers of newly constructed object. It ensures same behaviour as Java’s final fields.</p>

<p>Due to using <code>Object#extend</code>, the module is not included again if already present in the ancestors, which avoids extra overhead.</p>

  </div>
</div>
<div class='tags'>
    <div class='examples'>
    <p class='tag_title'>Examples:</p>
      <pre class='example code "#{object.source_type}"'><code><span class='kw'>class</span> <span class='const'>AClass</span> <span class='op'>&lt;</span> <span class='const'><a href="../../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'><a href="../Synchronization.html" title="Concurrent::Synchronization (module)">Synchronization</a></span><span class='op'>::</span><span class='const'><a href="Object.html" title="Concurrent::Synchronization::Object (class)">Object</a></span>
  <span class='id identifier rubyid_extend'>extend</span> <span class='const'><a href="../../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'><a href="../Synchronization.html" title="Concurrent::Synchronization (module)">Synchronization</a></span><span class='op'>::</span><span class='const'>SafeInitialization</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'><a href="../Synchronization.html#initialize-instance_method" title="Concurrent::Synchronization#initialize (method)">initialize</a></span>
    <span class='ivar'>@AFinalValue</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># published safely, #foo will never return nil
</span>  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
    <span class='ivar'>@AFinalValue</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>
  </div>

</div>
</div>
<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-instance_method" title="#new (instance method)">#<strong>new</strong>(*args, &amp;block)  </a>
    </span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="new-instance_method">
  <h3 class='signature  first'>
    #<strong>new</strong>(*args, &amp;block)  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby-concurrency/concurrent-ruby/blob/master/lib/concurrent-ruby/concurrent/synchronization/safe_initialization.rb#L29-L33'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='29' data-end='33'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'lib/concurrent-ruby/concurrent/synchronization/safe_initialization.rb', line 29</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_new'>new</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>super</span>(<span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
<span class='kw'>ensure</span>
  <span class='const'><a href="../../Concurrent.html" title="Concurrent (module)">Concurrent</a></span><span class='op'>::</span><span class='const'><a href="../Synchronization.html" title="Concurrent::Synchronization (module)">Synchronization</a></span>.<span class='id identifier rubyid_full_memory_barrier'>full_memory_barrier</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>