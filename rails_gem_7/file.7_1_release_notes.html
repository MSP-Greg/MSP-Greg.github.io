<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: 7.1 Release Notes &mdash; Rails 7.2.3</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "7_1_release_notes",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Rails 7.2.3</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: 7.1 Release Notes&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><strong>DO NOT READ THIS FILE ON GITHUB, GUIDES ARE PUBLISHED ON <a href="https://guides.rubyonrails.org">https://guides.rubyonrails.org</a>.</strong></p>

<h1>Ruby on <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.1 Release Notes</h1>

<p>Highlights in <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.1:</p>

<ul>
<li>Generate Dockerfiles for new <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> applications</li>
<li>Add <code>ActiveRecord::Base.normalizes</code></li>
<li>Add <code>ActiveRecord::Base.generates_token_for</code></li>
<li>Add <code>perform_all_later</code> to enqueue multiple jobs at once</li>
<li>Composite primary keys</li>
<li>Introduce adapter for <code>Trilogy</code></li>
<li>Add <a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a></li>
<li>Introducing <code>config.autoload_lib</code> and <code>config.autoload_lib_once</code> for Enhanced Autoloading</li>
<li>Active Record API for general async queries</li>
<li>Allow templates to set strict <code>locals</code></li>
<li>Add <code>Rails.application.deprecators</code></li>
<li>Support pattern matching for JSON <code>response.parsed_body</code></li>
<li>Extend <code>response.parsed_body</code> to parse HTML with Nokogiri</li>
<li>Introduce <code>ActionView::TestCase.register_parser</code></li>
</ul>

<p>These release notes cover only the major changes. To learn about various bug
fixes and changes, please refer to the changelogs or check out the <a href="https://github.com/rails/rails/commits/7-1-stable">list of
commits</a> in the main <a href="Rails.html" title="Rails (module)"><code>Rails</code></a>
repository on GitHub.</p>

<hr>

<h2>Upgrading to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.1</h2>

<p>If you&#39;re upgrading an existing application, it&#39;s a great idea to have good test
coverage before going in. You should also first upgrade to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.0 in case you
haven&#39;t and make sure your application still runs as expected before attempting
an update to <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> 7.1. A list of things to watch out for when upgrading is
available in the
<a href="upgrading_ruby_on_rails.html#upgrading-from-rails-7-0-to-rails-7-1">Upgrading Ruby on Rails</a>
guide.</p>

<h2>Major Features</h2>

<h3>Generate Dockerfiles for new Rails applications</h3>

<p><a href="https://github.com/rails/rails/pull/46762">Default Docker support</a> to new <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> applications.
When generating a new application, <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> will now include Docker-related files in the application.</p>

<p>These files serve as a foundational setup for deploying your <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> application in a
production environment using Docker. It&#39;s important to note that these files are not
meant for development purposes.</p>

<p>Here&#39;s a quick example of how to build and run your <a href="Rails.html" title="Rails (module)"><code>Rails</code></a> app using these Docker files:</p>

<pre class="code bash"><code class="bash">$ docker build -t app .
$ docker volume create app-storage
$ docker run --rm -it -v app-storage:/rails/storage -p 3000:3000 --env RAILS_MASTER_KEY=&lt;your-config-master-key&gt; app
</code></pre>

<p>You can also start a console or runner from this Docker image:</p>

<pre class="code bash"><code class="bash">$ docker run --rm -it -v app-storage:/rails/storage --env RAILS_MASTER_KEY=&lt;your-config-master-key&gt; app console
</code></pre>

<p>For those looking to create a multi-platform image (e.g., Apple Silicon for AMD or Intel deployment),
and push it to Docker Hub, follow these steps:</p>

<pre class="code bash"><code class="bash">$ docker login -u &lt;your-user&gt;
$ docker buildx create --use
$ docker buildx build --push --platform=linux/amd64,linux/arm64 -t &lt;your-user/image-name&gt; .
</code></pre>

<p>This enhancement simplifies the deployment process, providing a convenient starting point for
getting your Rails application up and running in a production environment.</p>

<h3>Add <code>ActiveRecord::Base.normalizes</code></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveRecord/Normalization/ClassMethods.html#method-i-normalizes"><code>ActiveRecord::Base.normalizes</code></a> declares an attribute normalization. The
normalization is applied when the attribute is assigned or updated, and the
normalized value will be persisted to the database. The normalization is also
applied to the corresponding keyword argument of query methods, allowing records
to be queried using unnormalized values.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">Base</a></span>
  <span class='id identifier rubyid_normalizes'>normalizes</span> <span class='symbeg'>:</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_email'>email</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_email'>email</span>.<span class='id identifier rubyid_strip'>strip</span>.<span class='id identifier rubyid_downcase'>downcase</span> }
  <span class='id identifier rubyid_normalizes'>normalizes</span> <span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='label'>with:</span> <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_phone'>phone</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_phone'>phone</span>.<span class='id identifier rubyid_delete'>delete</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>^0-9</span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_delete_prefix'>delete_prefix</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>) }
<span class='kw'>end</span>

<span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>User</span>.<span class='id identifier rubyid_create'>create</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> CRUISE-CONTROL@EXAMPLE.COM\n</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_email'>email</span>                  <span class='comment'># =&gt; &quot;cruise-control@example.com&quot;
</span>
<span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>User</span>.<span class='id identifier rubyid_find_by'>find_by</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tCRUISE-CONTROL@EXAMPLE.COM </span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_email'>email</span>                  <span class='comment'># =&gt; &quot;cruise-control@example.com&quot;
</span><span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_email_before_type_cast'>email_before_type_cast</span> <span class='comment'># =&gt; &quot;cruise-control@example.com&quot;
</span>
<span class='const'>User</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tCRUISE-CONTROL@EXAMPLE.COM </span><span class='tstring_end'>&quot;</span></span>).<span class='id identifier rubyid_count'>count</span>         <span class='comment'># =&gt; 1
</span><span class='const'>User</span>.<span class='id identifier rubyid_where'>where</span>([<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tCRUISE-CONTROL@EXAMPLE.COM </span><span class='tstring_end'>&quot;</span></span>]).<span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 0
</span>
<span class='const'>User</span>.<span class='id identifier rubyid_exists?'>exists?</span>(<span class='label'>email:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tCRUISE-CONTROL@EXAMPLE.COM </span><span class='tstring_end'>&quot;</span></span>)         <span class='comment'># =&gt; true
</span><span class='const'>User</span>.<span class='id identifier rubyid_exists?'>exists?</span>([<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>email = ?</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tCRUISE-CONTROL@EXAMPLE.COM </span><span class='tstring_end'>&quot;</span></span>]) <span class='comment'># =&gt; false
</span>
<span class='const'>User</span>.<span class='id identifier rubyid_normalize_value_for'>normalize_value_for</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_phone'>phone</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+1 (555) 867-5309</span><span class='tstring_end'>&quot;</span></span>) <span class='comment'># =&gt; &quot;5558675309&quot;</span></code></pre>

<h3>Add <code>ActiveRecord::Base.generates_token_for</code></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveRecord/TokenFor/ClassMethods.html#method-i-generates_token_for"><code>ActiveRecord::Base.generates_token_for</code></a> defines the generation of tokens
for a specific purpose. Generated tokens can expire and can also embed record
data. When using a token to fetch a record, the data from the token and the
current data from the record will be compared. If the two do not match, the
token will be treated as invalid, the same as if it had expired.</p>

<p>Here is an example implementing a single-use password reset token:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>User</span> <span class='op'>&lt;</span> <span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">Base</a></span>
  <span class='id identifier rubyid_has_secure_password'>has_secure_password</span>

  <span class='id identifier rubyid_generates_token_for'>generates_token_for</span> <span class='symbeg'>:</span><span class='id identifier rubyid_password_reset'>password_reset</span><span class='comma'>,</span> <span class='label'>expires_in:</span> <span class='int'>15</span>.<span class='id identifier rubyid_minutes'>minutes</span> <span class='kw'>do</span>
    <span class='comment'># `password_salt` (defined by `has_secure_password`) returns the salt for
</span>    <span class='comment'># the password. The salt changes when the password is changed, so the token
</span>    <span class='comment'># will expire when the password is changed.
</span>    <span class='id identifier rubyid_password_salt'>password_salt</span><span class='op'>&amp;.</span><span class='id identifier rubyid_last'>last</span>(<span class='int'>10</span>)
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_user'>user</span> <span class='op'>=</span> <span class='const'>User</span>.<span class='id identifier rubyid_first'>first</span>
<span class='id identifier rubyid_token'>token</span> <span class='op'>=</span> <span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_generate_token_for'>generate_token_for</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_password_reset'>password_reset</span>)

<span class='const'>User</span>.<span class='id identifier rubyid_find_by_token_for'>find_by_token_for</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_password_reset'>password_reset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>) <span class='comment'># =&gt; user
</span>
<span class='id identifier rubyid_user'>user</span>.<span class='id identifier rubyid_update!'>update!</span>(<span class='label'>password:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new password</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'>User</span>.<span class='id identifier rubyid_find_by_token_for'>find_by_token_for</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_password_reset'>password_reset</span><span class='comma'>,</span> <span class='id identifier rubyid_token'>token</span>) <span class='comment'># =&gt; nil</span></code></pre>

<h3>Add <code>perform_all_later</code> to enqueue multiple jobs at once</h3>

<p>The <a href="https://github.com/rails/rails/pull/46603"><code>perform_all_later</code> method in Active Job</a>,
designed to streamline the process of enqueuing multiple jobs simultaneously. This powerful
addition allows you to efficiently enqueue jobs without triggering callbacks. This is
particularly useful when you need to enqueue a batch of jobs at once, reducing the overhead
of multiple round-trips to the queue datastore.</p>

<p>Here&#39;s how you can take advantage of <code>perform_all_later</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Enqueueing individual jobs
</span><span class='const'><a href="ActiveJob.html" title="ActiveJob (module)">ActiveJob</a></span>.<span class='id identifier rubyid_perform_all_later'><a href="ActiveJob.html#perform_all_later-class_method" title="ActiveJob.perform_all_later (method)">perform_all_later</a></span>(<span class='const'>MyJob</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>42</span>)<span class='comma'>,</span> <span class='const'>MyJob</span>.<span class='id identifier rubyid_new'>new</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>world</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='int'>0</span>))

<span class='comment'># Enqueueing an array of jobs
</span><span class='id identifier rubyid_user_jobs'>user_jobs</span> <span class='op'>=</span> <span class='const'>User</span>.<span class='id identifier rubyid_pluck'>pluck</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_id'>id</span>).<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span> <span class='const'>UserJob</span>.<span class='id identifier rubyid_new'>new</span>(<span class='label'>user_id:</span> <span class='id identifier rubyid_id'>id</span>) }
<span class='const'><a href="ActiveJob.html" title="ActiveJob (module)">ActiveJob</a></span>.<span class='id identifier rubyid_perform_all_later'><a href="ActiveJob.html#perform_all_later-class_method" title="ActiveJob.perform_all_later (method)">perform_all_later</a></span>(<span class='id identifier rubyid_user_jobs'>user_jobs</span>)</code></pre>

<p>By utilizing <code>perform_all_later</code>, you can optimize your job enqueuing process and take advantage
of improved efficiency, especially when working with large sets of jobs. It&#39;s worth noting that
for queue adapters that support the new <code>enqueue_all</code> method, such as the Sidekiq adapter, the
enqueuing process is further optimized using <code>push_bulk</code>.</p>

<p>Please be aware that this new method introduces a separate event, <code>enqueue_all.active_job</code>,
and does not utilize the existing <code>enqueue.active_job</code> event. This ensures accurate tracking
and reporting of the bulk enqueuing process.</p>

<h3>Composite primary keys</h3>

<p>Composite primary keys are now supported at both the database and application level. Rails is able to derive these keys directly from the schema. This feature is particularly beneficial for many-to-many relationships and other complex data models where a single column is insufficient to uniquely identify a record.</p>

<p>The SQL generated by query methods in Active Record (e.g. <code>#reload</code>, <code>#update</code>, <code>#delete</code>) will contain all parts of the composite primary key. Methods like <code>#first</code> and <code>#last</code> will use the full composite primary key in the <code>ORDER BY</code> statements.</p>

<p>The <code>query_constraints</code> macro can be used as a &quot;virtual primary key&quot; to achieve the same behavior without modifying the database schema.
Example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>TravelRoute</span> <span class='op'>&lt;</span> <span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">Base</a></span>
  <span class='id identifier rubyid_query_constraints'>query_constraints</span> <span class='symbeg'>:</span><span class='id identifier rubyid_origin'>origin</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_destination'>destination</span>
<span class='kw'>end</span></code></pre>

<p>Similarly, associations accept a  <code>query_constraints:</code> option. This option serves as a composite foreign key, configuring the list of columns used for accessing the associated record.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>TravelRouteReview</span> <span class='op'>&lt;</span> <span class='const'><a href="ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a></span><span class='op'>::</span><span class='const'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">Base</a></span>
  <span class='id identifier rubyid_belongs_to'>belongs_to</span> <span class='symbeg'>:</span><span class='id identifier rubyid_travel_route'>travel_route</span><span class='comma'>,</span> <span class='label'>query_constraints:</span> [<span class='symbeg'>:</span><span class='id identifier rubyid_travel_route_origin'>travel_route_origin</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_travel_route_destination'>travel_route_destination</span>]
<span class='kw'>end</span></code></pre>

<h3>Introduce adapter for <code>Trilogy</code></h3>

<p>A <a href="https://github.com/rails/rails/pull/47880">new adapter has been introduced</a> to facilitate the
seamless integration of <code>Trilogy</code>, a MySQL-compatible database client, with Rails applications.
Now, Rails applications have the option to incorporate <code>Trilogy</code> functionality by configuring their
<code>config/database.yml</code> file. For instance:</p>

<pre class="code yaml"><code class="yaml">development:
  adapter: trilogy
  database: blog_development
  pool: 5
</code></pre>

<p>Alternatively, integration can be achieved using the <code>DATABASE_URL</code> environment variable:</p>

<pre class="code ruby"><code class="ruby"><span class='const'>ENV</span>[<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DATABASE_URL</span><span class='tstring_end'>&#39;</span></span>] <span class='comment'># =&gt; &quot;trilogy://localhost/blog_development?pool=5&quot;</span></code></pre>

<h3>Add <a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a></h3>

<p><a href="https://api.rubyonrails.org/v7.1/classes/ActiveSupport/MessagePack.html"><a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a></a> is a serializer that integrates with the
<a href="https://github.com/msgpack/msgpack-ruby"><code>msgpack</code> gem</a>. <a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a> can serialize the basic Ruby
types supported by <code>msgpack</code>, as well as several additional types such as <a href="Time.html" title="Time (class)"><code>Time</code></a>,
<a href="ActiveSupport/TimeWithZone.html" title="ActiveSupport::TimeWithZone (class)"><code>::ActiveSupport::TimeWithZone</code></a>, and <a href="ActiveSupport/HashWithIndifferentAccess.html" title="ActiveSupport::HashWithIndifferentAccess (class)"><code>::ActiveSupport::HashWithIndifferentAccess</code></a>.
Compared to <code>JSON</code> and <code>Marshal</code>, <a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a> can reduce
payload size and improve performance.</p>

<p><a href="ActiveSupport/MessagePack.html" title="ActiveSupport::MessagePack (module)"><code>::ActiveSupport::MessagePack</code></a> can be used as a <a href="https://guides.rubyonrails.org/v7.1/configuring.html#config-active-support-message-serializer">message serializer</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_active_support'>active_support</span>.<span class='id identifier rubyid_message_serializer'>message_serializer</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span>

<span class='comment'># Or individually:
</span><span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/MessageEncryptor.html" title="ActiveSupport::MessageEncryptor (class)">MessageEncryptor</a></span>.<span class='id identifier rubyid_new'><a href="ActiveSupport/MessageEncryptor.html#new-class_method" title="ActiveSupport::MessageEncryptor.new (method)">new</a></span>(<span class='id identifier rubyid_secret'>secret</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span>)
<span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/MessageVerifier.html" title="ActiveSupport::MessageVerifier (class)">MessageVerifier</a></span>.<span class='id identifier rubyid_new'><a href="ActiveSupport/MessageVerifier.html#new-class_method" title="ActiveSupport::MessageVerifier.new (method)">new</a></span>(<span class='id identifier rubyid_secret'>secret</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span>)</code></pre>

<p>As the <a href="https://guides.rubyonrails.org/v7.1/configuring.html#config-action-dispatch-cookies-serializer">cookies serializer</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_action_dispatch'>action_dispatch</span>.<span class='id identifier rubyid_cookies_serializer'>cookies_serializer</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span></code></pre>

<p>And as a <a href="https://guides.rubyonrails.org/v7.1/caching_with_rails.html#configuration">cache serializer</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_cache_store'>cache_store</span> <span class='op'>=</span> <span class='symbeg'>:</span><span class='id identifier rubyid_file_store'>file_store</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tmp/cache</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> { <span class='label'>serializer:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span> }

<span class='comment'># Or individually:
</span><span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/Cache.html" title="ActiveSupport::Cache (module)">Cache</a></span>.<span class='id identifier rubyid_lookup_store'><a href="ActiveSupport/Cache.html#lookup_store-class_method" title="ActiveSupport::Cache.lookup_store (method)">lookup_store</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_file_store'>file_store</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tmp/cache</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_message_pack'>message_pack</span>)</code></pre>

<h3>Introducing <code>config.autoload_lib</code> and <code>config.autoload_lib_once</code> for Enhanced Autoloading</h3>

<p>A <a href="https://github.com/rails/rails/pull/48572">new configuration method, <code>config.autoload_lib(ignore:)</code></a>,
has been introduced. This method is used to enhance the autoload paths of applications by including the
<code>lib</code> directory, which is not included by default. Also, <code>config.autoload_lib(ignore: %w(assets tasks))</code>
is generated for new applications.</p>

<p>When invoked from either <code>config/application.rb</code> or <code>config/environments/*.rb</code>, this method adds the
<code>lib</code> directory to both <code>config.autoload_paths</code> and <code>config.eager_load_paths</code>. It&#39;s important to note
that this feature is not available for engines.</p>

<p>To ensure flexibility, the <code>ignore</code> keyword argument can be used to specify subdirectories within the
<code>lib</code> directory that should not be managed by the autoloaders. For instance, you can exclude directories
like <code>assets</code>, <code>tasks</code>, and <code>generators</code> by passing them to the <code>ignore</code> argument:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_config'>config</span>.<span class='id identifier rubyid_autoload_lib'>autoload_lib</span>(<span class='label'>ignore:</span> <span class='qwords'><span class='qwords_beg'>%w(</span><span class='tstring_content'>assets</span><span class='words_sep'> </span><span class='tstring_content'>tasks</span><span class='words_sep'> </span><span class='tstring_content'>generators</span><span class='tstring_end'>)</span></span>)</code></pre>

<p>The <a href="https://github.com/rails/rails/pull/48610"><code>config.autoload_lib_once</code> method</a> is similar to
<code>config.autoload_lib</code>, except that it adds <code>lib</code> to <code>config.autoload_once_paths</code> instead.</p>

<p>Please, see more details in the <a href="autoloading_and_reloading_constants.html#config-autoload-lib-ignore">autoloading guide</a></p>

<h3>Active Record API for general async queries</h3>

<p>A significant enhancement has been introduced to the Active Record API, expanding its
<a href="https://github.com/rails/rails/pull/44446">support for asynchronous queries</a>. This enhancement
addresses the need for more efficient handling of not-so-fast queries, particularly focusing on
aggregates (such as <code>count</code>, <code>sum</code>, etc.) and all methods returning a single record or anything
other than a <code>Relation</code>.</p>

<p>The new API includes the following asynchronous methods:</p>

<ul>
<li><code>async_count</code></li>
<li><code>async_sum</code></li>
<li><code>async_minimum</code></li>
<li><code>async_maximum</code></li>
<li><code>async_average</code></li>
<li><code>async_pluck</code></li>
<li><code>async_pick</code></li>
<li><code>async_ids</code></li>
<li><code>async_find_by_sql</code></li>
<li><code>async_count_by_sql</code></li>
</ul>

<p>Here&#39;s a brief example of how to use one of these methods, <code>async_count</code>, to count the number of published
posts in an asynchronous manner:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Synchronous count
</span><span class='id identifier rubyid_published_count'>published_count</span> <span class='op'>=</span> <span class='const'>Post</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>published:</span> <span class='kw'>true</span>).<span class='id identifier rubyid_count'>count</span> <span class='comment'># =&gt; 10
</span>
<span class='comment'># Asynchronous count
</span><span class='id identifier rubyid_promise'>promise</span> <span class='op'>=</span> <span class='const'>Post</span>.<span class='id identifier rubyid_where'>where</span>(<span class='label'>published:</span> <span class='kw'>true</span>).<span class='id identifier rubyid_async_count'>async_count</span> <span class='comment'># =&gt; #&lt;ActiveRecord::Promise status=pending&gt;
</span><span class='id identifier rubyid_promise'>promise</span>.<span class='id identifier rubyid_value'>value</span> <span class='comment'># =&gt; 10</span></code></pre>

<p>These methods allow for the execution of these operations in an asynchronous manner, which can significantly
improve performance for certain types of database queries.</p>

<h3>Allow templates to set strict <code>locals</code></h3>

<p>Introduce a new feature that <a href="https://github.com/rails/rails/pull/45602">allows templates to set explicit <code>locals</code></a>.
This enhancement provides greater control and clarity when passing variables to your templates.</p>

<p>By default, templates will accept any <code>locals</code> as keyword arguments. However, now you can define what <code>locals</code> a
template should accept by adding a <code>locals</code> magic comment at the beginning of your template file.</p>

<p>Here&#39;s how it works:</p>

<pre class="code xml"><code class="xml">&lt;%# locals: (message:) -%&gt;
&lt;%= message %&gt;
</code></pre>

<p>You can also set default values for these locals:</p>

<pre class="code xml"><code class="xml">&lt;%# locals: (message: &quot;Hello, world!&quot;) -%&gt;
&lt;%= message %&gt;
</code></pre>

<p>Optional keyword arguments can be splatted:</p>

<pre class="code xml"><code class="xml">&lt;%# locals: (message: &quot;Hello, world!&quot;, **attributes) -%&gt;
&lt;%= tag.p(message, **attributes) %&gt;
</code></pre>

<p>If you want to disable the use of locals entirely, you can do so like this:</p>

<pre class="code xml"><code class="xml">&lt;%# locals: () %&gt;
</code></pre>

<p>Action View will process the <code>locals:</code> magic comment in any templating engine that supports <code>#</code>-prefixed comments, and will read the magic comment from any line in the partial.</p>

<p>CAUTION: Only keyword arguments are supported. Defining positional or block arguments will raise an Action View Error at render-time.</p>

<h3>Add <code>Rails.application.deprecators</code></h3>

<p>The new <a href="https://github.com/rails/rails/pull/46049"><code>Rails.application.deprecators</code> method</a> returns a
collection of managed deprecators within your application, and allows you to add and retrieve individual
deprecators with ease:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_my_gem'>my_gem</span>] <span class='op'>=</span> <span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span>.<span class='id identifier rubyid_new'><a href="ActiveSupport/Deprecation.html#new-class_method" title="ActiveSupport::Deprecation.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>MyGem</span><span class='tstring_end'>&quot;</span></span>)
<span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_other_gem'>other_gem</span>] <span class='op'>=</span> <span class='const'><a href="ActiveSupport.html" title="ActiveSupport (module)">ActiveSupport</a></span><span class='op'>::</span><span class='const'><a href="ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)">Deprecation</a></span>.<span class='id identifier rubyid_new'><a href="ActiveSupport/Deprecation.html#new-class_method" title="ActiveSupport::Deprecation.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>3.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>OtherGem</span><span class='tstring_end'>&quot;</span></span>)</code></pre>

<p>The collection&#39;s configuration settings affect all deprecators in the collection.</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>.<span class='id identifier rubyid_debug'>debug</span> <span class='op'>=</span> <span class='kw'>true</span>

<span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_my_gem'>my_gem</span>].<span class='id identifier rubyid_debug'>debug</span>
<span class='comment'># =&gt; true
</span>
<span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_other_gem'>other_gem</span>].<span class='id identifier rubyid_debug'>debug</span>
<span class='comment'># =&gt; true</span></code></pre>

<p>There are scenarios where you might want to mute all deprecator warnings for a specific block of code.
With the deprecators collection, you can easily silence all deprecator warnings within a block:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>.<span class='id identifier rubyid_silence'>silence</span> <span class='kw'>do</span>
  <span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_my_gem'>my_gem</span>].<span class='id identifier rubyid_warn'>warn</span>    <span class='comment'># No warning (silenced)
</span>  <span class='const'><a href="Rails.html" title="Rails (module)">Rails</a></span>.<span class='id identifier rubyid_application'><a href="Rails.html#application-class_method" title="Rails.application (method)">application</a></span>.<span class='id identifier rubyid_deprecators'>deprecators</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_other_gem'>other_gem</span>].<span class='id identifier rubyid_warn'>warn</span> <span class='comment'># No warning (silenced)
</span><span class='kw'>end</span></code></pre>

<h3>Support pattern matching for JSON <code>response.parsed_body</code></h3>

<p>When <a href="ActionDispatch/IntegrationTest.html" title="ActionDispatch::IntegrationTest (class)"><code>::ActionDispatch::IntegrationTest</code></a> tests blocks invoke
<code>response.parsed_body</code> for JSON responses, their payloads will be available with
indifferent access. This enables integration with <a href="https://docs.ruby-lang.org/en/master/syntax/pattern_matching_rdoc.html">Ruby&#39;s Pattern
Matching</a>, and built-in <a href="https://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-assert_pattern">Minitest support for pattern
matching</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts.json</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_content_type'>content_type</span>         <span class='comment'># =&gt; &quot;application/json; charset=utf-8&quot;
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>.<span class='id identifier rubyid_class'>class</span>    <span class='comment'># =&gt; Array
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>          <span class='comment'># =&gt; [{&quot;id&quot;=&gt;42, &quot;title&quot;=&gt;&quot;Title&quot;},...
</span>
<span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span> <span class='op'>=&gt;</span> [{ <span class='label'>id:</span> <span class='int'>42</span> }] }

<span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts/42.json</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_content_type'>content_type</span>         <span class='comment'># =&gt; &quot;application/json; charset=utf-8&quot;
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>.<span class='id identifier rubyid_class'>class</span>    <span class='comment'># =&gt; ActiveSupport::HashWithIndifferentAccess
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>          <span class='comment'># =&gt; {&quot;id&quot;=&gt;42, &quot;title&quot;=&gt;&quot;Title&quot;}
</span>
<span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span> <span class='op'>=&gt;</span> [{ <span class='label'>title:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>title</span><span class='regexp_end'>/i</span></span> }] }</code></pre>

<h3>Extend <code>response.parsed_body</code> to parse HTML with Nokogiri</h3>

<p><a href="https://github.com/rails/rails/pull/47144">Extend the <code>ActionDispatch::Testing</code> module</a> to support parsing the
value of an HTML <code>response.body</code> into a <code>Nokogiri::HTML5::Document</code> instance:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_content_type'>content_type</span>         <span class='comment'># =&gt; &quot;text/html; charset=utf-8&quot;
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>.<span class='id identifier rubyid_class'>class</span>    <span class='comment'># =&gt; Nokogiri::HTML5::Document
</span><span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span>.<span class='id identifier rubyid_to_html'>to_html</span>  <span class='comment'># =&gt; &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n...&quot;</span></code></pre>

<p>Newly added <a href="https://nokogiri.org/rdoc/Nokogiri/XML/Attr.html#method-i-deconstruct_keys">Nokogiri support for pattern matching</a>,
along with built-in <a href="https://docs.seattlerb.org/minitest/Minitest/Assertions.html#method-i-assert_pattern">Minitest support for pattern
matching</a> presents opportunities to make test
assertions about the structure and content of the HTML response:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_get'>get</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/posts</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_html'>html</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span>.<span class='id identifier rubyid_parsed_body'>parsed_body</span> <span class='comment'># =&gt; &lt;html&gt;
</span>                            <span class='comment'>#      &lt;head&gt;&lt;/head&gt;
</span>                            <span class='comment'>#        &lt;body&gt;
</span>                            <span class='comment'>#          &lt;main&gt;&lt;h1&gt;Some main content&lt;/h1&gt;&lt;/main&gt;
</span>                            <span class='comment'>#        &lt;/body&gt;
</span>                            <span class='comment'>#     &lt;/html&gt;
</span>
<span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_html'>html</span>.<span class='id identifier rubyid_at'>at</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>=&gt;</span> { <span class='label'>content:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Some main content</span><span class='tstring_end'>&quot;</span></span> } }
<span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_html'>html</span>.<span class='id identifier rubyid_at'>at</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>=&gt;</span> { <span class='label'>content:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>content</span><span class='regexp_end'>/</span></span> } }
<span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_html'>html</span>.<span class='id identifier rubyid_at'>at</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>=&gt;</span> { <span class='label'>children:</span> [{ <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>h1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>content:</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>content</span><span class='regexp_end'>/</span></span> }] } }</code></pre>

<h3>Introduce <code>ActionView::TestCase.register_parser</code></h3>

<p><a href="https://github.com/rails/rails/pull/49194">Extend <a href="ActionView/TestCase.html" title="ActionView::TestCase (class)"><code>::ActionView::TestCase</code></a></a> to support parsing content rendered by
view partials into known structures. By default, define <code>rendered_html</code> to parse
HTML into a <code>Nokogiri::XML::Node</code> and <code>rendered_json</code> to parse JSON into an
<a href="ActiveSupport/HashWithIndifferentAccess.html" title="ActiveSupport::HashWithIndifferentAccess (class)"><code>::ActiveSupport::HashWithIndifferentAccess</code></a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_test'>test</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>renders HTML</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_article'>article</span> <span class='op'>=</span> <span class='const'>Article</span>.<span class='id identifier rubyid_create!'>create!</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>articles/article</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>locals:</span> { <span class='label'>article:</span> <span class='id identifier rubyid_article'>article</span> }

  <span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_rendered_html'>rendered_html</span>.<span class='id identifier rubyid_at'>at</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main h1</span><span class='tstring_end'>&quot;</span></span>) <span class='op'>=&gt;</span> { <span class='label'>content:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span> } }
<span class='kw'>end</span>

<span class='id identifier rubyid_test'>test</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>renders JSON</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_article'>article</span> <span class='op'>=</span> <span class='const'>Article</span>.<span class='id identifier rubyid_create!'>create!</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_render'>render</span> <span class='label'>formats:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_json'>json</span><span class='comma'>,</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>articles/article</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>locals:</span> { <span class='label'>article:</span> <span class='id identifier rubyid_article'>article</span> }

  <span class='id identifier rubyid_assert_pattern'>assert_pattern</span> { <span class='id identifier rubyid_rendered_json'>rendered_json</span> <span class='op'>=&gt;</span> { <span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span> } }
<span class='kw'>end</span></code></pre>

<p>To parse the rendered content into RSS, register a call to <code>RSS::Parser.parse</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_register_parser'>register_parser</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rss'>rss</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_rendered'>rendered</span> <span class='tlambeg'>{</span> <span class='const'>RSS</span><span class='op'>::</span><span class='const'>Parser</span>.<span class='id identifier rubyid_parse'>parse</span>(<span class='id identifier rubyid_rendered'>rendered</span>) }

<span class='id identifier rubyid_test'>test</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>renders RSS</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_article'>article</span> <span class='op'>=</span> <span class='const'>Article</span>.<span class='id identifier rubyid_create!'>create!</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_render'>render</span> <span class='label'>formats:</span> <span class='symbeg'>:</span><span class='id identifier rubyid_rss'>rss</span><span class='comma'>,</span> <span class='label'>partial:</span> <span class='id identifier rubyid_article'>article</span><span class='comma'>,</span> <span class='label'>locals:</span> { <span class='label'>article:</span> <span class='id identifier rubyid_article'>article</span> }

  <span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_rendered_rss'>rendered_rss</span>.<span class='id identifier rubyid_items'>items</span>.<span class='id identifier rubyid_last'>last</span>.<span class='id identifier rubyid_title'>title</span>
<span class='kw'>end</span></code></pre>

<p>To parse the rendered content into a Capybara::Simple::Node, re-register an
<code>:html</code> parser with a call to <code>Capybara.string</code>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_register_parser'>register_parser</span> <span class='symbeg'>:</span><span class='id identifier rubyid_html'>html</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='id identifier rubyid_rendered'>rendered</span> <span class='tlambeg'>{</span> <span class='const'>Capybara</span>.<span class='id identifier rubyid_string'>string</span>(<span class='id identifier rubyid_rendered'>rendered</span>) }

<span class='id identifier rubyid_test'>test</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>renders HTML</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_article'>article</span> <span class='op'>=</span> <span class='const'>Article</span>.<span class='id identifier rubyid_create!'>create!</span>(<span class='label'>title:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span>)

  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='id identifier rubyid_article'>article</span>

  <span class='id identifier rubyid_rendered_html'>rendered_html</span>.<span class='id identifier rubyid_assert_css'>assert_css</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>main h1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>text:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello, world</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>

<h2>Railties</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/railties/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated <code>bin/rails secrets:setup</code> command.</p></li>
<li><p>Remove default <code>X-Download-Options</code> header since it is used only by Internet Explorer.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate usage of <code>Rails.application.secrets</code>.</p></li>
<li><p>Deprecate <code>secrets:show</code> and <code>secrets:edit</code> commands in favor of <code>credentials</code>.</p></li>
<li><p>Deprecate <code>Rails::Generators::Testing::Behaviour</code> in favor of <a href="Rails/Generators/Testing/Behavior.html" title="Rails::Generators::Testing::Behavior (module)"><code>::Rails::Generators::Testing::Behavior</code></a>.</p></li>
</ul>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>sandbox_by_default</code> option to start rails console in sandbox mode by default.</p></li>
<li><p>Add new syntax for support filtering tests by line ranges.</p></li>
<li><p>Add <code>DATABASE</code> option that enables the specification of the target database when executing the
<code>rails railties:install:migrations</code> command to copy migrations.</p></li>
<li><p>Add support for Bun in <code>rails new --javascript</code> generator.</p>

<pre class="code bash"><code class="bash">$ rails new my_new_app --javascript=bun
</code></pre></li>
<li><p>Add ability to show slow tests to the test runner.</p></li>
</ul>

<h2>Action Cable</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actioncable/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>capture_broadcasts</code> test helper to capture all messages broadcasted in a block.</p></li>
<li><p>Add the ability to Redis pub/sub adapter to automatically reconnect when Redis connection is lost.</p></li>
<li><p>Add command callbacks <code>before_command</code>, <code>after_command</code>, and <code>around_command</code> to <a href="ActionCable/Connection/Base.html" title="ActionCable::Connection::Base (class)"><code>::ActionCable::Connection::Base</code></a>.</p></li>
</ul>

<h2>Action Pack</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionpack/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated behavior on <code>Request#content_type</code></p></li>
<li><p>Remove deprecated ability to assign a single value to <code>config.action_dispatch.trusted_proxies</code>.</p></li>
<li><p>Remove deprecated <code>poltergeist</code> and <code>webkit</code> (capybara-webkit) driver registration for system testing.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate <code>config.action_dispatch.return_only_request_media_type_on_content_type</code>.</p></li>
<li><p>Deprecate <code>AbstractController::Helpers::MissingHelperError</code>.</p></li>
<li><p>Deprecate <code>ActionDispatch::IllegalStateError</code>.</p></li>
<li><p>Deprecate <code>speaker</code>, <code>vibrate</code>, and <code>vr</code> permissions policy directives.</p></li>
<li><p>Deprecate <code>true</code> and <code>false</code> values for <code>config.action_dispatch.show_exceptions</code> in favor of <code>:all</code>, <code>:rescuable</code>, or <code>:none</code>.</p></li>
</ul>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>exclude?</code> method to <a href="ActionController/Parameters.html" title="ActionController::Parameters (class)"><code>::ActionController::Parameters</code></a>. It is the inverse of <code>include?</code> method.</p></li>
<li><p>Add <a href="ActionController/Parameters.html#extract_value-instance_method" title="ActionController::Parameters#extract_value (method)">ActionController::Parameters#extract_value</a> method to allow extracting serialized values from params.</p></li>
<li><p>Add the ability to use custom logic for storing and retrieving CSRF tokens.</p></li>
<li><p>Add <code>html</code> and <code>screenshot</code> kwargs for system test screenshot helper.</p></li>
</ul>

<h2>Action View</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionview/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated constant <code>ActionView::Path</code>.</p></li>
<li><p>Remove deprecated support to passing instance variables as locals to partials.</p></li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p><code>check_box_tag</code> and <code>radio_button_tag</code> now accept <code>checked</code> as a keyword argument.</p></li>
<li><p>Add <code>picture_tag</code> helper to generate HTML <code>&lt;picture&gt;</code> tags.</p></li>
<li><p>The <code>simple_format</code> helper now handles a <code>:sanitize_options</code> feature, allowing the addition of extra
options for the sanitize process.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_simple_format'>simple_format</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&lt;a target=\&quot;_blank\&quot; href=\&quot;http://example.com\&quot;&gt;Continue&lt;/a&gt;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> {}<span class='comma'>,</span> { <span class='label'>sanitize_options:</span> { <span class='label'>attributes:</span> <span class='qwords'><span class='qwords_beg'>%w[</span><span class='tstring_content'>target</span><span class='words_sep'> </span><span class='tstring_content'>href</span><span class='tstring_end'>]</span></span> } })
<span class='comment'># =&gt; &quot;&lt;p&gt;&lt;a target=\&quot;_blank\&quot; href=\&quot;http://example.com\&quot;&gt;Continue&lt;/a&gt;&lt;/p&gt;&quot;</span></code></pre></li>
</ul>

<h2>Action Mailer</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionmailer/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate <code>config.action_mailer.preview_path</code>.</p></li>
<li><p>Deprecate passing params to <code>assert_enqueued_email_with</code> via the <code>:args</code> kwarg.
Now supports a <code>:params</code> kwarg, so use that to pass params.</p></li>
</ul>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>config.action_mailer.preview_paths</code> to support multiple preview paths.</p></li>
<li><p>Add <code>capture_emails</code> in the test helper to capture all emails sent in a block.</p></li>
<li><p>Add <code>deliver_enqueued_emails</code> to <a href="ActionMailer/TestHelper.html" title="ActionMailer::TestHelper (module)"><code>::ActionMailer::TestHelper</code></a> to deliver all enqueued email jobs.</p></li>
</ul>

<h2>Active Record</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activerecord/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove support for <code>ActiveRecord.legacy_connection_handling</code>.</p></li>
<li><p>Remove deprecated <a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)"><code>::ActiveRecord::Base</code></a> config accessors</p></li>
<li><p>Remove support for <code>:include_replicas</code> on <code>configs_for</code>. Use <code>:include_hidden</code> instead.</p></li>
<li><p>Remove deprecated <code>config.active_record.partial_writes</code>.</p></li>
<li><p>Remove deprecated <code>Tasks::DatabaseTasks.schema_file_type</code>.</p></li>
<li><p>Remove <code>--no-comments</code> flag in structure dumps for PostgreSQL.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate <code>name</code> argument on <code>#remove_connection</code>.</p></li>
<li><p>Deprecate <code>check_pending!</code> in favor of <code>check_all_pending!</code>.</p></li>
<li><p>Deprecate <code>deferrable: true</code> option of <code>add_foreign_key</code> in favor of <code>deferrable: :immediate</code>.</p></li>
<li><p>Deprecate <code>TestFixtures#fixture_path</code> in favor of <code>TestFixtures#fixture_paths</code>.</p></li>
<li><p>Deprecate delegation from <code>Base</code> to <code>connection_handler</code>.</p></li>
<li><p>Deprecate <code>config.active_record.suppress_multiple_database_warning</code>.</p></li>
<li><p>Deprecate using <a href="ActiveSupport/Duration.html" title="ActiveSupport::Duration (class)"><code>::ActiveSupport::Duration</code></a> as an interpolated bind parameter in an SQL
string template.</p></li>
<li><p>Deprecate <code>all_connection_pools</code> and make <code>connection_pool_list</code> more explicit.</p></li>
<li><p>Deprecate <code>read_attribute(:id)</code> returning the primary key if the primary key is not <code>:id</code>.</p></li>
<li><p>Deprecate <code>rewhere</code> argument on <code>#merge</code>.</p></li>
<li><p>Deprecate aliasing non-attributes with <code>alias_attribute</code>.</p></li>
</ul>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>TestFixtures#fixture_paths</code> to support multiple fixture paths.</p></li>
<li><p>Add <code>authenticate_by</code> when using <code>has_secure_password</code>.</p></li>
<li><p>Add <code>update_attribute!</code> to <a href="ActiveRecord/Persistence.html" title="ActiveRecord::Persistence (module)"><code>::ActiveRecord::Persistence</code></a>, which is similar to <code>update_attribute</code>
but raises <a href="ActiveRecord/RecordNotSaved.html" title="ActiveRecord::RecordNotSaved (class)"><code>::ActiveRecord::RecordNotSaved</code></a> when a <code>before_*</code> callback throws <code>:abort</code>.</p></li>
<li><p>Allow using aliased attributes with <code>insert_all</code>/<code>upsert_all</code>.</p></li>
<li><p>Add <code>:include</code> option to <code>add_index</code>.</p></li>
<li><p>Add <code>#regroup</code> query method as a short-hand for <code>.unscope(:group).group(fields)</code>.</p></li>
<li><p>Add support for auto-populated columns, and custom primary keys to the <code>SQLite3</code> adapter.</p></li>
<li><p>Add modern, performant defaults for <code>SQLite3</code> database connections.</p></li>
<li><p>Allow specifying where clauses with column-tuple syntax.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Topic</span>.<span class='id identifier rubyid_where'>where</span>([<span class='symbeg'>:</span><span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_author_name'>author_name</span>] <span class='op'>=&gt;</span> [[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The Alchemist</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Paulo Coelho</span><span class='tstring_end'>&quot;</span></span>]<span class='comma'>,</span> [<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Harry Potter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>J.K Rowling</span><span class='tstring_end'>&quot;</span></span>]])</code></pre></li>
<li><p>Auto generated index names are now limited to 62 bytes, which fits within the default
index name length limits for MySQL, PostgreSQL and SQLite.</p></li>
<li><p>Introduce adapter for Trilogy database client.</p></li>
<li><p>Add <a href="ActiveRecord.html#disconnect_all!-class_method" title="ActiveRecord.disconnect_all! (method)">ActiveRecord.disconnect_all!</a> method to immediately close all connections from all pools.</p></li>
<li><p>Add PostgreSQL migration commands for enum rename, add value, and rename value.</p></li>
<li><p>Add <code>ActiveRecord::Base#id_value</code> alias to access the raw value of a record&#39;s id column.</p></li>
<li><p>Add validation option for <code>enum</code>.</p></li>
<li><p>The default hash digest for <a href="ActiveRecord/Encryption.html" title="ActiveRecord::Encryption (module)"><code>::ActiveRecord::Encryption</code></a>, used for attributes defined with <code>encrypts</code>, is now <code>SHA256</code>, changed from <code>SHA1</code> in the default configuration. These defaults also include <code>support_sha1_for_non_deterministic_encryption = false</code> which can lead to apps being unable to decrypt data encrypted with the old default hash digest if data is not re-encrypted.</p></li>
</ul>

<h2>Active Storage</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activestorage/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated invalid default content types in Active Storage configurations.</p></li>
<li><p>Remove deprecated <code>ActiveStorage::Current#host</code> and <code>ActiveStorage::Current#host=</code> methods.</p></li>
<li><p>Remove deprecated behavior when assigning to a collection of attachments. Instead of appending to the collection,
the collection is now replaced.</p></li>
<li><p>Remove deprecated <code>purge</code> and <code>purge_later</code> methods from the attachments association.</p></li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p><a href="ActiveStorage/Analyzer/AudioAnalyzer.html" title="ActiveStorage::Analyzer::AudioAnalyzer (class)"><code>::ActiveStorage::Analyzer::AudioAnalyzer</code></a> now outputs <code>sample_rate</code> and <code>tags</code> in the output <code>metadata</code> hash.</p></li>
<li><p>Add the option to utilize predefined variants when invoking the <code>preview</code> or <code>representation</code> methods on an
attachment.</p></li>
<li><p><code>preprocessed</code> option is added when declaring variants to preprocess variants.</p></li>
<li><p>Add the ability to destroy Active Storage variants.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>User</span>.<span class='id identifier rubyid_first'>first</span>.<span class='id identifier rubyid_avatar'>avatar</span>.<span class='id identifier rubyid_variant'>variant</span>(<span class='label'>resize_to_limit:</span> [<span class='int'>100</span><span class='comma'>,</span> <span class='int'>100</span>]).<span class='id identifier rubyid_destroy'>destroy</span></code></pre></li>
</ul>

<h2>Active Model</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activemodel/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p>Add support for infinite ranges to <code>LengthValidator</code>s <code>:in</code>/<code>:within</code> options.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_validates_length_of'>validates_length_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_first_name'>first_name</span><span class='comma'>,</span> <span class='label'>in:</span> <span class='op'>..</span><span class='int'>30</span></code></pre></li>
<li><p>Add support for beginless ranges to <code>inclusivity/exclusivity</code> validators.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_validates_inclusion_of'>validates_inclusion_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_birth_date'>birth_date</span><span class='comma'>,</span> <span class='label'>in:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> (<span class='op'>..</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span>) }</code></pre>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_validates_exclusion_of'>validates_exclusion_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_birth_date'>birth_date</span><span class='comma'>,</span> <span class='label'>in:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> (<span class='op'>..</span><span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span>) }</code></pre></li>
<li><p>Add support for password challenges to <code>has_secure_password</code>. When set, validate that the password
challenge matches the persisted <code>password_digest</code>.</p></li>
<li><p>Allow validators to accept lambdas without record argument.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Before
</span><span class='id identifier rubyid_validates_comparison_of'>validates_comparison_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_birth_date'>birth_date</span><span class='comma'>,</span> <span class='label'>less_than_or_equal_to:</span> <span class='tlambda'>-&gt;</span>(<span class='id identifier rubyid__record'>_record</span>) <span class='tlambeg'>{</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span> }

<span class='comment'># After
</span><span class='id identifier rubyid_validates_comparison_of'>validates_comparison_of</span> <span class='symbeg'>:</span><span class='id identifier rubyid_birth_date'>birth_date</span><span class='comma'>,</span> <span class='label'>less_than_or_equal_to:</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='const'><a href="Date.html" title="Date (class)">Date</a></span>.<span class='id identifier rubyid_today'>today</span> }</code></pre></li>
</ul>

<h2>Active Support</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activesupport/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li><p>Remove deprecated override of <code>Enumerable#sum</code>.</p></li>
<li><p>Remove deprecated <code>ActiveSupport::PerThreadRegistry</code>.</p></li>
<li><p>Remove deprecated option to passing a format to <code>#to_s</code> in <a href="Array.html" title="Array (class)"><code>Array</code></a>, <a href="Range.html" title="Range (class)"><code>Range</code></a>, <a href="Date.html" title="Date (class)"><code>Date</code></a>, <a href="DateTime.html" title="DateTime (class)"><code>DateTime</code></a>, <a href="Time.html" title="Time (class)"><code>Time</code></a>,
<a href="BigDecimal.html" title="BigDecimal (class)"><code>BigDecimal</code></a>, <a href="Float.html" title="Float (class)"><code>Float</code></a> and, <a href="Integer.html" title="Integer (class)"><code>Integer</code></a>.</p></li>
<li><p>Remove deprecated override of <code>ActiveSupport::TimeWithZone.name</code>.</p></li>
<li><p>Remove deprecated <code>active_support/core_ext/uri</code> file.</p></li>
<li><p>Remove deprecated <code>active_support/core_ext/range/include_time_with_zone</code> file.</p></li>
<li><p>Remove implicit conversion of objects into <a href="String.html" title="String (class)"><code>String</code></a> by <a href="ActiveSupport/SafeBuffer.html" title="ActiveSupport::SafeBuffer (class)"><code>::ActiveSupport::SafeBuffer</code></a>.</p></li>
<li><p>Remove deprecated support to generate incorrect RFC 4122 UUIDs when providing a namespace ID that is not one of the
constants defined on <a href="Digest/UUID.html" title="Digest::UUID (module)"><code>::Digest::UUID</code></a>.</p></li>
</ul>

<h3>Deprecations</h3>

<ul>
<li><p>Deprecate <code>config.active_support.disable_to_s_conversion</code>.</p></li>
<li><p>Deprecate <code>config.active_support.remove_deprecated_time_with_zone_name</code>.</p></li>
<li><p>Deprecate <code>config.active_support.use_rfc4122_namespaced_uuids</code>.</p></li>
<li><p>Deprecate <code>SafeBuffer#clone_empty</code>.</p></li>
<li><p>Deprecate usage of the singleton <a href="ActiveSupport/Deprecation.html" title="ActiveSupport::Deprecation (class)"><code>::ActiveSupport::Deprecation</code></a>.</p></li>
<li><p>Deprecate initializing a <a href="ActiveSupport/Cache/MemCacheStore.html" title="ActiveSupport::Cache::MemCacheStore (class)"><code>::ActiveSupport::Cache::MemCacheStore</code></a> with an instance of <code>Dalli::Client</code>.</p></li>
<li><p>Deprecate <code>Notification::Event</code>&#39;s <code>#children</code> and <code>#parent_of?</code> methods.</p></li>
</ul>

<h3>Notable changes</h3>

<h2>Active Job</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/activejob/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<ul>
<li>  Remove <code>QueAdapter</code>.</li>
</ul>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>perform_all_later</code> to enqueue multiple jobs at once.</p></li>
<li><p>Add <code>--parent</code> option to job generator to specify parent class of job.</p></li>
<li><p>Add <code>after_discard</code> method to <a href="ActiveJob/Base.html" title="ActiveJob::Base (class)"><code>::ActiveJob::Base</code></a> to run a callback when a job is about to be discarded.</p></li>
<li><p>Add support for logging background job enqueue callers.</p></li>
</ul>

<h2>Action Text</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actiontext/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<h2>Action Mailbox</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/actionmailbox/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Removals</h3>

<h3>Deprecations</h3>

<h3>Notable changes</h3>

<ul>
<li><p>Add <code>X-Forwarded-To</code> addresses to recipients.</p></li>
<li><p>Add <code>bounce_now_with</code> method to <a href="ActionMailbox/Base.html" title="ActionMailbox::Base (class)"><code>::ActionMailbox::Base</code></a> to send the bounce email without going through a
mailer queue.</p></li>
</ul>

<h2>Ruby on Rails Guides</h2>

<p>Please refer to the <a href="https://github.com/rails/rails/blob/7-1-stable/guides/CHANGELOG.md">Changelog</a> for detailed changes.</p>

<h3>Notable changes</h3>

<h2>Credits</h2>

<p>See the
<a href="https://contributors.rubyonrails.org/">full list of contributors to Rails</a>
for the many people who spent many hours making Rails, the stable and robust
framework it is. Kudos to all of them.</p>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>