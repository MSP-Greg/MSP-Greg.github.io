<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActiveRecord::QueryCache::ClassMethods &mdash; Rails 7.2.3</title>

<link rel='stylesheet'  type='text/css' href='../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActiveRecord::QueryCache::ClassMethods",
    relpath = '../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../'>Rails 7.2.3</a> &raquo; 
      <a href='../../_index.html#alpha_C'>Index (C)</a> &raquo; 
        <a href="../../ActiveRecord.html" title="ActiveRecord (module)">ActiveRecord</a> &raquo; 
        <a href="../QueryCache.html" title="ActiveRecord::QueryCache (class)">QueryCache</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>ClassMethods&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActiveRecord::QueryCache::ClassMethods</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Extended In:</div>
      <div class='box_11'>
        <a href="../Base.html" title="ActiveRecord::Base (class)"><code>::ActiveRecord::Base</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/v7.2.3/activerecord/lib/active_record/query_cache.rb#L6'>activerecord/lib/active_record/query_cache.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#cache-instance_method" title="#cache (instance method)">#<strong>cache</strong>(&amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Enable the query cache within the block if Active Record is configured.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#uncached-instance_method" title="#uncached (instance method)">#<strong>uncached</strong>(dirties: true, &amp;block)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Disable the query cache within the block if Active Record is configured.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="cache-instance_method">
  <h3 class='signature  first'>
    #<strong>cache</strong>(&amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Enable the query cache within the block if Active Record is configured. If it’s not, it will execute the given block.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v7.2.3/activerecord/lib/active_record/query_cache.rb#L9-L21'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='9' data-end='21'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/query_cache.rb', line 9</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_cache'>cache</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_connected?'>connected?</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_configurations'>configurations</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_pool'>pool</span> <span class='op'>=</span> <span class='id identifier rubyid_connection_pool'>connection_pool</span>
    <span class='id identifier rubyid_was_enabled'>was_enabled</span> <span class='op'>=</span> <span class='id identifier rubyid_pool'>pool</span>.<span class='id identifier rubyid_query_cache_enabled'>query_cache_enabled</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_pool'>pool</span>.<span class='id identifier rubyid_enable_query_cache'>enable_query_cache</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
    <span class='kw'>ensure</span>
      <span class='id identifier rubyid_pool'>pool</span>.<span class='id identifier rubyid_clear_query_cache'>clear_query_cache</span> <span class='kw'>unless</span> <span class='id identifier rubyid_was_enabled'>was_enabled</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>yield</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="uncached-instance_method">
  <h3 class='signature '>
    #<strong>uncached</strong>(dirties: true, &amp;block)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Disable the query cache within the block if Active Record is configured. If it’s not, it will execute the given block.</p>

<p>Set <code>dirties: false</code> to prevent query caches on all connections from being cleared by write operations. (By default, write operations dirty all connections’ query caches in case they are replicas whose cache would now be outdated.)</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v7.2.3/activerecord/lib/active_record/query_cache.rb#L28-L34'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='28' data-end='34'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'activerecord/lib/active_record/query_cache.rb', line 28</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_uncached'>uncached</span>(<span class='label'>dirties:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>if</span> <span class='id identifier rubyid_connected?'>connected?</span> <span class='op'>||</span> <span class='op'>!</span><span class='id identifier rubyid_configurations'>configurations</span>.<span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_connection_pool'>connection_pool</span>.<span class='id identifier rubyid_disable_query_cache'>disable_query_cache</span>(<span class='label'>dirties:</span> <span class='id identifier rubyid_dirties'>dirties</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>else</span>
    <span class='kw'>yield</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>