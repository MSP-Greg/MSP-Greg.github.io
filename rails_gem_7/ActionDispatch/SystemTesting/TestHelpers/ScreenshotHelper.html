<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Module: ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper &mdash; Rails 7.2.2.2</title>

<link rel='stylesheet'  type='text/css' href='../../../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper",
    relpath = '../../../';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../../../'>Rails 7.2.2.2</a> &raquo; 
      <a href='../../../_index.html#alpha_S'>Index (S)</a> &raquo; 
        <a href="../../../ActionDispatch.html" title="ActionDispatch (module)">ActionDispatch</a> &raquo; 
        <a href="../../SystemTesting.html" title="ActionDispatch::SystemTesting (module)">SystemTesting</a> &raquo; 
        <a href="../TestHelpers.html" title="ActionDispatch::SystemTesting::TestHelpers (module)">TestHelpers</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>ScreenshotHelper&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="../../../class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='module'>
<h1>Module: ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr><td class='box_h' colspan='2'>Extension / Inclusion / Inheritance Descendants</td></tr>
    <tr><td colspan='2'>
      <div class='box_1'>Included In:</div>
      <div class='box_11'>
        <a href="../../SystemTestCase.html" title="ActionDispatch::SystemTestCase (class)"><code>::ActionDispatch::SystemTestCase</code></a>
      </div>
    </td></tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/rails/rails/blob/v7.2.2.2/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L9'>actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb</a>      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>Screenshot helper for system testing.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#take_failed_screenshot-instance_method" title="#take_failed_screenshot (instance method)">#<strong>take_failed_screenshot</strong>  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Takes a screenshot of the current page in the browser if the test failed.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#take_screenshot-instance_method" title="#take_screenshot (instance method)">#<strong>take_screenshot</strong>(html: false, screenshot: nil)  </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Takes a screenshot of the current page in the browser.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="take_failed_screenshot-instance_method">
  <h3 class='signature  first'>
    #<strong>take_failed_screenshot</strong>  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Takes a screenshot of the current page in the browser if the test failed.</p>

<p><code>take_failed_screenshot</code> is called during system test teardown.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v7.2.2.2/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L53-L58'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='53' data-end='58'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb', line 53</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_take_failed_screenshot'>take_failed_screenshot</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_failed?'>failed?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_supports_screenshot?'>supports_screenshot?</span> <span class='op'>&amp;&amp;</span> <span class='const'>Capybara</span><span class='op'>::</span><span class='const'><a href="../../Session.html" title="ActionDispatch::Session (module)">Session</a></span>.<span class='id identifier rubyid_instance_created?'>instance_created?</span>

  <span class='id identifier rubyid_take_screenshot'><a href="#take_screenshot-instance_method" title="ActionDispatch::SystemTesting::TestHelpers::ScreenshotHelper#take_screenshot (method)">take_screenshot</a></span>
  <span class='id identifier rubyid_metadata'>metadata</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_failure_screenshot_path'>failure_screenshot_path</span>] <span class='op'>=</span> <span class='id identifier rubyid_relative_image_path'>relative_image_path</span> <span class='kw'>if</span> <span class='const'><a href="../../../Minitest.html" title="Minitest (module)">Minitest</a></span><span class='op'>::</span><span class='const'>Runnable</span>.<span class='id identifier rubyid_method_defined?'>method_defined?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_metadata'>metadata</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>

<section class='method_details' id="take_screenshot-instance_method">
  <h3 class='signature '>
    #<strong>take_screenshot</strong>(html: false, screenshot: nil)  
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Takes a screenshot of the current page in the browser.</p>

<p><code>take_screenshot</code> can be used at any point in your system tests to take a screenshot of the current state. This can be useful for debugging or automating visual testing. You can take multiple screenshots per test to investigate changes at different points during your test. These will be named with a sequential prefix (or ‘failed’ for failing tests)</p>

<p>The default screenshots directory is <code>tmp/screenshots</code> but you can set a different one with <code>Capybara.save_path</code></p>

<p>You can use the <code>html</code> argument or set the <code>RAILS_SYSTEM_TESTING_SCREENSHOT_HTML</code> environment variable to save the HTML from the page that is being screenshotted so you can investigate the elements on the page at the time of the screenshot</p>

<p>You can use the <code>screenshot</code> argument or set the <code>RAILS_SYSTEM_TESTING_SCREENSHOT</code> environment variable to control the output. Possible values are:</p>

<pre class="code ruby"><code class="ruby">{<span class='id identifier rubyid_simple'>simple</span>} (<span class='id identifier rubyid_default'>default</span>)</code></pre>

<p>:       Only displays the screenshot path. This is the default value.</p>

<pre class="code ruby"><code class="ruby">{<span class='id identifier rubyid_inline'>inline</span>}</code></pre>

<p>:       Display the screenshot in the terminal using the iTerm image protocol</p>

<pre class="code ruby"><code class="ruby">    (<span class='label'>https:</span><span class='tstring'><span class='regexp_beg'>/</span><span class='regexp_end'>/iterm</span></span><span class='int'>2</span>.<span class='id identifier rubyid_com'>com</span><span class='op'>/</span><span class='id identifier rubyid_documentation'>documentation</span><span class='op'>-</span><span class='id identifier rubyid_images'>images</span>.<span class='id identifier rubyid_html'>html</span>).

{<span class='id identifier rubyid_artifact'>artifact</span>}</code></pre>

<p>:       Display the screenshot in the terminal, using the terminal artifact</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_format'>format</span> (<span class='label'>https:</span><span class='op'>/</span><span class='op'>/</span><span class='id identifier rubyid_buildkite'>buildkite</span>.<span class='id identifier rubyid_github'>github</span>.<span class='id identifier rubyid_io'>io</span><span class='op'>/</span><span class='id identifier rubyid_terminal'>terminal</span><span class='op'>-</span><span class='id identifier rubyid_to'>to</span><span class='op'>-</span><span class='id identifier rubyid_html'>html</span><span class='op'>/</span><span class='id identifier rubyid_inline'>inline</span><span class='op'>-</span><span class='id identifier rubyid_images'>images</span><span class='op'>/</span>).</code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/rails/rails/blob/v7.2.2.2/actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb#L41-L48'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='41' data-end='48'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'actionpack/lib/action_dispatch/system_testing/test_helpers/screenshot_helper.rb', line 41</span></pre>
<pre class='code ruby'>

<span class='kw'>def</span> <span class='id identifier rubyid_take_screenshot'>take_screenshot</span>(<span class='label'>html:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>screenshot:</span> <span class='kw'>nil</span>)
  <span class='id identifier rubyid_showing_html'>showing_html</span> <span class='op'>=</span> <span class='id identifier rubyid_html'>html</span> <span class='op'>||</span> <span class='id identifier rubyid_html_from_env?'>html_from_env?</span>

  <span class='id identifier rubyid_increment_unique'>increment_unique</span>
  <span class='id identifier rubyid_save_html'>save_html</span> <span class='kw'>if</span> <span class='id identifier rubyid_showing_html'>showing_html</span>
  <span class='id identifier rubyid_save_image'>save_image</span>
  <span class='id identifier rubyid_show'>show</span> <span class='id identifier rubyid_display_image'>display_image</span>(<span class='label'>html:</span> <span class='id identifier rubyid_showing_html'>showing_html</span><span class='comma'>,</span> <span class='label'>screenshot_output:</span> <span class='id identifier rubyid_screenshot'>screenshot</span>)
<span class='kw'>end</span>
</pre>
  </div>
</div>
</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>