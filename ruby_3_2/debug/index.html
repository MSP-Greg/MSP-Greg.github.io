<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: README &mdash; debug  Ruby-3.2.3 pp157</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "README",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.2.3</a> &raquo; 
      <a href='.'>debug</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: README&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>
<p><a href="https://github.com/ruby/debug/actions/workflows/ruby.yml?query=branch%3Amaster"><img src="https://github.com/ruby/debug/actions/workflows/ruby.yml/badge.svg?branch=master" alt="Ruby"></a> <a href="https://github.com/ruby/debug/actions/workflows/protocol.yml"><img src="https://github.com/ruby/debug/actions/workflows/protocol.yml/badge.svg" alt="Protocol"></a></p>

<h1>debug.rb</h1>

<p>This library provides debugging functionality to Ruby (MRI) 2.6 and later.</p>

<p>This debug.rb is replacement of traditional lib/debug.rb standard library which is implemented by <code>set_trace_func</code>.
New debug.rb has several advantages:</p>

<ul>
<li>Fast: No performance penalty on non-stepping mode and non-breakpoints.</li>
<li><p><a href="#remote-debugging">Remote debugging</a>: Support remote debugging natively.</p>

<ul>
<li>UNIX domain socket (UDS)</li>
<li>TCP/IP</li>
<li>Integration with rich debugger frontends</li>
</ul>

<table><thead>
<tr>
<th>Frontend</th>
<th><a href="https://github.com/ruby/debug#invoke-as-a-remote-debuggee">Console</a></th>
<th><a href="https://github.com/ruby/debug#vscode-integration">VSCode</a></th>
<th><a href="#chrome-devtool-integration">Chrome DevTool</a></th>
</tr>
</thead><tbody>
<tr>
<td>Connection</td>
<td>UDS, TCP/IP</td>
<td>UDS, TCP/IP</td>
<td>TCP/IP</td>
</tr>
<tr>
<td>Requirement</td>
<td>No</td>
<td><a href="https://marketplace.visualstudio.com/items?itemName=KoichiSasada.vscode-rdbg">vscode-rdbg</a></td>
<td>Chrome</td>
</tr>
</tbody></table></li>
<li><p>Extensible: application can introduce debugging support with several ways:</p>

<ul>
<li>By <code>rdbg</code> command</li>
<li>By loading libraries with <code>-r</code> command line option</li>
<li>By calling Ruby&#39;s method explicitly</li>
</ul></li>
<li><p>Misc</p>

<ul>
<li>Support threads (almost done) and ractors (TODO).</li>
<li>Support suspending and entering to the console debugging with <code>Ctrl-C</code> at most of timing.</li>
<li>Show parameters on backtrace command.</li>
<li>Support recording &amp; reply debugging.</li>
</ul></li>
</ul>

<h1>Installation</h1>

<pre class="code ruby"><code class="ruby">$ gem install debug</code></pre>

<p>or specify <code>-Ipath/to/debug/lib</code> in <code>RUBYOPT</code> or each ruby command-line option, especially for debug this gem development.</p>

<p>If you use Bundler, write the following line to your Gemfile.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>debug</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&gt;= 1.0.0</span><span class='tstring_end'>&quot;</span></span></code></pre>

<p>(The version constraint is important; <code>debug &lt; 1.0.0</code> is an older,
abandoned gem that is completely different from this product.)</p>

<h1>HOW TO USE</h1>

<p>To use a debugger, roughly you will do the following steps:</p>

<ol>
<li>Set breakpoints.</li>
<li>Run a program with the debugger.</li>
<li>At the breakpoint, enter the debugger console.</li>
<li>Use debug commands.

<ul>
<li><a href="#evaluate">Evaluate Ruby expressions</a> (e.g. <code>p lvar</code> to see the local variable <code>lvar</code>).</li>
<li><a href="#information">Query the program status</a> (e.g. <code>info</code> to see information about the current frame).</li>
<li><a href="#control-flow">Control program flow</a> (e.g. move to the another line with <code>step</code>, to the next line with <code>next</code>).</li>
<li><a href="#breakpoint">Set another breakpoint</a> (e.g. <code>catch Exception</code> to set a breakpoint that&#39;ll be triggered when <code>Exception</code> is raised).</li>
<li><a href="#trace">Activate tracing in your program</a> (e.g. <code>trace call</code> to trace method calls).</li>
<li><a href="#configuration-1">Change the configuration</a> (e.g. <code>config set no_color true</code> to disable coloring).</li>
<li>Continue the program (<code>c</code> or <code>continue</code>) and goto 3.</li>
</ul></li>
</ol>

<h2>Invoke with the debugger</h2>

<p>There are several options for (1) and (2). Please choose your favorite way.</p>

<h3>Modify source code with <a href="#bindingbreak-method"><code>binding.break</code></a> (similar to <code>binding.pry</code> or <code>binding.irb</code>)</h3>

<p>If you can modify the source code, you can use the debugger by adding <code>require &#39;debug&#39;</code> at the top of your program and putting <a href="#bindingbreak-method"><code>binding.break</code></a> method into lines where you want to stop as breakpoints like <code>binding.pry</code> and <code>binding.irb</code>.</p>

<p>You can also use its 2 aliases in the same way:</p>

<ul>
<li><code>binding.b</code></li>
<li><code>debugger</code></li>
</ul>

<p>After that, run the program as usual and you will enter the debug console at breakpoints you inserted.</p>

<p>The following example shows the demonstration of <a href="#bindingbreak-method"><code>binding.break</code></a>.</p>

<pre class="code shell"><code class="shell">$ cat target.rb                        # Sample program
require &#39;debug&#39;

a = 1
b = 2
binding.break                          # Program will stop here
c = 3
d = 4
binding.break                          # Program will stop here
p [a, b, c, d]

$ ruby target.rb                       # Run the program normally.
DEBUGGER: Session start (pid: 7604)
[1, 10] in target.rb
      1| require &#39;debug&#39;
      2|
      3| a = 1
      4| b = 2
=&gt;    5| binding.break                 # Now you can see it stops at this line
      6| c = 3
      7| d = 4
      8| binding.break
      9| p [a, b, c, d]
     10|
=&gt;#0    &lt;main&gt; at target.rb:5

(rdbg) info locals                     # You can show local variables
=&gt;#0    &lt;main&gt; at target.rb:5
%self =&gt; main
a =&gt; 1
b =&gt; 2
c =&gt; nil
d =&gt; nil

(rdbg) continue                        # Continue the execution
[3, 11] in target.rb
      3| a = 1
      4| b = 2
      5| binding.break
      6| c = 3
      7| d = 4
=&gt;    8| binding.break                 # Again the program stops here
      9| p [a, b, c, d]
     10|
     11| __END__
=&gt;#0    &lt;main&gt; at target.rb:8

(rdbg) info locals                     # And you can see the updated local variables
=&gt;#0    &lt;main&gt; at target.rb:8
%self =&gt; main
a =&gt; 1
b =&gt; 2
c =&gt; 3
d =&gt; 4

(rdbg) continue
[1, 2, 3, 4]
</code></pre>

<h3>Invoke the program from the debugger as a traditional debuggers</h3>

<p>If you don&#39;t want to modify the source code, you can set breakpoints with a debug command <code>break</code> (<code>b</code> for short).
Using <code>rdbg</code> command (or <code>bundle exec rdbg</code>) to launch the program without any modifications, you can run the program with the debugger.</p>

<pre class="code shell"><code class="shell">$ cat target.rb                        # Sample program
a = 1
b = 2
c = 3
d = 4
p [a, b, c, d]

$ rdbg target.rb                       # run like `ruby target.rb`
DEBUGGER: Session start (pid: 7656)
[1, 7] in target.rb
=&gt;    1| a = 1
      2| b = 2
      3| c = 3
      4| d = 4
      5| p [a, b, c, d]
      6|
      7| __END__
=&gt;#0    &lt;main&gt; at target.rb:1

(rdbg)
</code></pre>

<p><code>rdbg</code> command suspends the program at the beginning of the given script (<code>target.rb</code> in this case) and you can use debug commands. <code>(rdbg)</code> is prompt. Let&#39;s set breakpoints on line 3 and line 5 with <code>break</code> command (<code>b</code> for short).</p>

<pre class="code shell"><code class="shell">(rdbg) break 3                         # set breakpoint at line 3
#0  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:3 (line)

(rdbg) b 5                             # set breakpoint at line 5
#1  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:5 (line)

(rdbg) break                           # show all registered breakpoints
#0  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:3 (line)
#1  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:5 (line)
</code></pre>

<p>You can see that two breakpoints are registered. Let&#39;s continue the program by <code>continue</code> command.</p>

<pre class="code shell"><code class="shell">(rdbg) continue
[1, 7] in target.rb
      1| a = 1
      2| b = 2
=&gt;    3| c = 3
      4| d = 4
      5| p [a, b, c, d]
      6|
      7| __END__
=&gt;#0    &lt;main&gt; at target.rb:3

Stop by #0  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:3 (line)

(rdbg)
</code></pre>

<p>You can see that we can stop at line 3.
Let&#39;s see the local variables with <code>info</code> command, and continue.
You can also confirm that the program will suspend at line 5 and you can use <code>info</code> command again.</p>

<pre class="code shell"><code class="shell">(rdbg) info
=&gt;#0    &lt;main&gt; at target.rb:3
%self =&gt; main
a =&gt; 1
b =&gt; 2
c =&gt; nil
d =&gt; nil

(rdbg) continue
[1, 7] in target.rb
      1| a = 1
      2| b = 2
      3| c = 3
      4| d = 4
=&gt;    5| p [a, b, c, d]
      6|
      7| __END__
=&gt;#0    &lt;main&gt; at target.rb:5

Stop by #1  BP - Line  /mnt/c/ko1/src/rb/ruby-debug/target.rb:5 (line)

(rdbg) info
=&gt;#0    &lt;main&gt; at target.rb:5
%self =&gt; main
a =&gt; 1
b =&gt; 2
c =&gt; 3
d =&gt; 4

(rdbg) continue
[1, 2, 3, 4]
</code></pre>

<p>By the way, using <code>rdbg</code> command you can suspend your application with <code>C-c</code> (SIGINT) and enter the debug console.
It will help that if you want to know what the program is doing.</p>

<h3>Use <code>rdbg</code> with commands written in Ruby</h3>

<p>If you want to run a command written in Ruby like like <code>rake</code>, <code>rails</code>, <code>bundle</code>, <code>rspec</code> and so on, you can use <code>rdbg -c</code> option.</p>

<ul>
<li>Without <code>-c</code> option, <code>rdbg &lt;name&gt;</code> means that <code>&lt;name&gt;</code> is Ruby script and invoke it like <code>ruby &lt;name&gt;</code> with the debugger.</li>
<li>With <code>-c</code> option, <code>rdbg -c &lt;name&gt;</code> means that <code>&lt;name&gt;</code> is command in <code>PATH</code> and simply invoke it with the debugger.</li>
</ul>

<p>Examples:</p>

<ul>
<li><code>rdbg -c -- rails server</code></li>
<li><code>rdbg -c -- bundle exec ruby foo.rb</code></li>
<li><code>rdbg -c -- bundle exec rake test</code></li>
<li><code>rdbg -c -- ruby target.rb</code> is same as <code>rdbg target.rb</code></li>
</ul>

<p>NOTE: <code>--</code> is needed to separate the command line options for <code>rdbg</code> and invoking command. For example, <code>rdbg -c rake -T</code> is recognized like <code>rdbg -c -T -- rake</code>. It should be <code>rdbg -c -- rake -T</code>.</p>

<p>NOTE: If you want to use bundler (<code>bundle</code> command), you need to write <code>gem debug</code> line in your <code>Gemfile</code>.</p>

<h3>Using VSCode</h3>

<p>Like other languages, you can use this debugger on the VSCode.</p>

<ol>
<li>Install <a href="https://marketplace.visualstudio.com/items?itemName=KoichiSasada.vscode-rdbg">VSCode rdbg Ruby Debugger - Visual Studio Marketplace</a></li>
<li>Open <code>.rb</code> file (e.g. <code>target.rb</code>)</li>
<li>Register breakpoints with &quot;Toggle breakpoint&quot; in Run menu (or type F9 key)</li>
<li>Choose &quot;Start debugging&quot; in &quot;Run&quot; menu (or type F5 key)</li>
<li>You will see a dialog &quot;Debug command line&quot; and you can choose your favorite command line your want to run.</li>
<li>Chosen command line is invoked with <code>rdbg -c</code> and VSCode shows the details at breakpoints.</li>
</ol>

<p>Please refer <a href="https://code.visualstudio.com/docs/editor/debugging">Debugging in Visual Studio Code</a> for operations on VSCode.</p>

<p>You can configure the extension in <code>.vscode/launch.json</code>.
Please see the extension page for more details.</p>

<h2>Remote debugging</h2>

<p>You can use this debugger as a remote debugger. For example, it will help the following situations:</p>

<ul>
<li>Your application does not run on TTY and it is hard to use <code>binding.pry</code> or <code>binding.irb</code>.

<ul>
<li>Your application is running on Docker container and there is no TTY.</li>
<li>Your application is running as a daemon.</li>
<li>Your application uses pipe for STDIN or STDOUT.</li>
</ul></li>
<li>Your application is running as a daemon and you want to query the running status (checking a backtrace and so on).</li>
</ul>

<p>You can run your application as a remote debuggee and the remote debugger console can attach to the debuggee anytime.</p>

<h3>Invoke as a remote debuggee</h3>

<p>There are multiple ways to run your program as a debuggee:</p>

<table><thead>
<tr>
<th>Stop at program start</th>
<th><a href="https://github.com/ruby/debug#rdbg---open-or-rdbg--o-for-short"><code>rdbg</code> option</a></th>
<th><a href="https://github.com/ruby/debug#require-debugopen-in-a-program">require</a></th>
<th><a href="https://github.com/ruby/debug#start-by-method">debugger API</a></th>
</tr>
</thead><tbody>
<tr>
<td>Yes</td>
<td><code>rdbg --open</code></td>
<td><code>require &quot;debug/open&quot;</code></td>
<td><a href="DEBUGGER__.html#open-class_method" title="DEBUGGER__.open (method)">DEBUGGER__.open</a></td>
</tr>
<tr>
<td>No</td>
<td><code>rdbg --open --nonstop</code></td>
<td><code>require &quot;debug/open_nonstop&quot;</code></td>
<td><code>DEBUGGER__.open(nonstop: true)</code></td>
</tr>
</tbody></table>

<h4><code>rdbg --open</code> (or <code>rdbg -O</code> for short)</h4>

<p>You can run a script with <code>rdbg --open target.rb</code> command and run a <code>target.rb</code> as a debuggee program. It also opens the network port and suspends at the beginning of <code>target.rb</code>.</p>

<pre class="code shell"><code class="shell">$ exe/rdbg --open target.rb
DEBUGGER: Session start (pid: 7773)
DEBUGGER: Debugger can attach via UNIX domain socket (/home/ko1/.ruby-debug-sock/ruby-debug-ko1-7773)
DEBUGGER: wait for debugger connection...
</code></pre>

<p>By default, <code>rdbg --open</code> uses UNIX domain socket and generates path name automatically (<code>/home/ko1/.ruby-debug-sock/ruby-debug-ko1-7773</code> in this case).</p>

<p>You can connect to the debuggee with <code>rdbg --attach</code> command (<code>rdbg -A</code> for short).</p>

<pre class="code shell"><code class="shell">$ rdbg -A
[1, 7] in target.rb
=&gt;    1| a = 1
      2| b = 2
      3| c = 3
      4| d = 4
      5| p [a, b, c, d]
      6|
      7| __END__
=&gt;#0    &lt;main&gt; at target.rb:1

(rdbg:remote)
</code></pre>

<p>If there is no other opening ports on the default directory, <code>rdbg --attach</code> command chooses the only one opening UNIX domain socket and connect to it. If there are more files, you need to specify the file.</p>

<p>When <code>rdbg --attach</code> connects to the debuggee, you can use any debug commands (set breakpoints, continue the program and so on) like local debug console. When an debuggee program exits, the remote console will also terminate.</p>

<p>NOTE: If you use <code>quit</code> command, only remote console exits and the debuggee program continues to run (and you can connect it again). If you want to exit the debuggee program, use <code>kill</code> command.</p>

<p>If you want to use TCP/IP for the remote debugging, you need to specify the port and host with <code>--port</code> like <code>rdbg --open --port 12345</code> and it binds to <code>localhost:12345</code>.</p>

<p>To connect to the debuggee, you need to specify the port.</p>

<pre class="code shell"><code class="shell">$ rdbg --attach 12345
</code></pre>

<p>If you want to choose the host to bind, you can use <code>--host</code> option.
Note that all messages communicated between the debugger and the debuggee are <em>NOT</em> encrypted so please use remote debugging carefully.</p>

<h4><code>require &#39;debug/open&#39;</code> in a program</h4>

<p>If you can modify the program, you can open debugging port by adding <code>require &#39;debug/open&#39;</code> line in the program.</p>

<p>If you don&#39;t want to stop the program at the beginning, you can also use <code>require &#39;debug/open_nonstop&#39;</code>.
Using <code>debug/open_nonstop</code> is useful if you want to open a backdoor to the application.
However, it is also danger because it can become another vulnerability.
Please use it carefully.</p>

<p>By default, UNIX domain socket is used for the debugging port. To use TCP/IP, you can set the <code>RUBY_DEBUG_PORT</code> environment variable.</p>

<pre class="code shell"><code class="shell">$ RUBY_DEBUG_PORT=12345 ruby target.rb
</code></pre>

<h3>Integration with external debugger frontend</h3>

<p>You can attach with external debugger frontend with VSCode and Chrome.</p>

<pre class="code ruby"><code class="ruby">$ rdbg --open=[frontend] target.rb</code></pre>

<p>will open a debug port and <code>[frontend]</code> can attach to the port.</p>

<p>Also <code>open</code> command allows opening the debug port.</p>

<h4>VSCode integration</h4>

<p>(<a href="https://marketplace.visualstudio.com/items?itemName=KoichiSasada.vscode-rdbg">vscode-rdbg v0.0.9</a> or later is required)</p>

<p>If you don&#39;t run a debuggee Ruby process on VSCode, you can attach with VSCode later with the following steps.</p>

<p><code>rdbg --open=vscode</code> opens the debug port and tries to invoke the VSCode (<code>code</code> command).</p>

<pre class="code ruby"><code class="ruby">$ rdbg --open=vscode target.rb
DEBUGGER: Debugger can attach via UNIX domain socket (/tmp/ruby-debug-sock-1000/ruby-debug-ko1-27706)
DEBUGGER: wait for debugger connection...
Launching: code /tmp/ruby-debug-vscode-20211014-27706-gd7e85/ /tmp/ruby-debug-vscode-20211014-27706-gd7e85/README.rb
DEBUGGER: Connected.</code></pre>

<p>And it tries to invoke the new VSCode window and VSCode starts attaching to the debuggee Ruby program automatically.</p>

<p>You can also use <code>open vscode</code> command in REPL.</p>

<pre class="code ruby"><code class="ruby">$ rdbg target.rb
[1, 8] in target.rb
     1|
#=&gt;   2| p a = 1
     3| p b = 2
     4| p c = 3
     5| p d = 4
     6| p e = 5
     7|
     8| __END__
=&gt;#0    &lt;main&gt; at target.rb:2
(rdbg) open vscode    # command
DEBUGGER: wait for debugger connection...
DEBUGGER: Debugger can attach via UNIX domain socket (/tmp/ruby-debug-sock-1000/ruby-debug-ko1-28337)
Launching: code /tmp/ruby-debug-vscode-20211014-28337-kg9dm/ /tmp/ruby-debug-vscode-20211014-28337-kg9dm/README.rb
DEBUGGER: Connected.</code></pre>

<p>If the machine which runs the Ruby process doesn&#39;t have a <code>code</code> command, the following message will be shown:</p>

<pre class="code ruby"><code class="ruby">(rdbg) open vscode
DEBUGGER: wait for debugger connection...
DEBUGGER: Debugger can attach via UNIX domain socket (/tmp/ruby-debug-sock-1000/ruby-debug-ko1-455)
Launching: code /tmp/ruby-debug-vscode-20211014-455-gtjpwi/ /tmp/ruby-debug-vscode-20211014-455-gtjpwi/README.rb
DEBUGGER: Can not invoke the command.
Use the command-line on your terminal (with modification if you need).

  code /tmp/ruby-debug-vscode-20211014-455-gtjpwi/ /tmp/ruby-debug-vscode-20211014-455-gtjpwi/README.rb

If your application is running on a SSH remote host, please try:

  code --remote ssh-remote+[SSH hostname] /tmp/ruby-debug-vscode-20211014-455-gtjpwi/ /tmp/ruby-debug-vscode-20211014-455-gtjpwi/README.rb</code></pre>

<p>and try to use proposed commands.</p>

<p>Note that you can attach with <code>rdbg --attach</code> and continue REPL debugging.</p>

<h4>Chrome DevTool integration</h4>

<p>With <code>rdbg --open=chrome</code> command will show the following message.</p>

<pre class="code ruby"><code class="ruby">$ rdbg target.rb --open=chrome
DEBUGGER: Debugger can attach via TCP/IP (127.0.0.1:43633)
DEBUGGER: With Chrome browser, type the following URL in the address-bar:

   devtools://devtools/bundled/inspector.html?v8only=true&amp;panel=sources&amp;ws=127.0.0.1:57231/b32a55cd-2eb5-4c5c-87d8-b3dfc59d80ef

DEBUGGER: wait for debugger connection...</code></pre>

<p>Type <code>devtools://devtools/bundled/inspector.html?v8only=true&amp;panel=sources&amp;ws=127.0.0.1:57231/b32a55cd-2eb5-4c5c-87d8-b3dfc59d80ef</code> in the address-bar on Chrome browser, and you can continue the debugging with chrome browser.</p>

<p>Also <code>open chrome</code> command works like <code>open vscode</code>.</p>

<p>For more information about how to use Chrome debugging, you might want to read <a href="https://developer.chrome.com/docs/devtools/">here</a>.</p>

<h2>Configuration</h2>

<p>You can configure the debugger&#39;s behavior with debug commands and environment variables.
When the debug session is started, initial scripts are loaded so you can put your favorite configurations in the initial scripts.</p>

<h3>Configuration list</h3>

<p>You can configure debugger&#39;s behavior with environment variables and <code>config</code> command. Each configuration has environment variable and the name which can be specified by <code>config</code> command.</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># configuration example
</span><span class='id identifier rubyid_config'>config</span> <span class='id identifier rubyid_set'>set</span> <span class='id identifier rubyid_log_level'>log_level</span> <span class='const'>INFO</span>
<span class='id identifier rubyid_config'>config</span> <span class='id identifier rubyid_set'>set</span> <span class='id identifier rubyid_no_color'>no_color</span> <span class='kw'>true</span></code></pre>

<ul>
<li><p>UI</p>

<ul>
<li><code>RUBY_DEBUG_LOG_LEVEL</code> (<code>log_level</code>): Log level same as Logger (default: WARN)</li>
<li><code>RUBY_DEBUG_SHOW_SRC_LINES</code> (<code>show_src_lines</code>): Show n lines source code on breakpoint (default: 10)</li>
<li><code>RUBY_DEBUG_SHOW_EVALEDSRC</code> (<code>show_evaledsrc</code>): Show actually evaluated source (default: false)</li>
<li><code>RUBY_DEBUG_SHOW_FRAMES</code> (<code>show_frames</code>): Show n frames on breakpoint (default: 2)</li>
<li><code>RUBY_DEBUG_USE_SHORT_PATH</code> (<code>use_short_path</code>): Show shorten PATH (like $(Gem)/foo.rb) (default: false)</li>
<li><code>RUBY_DEBUG_NO_COLOR</code> (<code>no_color</code>): Do not use colorize (default: false)</li>
<li><code>RUBY_DEBUG_NO_SIGINT_HOOK</code> (<code>no_sigint_hook</code>): Do not suspend on SIGINT (default: false)</li>
<li><code>RUBY_DEBUG_NO_RELINE</code> (<code>no_reline</code>): Do not use Reline library (default: false)</li>
<li><code>RUBY_DEBUG_NO_HINT</code> (<code>no_hint</code>): Do not show the hint on the REPL (default: false)</li>
</ul></li>
<li><p>CONTROL</p>

<ul>
<li><code>RUBY_DEBUG_SKIP_PATH</code> (<code>skip_path</code>): Skip showing/entering frames for given paths</li>
<li><code>RUBY_DEBUG_SKIP_NOSRC</code> (<code>skip_nosrc</code>): Skip on no source code lines (default: false)</li>
<li><code>RUBY_DEBUG_KEEP_ALLOC_SITE</code> (<code>keep_alloc_site</code>): Keep allocation site and p, pp shows it (default: false)</li>
<li><code>RUBY_DEBUG_POSTMORTEM</code> (<code>postmortem</code>): Enable postmortem debug (default: false)</li>
<li><code>RUBY_DEBUG_FORK_MODE</code> (<code>fork_mode</code>): Control which process activates a debugger after fork (both/parent/child) (default: both)</li>
<li><code>RUBY_DEBUG_SIGDUMP_SIG</code> (<code>sigdump_sig</code>): Sigdump signal (default: false)</li>
</ul></li>
<li><p>BOOT</p>

<ul>
<li><code>RUBY_DEBUG_NONSTOP</code> (<code>nonstop</code>): Nonstop mode (default: false)</li>
<li><code>RUBY_DEBUG_STOP_AT_LOAD</code> (<code>stop_at_load</code>): Stop at just loading location (default: false)</li>
<li><code>RUBY_DEBUG_INIT_SCRIPT</code> (<code>init_script</code>): debug command script path loaded at first stop</li>
<li><code>RUBY_DEBUG_COMMANDS</code> (<code>commands</code>): debug commands invoked at first stop. Commands should be separated by <code>;;</code></li>
<li><code>RUBY_DEBUG_NO_RC</code> (<code>no_rc</code>): ignore loading ~/.rdbgrc(.rb) (default: false)</li>
<li><code>RUBY_DEBUG_HISTORY_FILE</code> (<code>history_file</code>): history file (default: ~/.rdbg_history)</li>
<li><code>RUBY_DEBUG_SAVE_HISTORY</code> (<code>save_history</code>): maximum save history lines (default: 10000)</li>
</ul></li>
<li><p>REMOTE</p>

<ul>
<li><code>RUBY_DEBUG_OPEN</code> (<code>open</code>): Open remote port (same as <code>rdbg --open</code> option)</li>
<li><code>RUBY_DEBUG_PORT</code> (<code>port</code>): TCP/IP remote debugging: port</li>
<li><code>RUBY_DEBUG_HOST</code> (<code>host</code>): TCP/IP remote debugging: host (default: 127.0.0.1)</li>
<li><code>RUBY_DEBUG_SOCK_PATH</code> (<code>sock_path</code>): UNIX Domain Socket remote debugging: socket path</li>
<li><code>RUBY_DEBUG_SOCK_DIR</code> (<code>sock_dir</code>): UNIX Domain Socket remote debugging: socket directory</li>
<li><code>RUBY_DEBUG_LOCAL_FS_MAP</code> (<code>local_fs_map</code>): Specify local fs map</li>
<li><code>RUBY_DEBUG_SKIP_BP</code> (<code>skip_bp</code>): Skip breakpoints if no clients are attached (default: false)</li>
<li><code>RUBY_DEBUG_COOKIE</code> (<code>cookie</code>): Cookie for negotiation</li>
<li><code>RUBY_DEBUG_CHROME_PATH</code> (<code>chrome_path</code>): Platform dependent path of Chrome (For more information, See <a href="https://github.com/ruby/debug/pull/334/files#diff-5fc3d0a901379a95bc111b86cf0090b03f857edfd0b99a0c1537e26735698453R55-R64">here</a>)</li>
</ul></li>
<li><p>OBSOLETE</p>

<ul>
<li><code>RUBY_DEBUG_PARENT_ON_FORK</code> (<code>parent_on_fork</code>): Keep debugging parent process on fork (default: false)</li>
</ul></li>
</ul>

<p>There are other environment variables:</p>

<ul>
<li><code>NO_COLOR</code>: If the value is set, set <code>RUBY_DEBUG_NO_COLOR</code> (<a href="https://no-color.org/">NO_COLOR: disabling ANSI color output in various Unix commands</a>).</li>
<li><code>RUBY_DEBUG_ENABLE</code>: If the value is <code>0</code>, do not enable debug.gem feature.</li>
<li><code>RUBY_DEBUG_ADDED_RUBYOPT</code>: Remove this value from <code>RUBYOPT</code> at first. This feature helps loading debug.gem with <code>RUBYOPT=&#39;-r debug/...&#39;</code> and you don&#39;t want to derive it to child processes. In this case you can set <code>RUBY_DEBUG_ADDED_RUBYOPT=&#39;-r debug/...&#39;</code> (same value) and this string will be deleted from <code>RUBYOPT</code> at first.</li>
<li><code>RUBY_DEBUG_EDITOR</code> or <code>EDITOR</code>: An editor used by <code>edit</code> debug command.</li>
<li><code>RUBY_DEBUG_BB</code>: Define <a href="Kernel.html#bb-instance_method" title="Kernel#bb (method)">Kernel#bb</a> method which is alias of <a href="Kernel.html#debugger-instance_method" title="Kernel#debugger (method)">Kernel#debugger</a>.</li>
</ul>

<h3>Initial scripts</h3>

<p>If there is <code>~/.rdbgrc</code>, the file is loaded as an initial script (which contains debug commands) when the debug session is started.</p>

<ul>
<li><code>RUBY_DEBUG_INIT_SCRIPT</code> environment variable can specify the initial script file.</li>
<li>You can specify the initial script with <code>rdbg -x initial_script</code> (like gdb&#39;s <code>-x</code> option).</li>
</ul>

<p>Initial scripts are useful to write your favorite configurations.
For example, you can set break points with <code>break file:123</code> in <code>~/.rdbgrc</code>.</p>

<p>If there are <code>~/.rdbgrc.rb</code> is available, it is also loaded as a ruby script at same timing.</p>

<h2>Debug command on the debug console</h2>

<p>On the debug console, you can use the following debug commands.</p>

<p>There are additional features:</p>

<ul>
<li><code>&lt;expr&gt;</code> without debug command is almost same as <code>pp &lt;expr&gt;</code>.

<ul>
<li>If the input line <code>&lt;expr&gt;</code> does <em>NOT</em> start with any debug command, the line <code>&lt;expr&gt;</code> will be evaluated as a Ruby expression and the result will be printed with <code>pp</code> method. So that the input <code>foo.bar</code> is same as <code>pp foo.bar</code>.</li>
<li>If <code>&lt;expr&gt;</code> is recognized as a debug command, of course it is not evaluated as a Ruby expression, but is executed as debug command. For example, you can not evaluate such single letter local variables <code>i</code>, <code>b</code>, <code>n</code>, <code>c</code> because they are single letter debug commands. Use <code>p i</code> instead.</li>
<li>So the author (Koichi Sasada) recommends to use <code>p</code>, <code>pp</code> or <code>eval</code> command to evaluate the Ruby expression everytime.</li>
</ul></li>
<li><code>Enter</code> without any input repeats the last command (useful when repeating <code>step</code>s) for some commands.</li>
<li><code>Ctrl-D</code> is equal to <code>quit</code> command.</li>
<li><a href="https://docs.google.com/spreadsheets/d/1TlmmUDsvwK4sSIyoMv-io52BUUz__R5wpu-ComXlsw0/edit?usp=sharing">debug command compare sheet - Google Sheets</a></li>
</ul>

<p>You can use the following debug commands. Each command should be written in 1 line.
The <code>[...]</code> notation means this part can be eliminate. For example, <code>s[tep]</code> means <code>s</code> or <code>step</code> are valid command. <code>ste</code> is not valid.
The <code>&lt;...&gt;</code> notation means the argument.</p>

<h3>Control flow</h3>

<ul>
<li><code>s[tep]</code>

<ul>
<li>Step in. Resume the program until next breakable point.</li>
</ul></li>
<li><code>s[tep] &lt;n&gt;</code>

<ul>
<li>Step in, resume the program at <code>&lt;n&gt;</code>th breakable point.</li>
</ul></li>
<li><code>n[ext]</code>

<ul>
<li>Step over. Resume the program until next line.</li>
</ul></li>
<li><code>n[ext] &lt;n&gt;</code>

<ul>
<li>Step over, same as <code>step &lt;n&gt;</code>.</li>
</ul></li>
<li><code>fin[ish]</code>

<ul>
<li>Finish this frame. Resume the program until the current frame is finished.</li>
</ul></li>
<li><code>fin[ish] &lt;n&gt;</code>

<ul>
<li>Finish <code>&lt;n&gt;</code>th frames.</li>
</ul></li>
<li><code>u[ntil]</code>

<ul>
<li>Similar to <code>next</code> command, but only stop later lines or the end of the current frame.</li>
<li>Similar to gdb&#39;s <code>advance</code> command.</li>
</ul></li>
<li>`u[ntil] &lt;[file:]line&gt;

<ul>
<li>Run til the program reaches given location or the end of the current frame.</li>
</ul></li>
<li>`u[ntil] <name>

<ul>
<li>Run til the program invokes a method <code>&lt;name&gt;</code>. <code>&lt;name&gt;</code> can be a regexp with <code>/name/</code>.</li>
</ul></li>
<li><code>c</code> or <code>cont</code> or <code>continue</code>

<ul>
<li>Resume the program.</li>
</ul></li>
<li><code>q[uit]</code> or <code>Ctrl-D</code>

<ul>
<li>Finish debugger (with the debuggee process on non-remote debugging).</li>
</ul></li>
<li><code>q[uit]!</code>

<ul>
<li>Same as q[uit] but without the confirmation prompt.</li>
</ul></li>
<li><code>kill</code>

<ul>
<li>Stop the debuggee process with <code>Kernel#exit!</code>.</li>
</ul></li>
<li><code>kill!</code>

<ul>
<li>Same as kill but without the confirmation prompt.</li>
</ul></li>
<li><code>sigint</code>

<ul>
<li>Execute SIGINT handler registered by the debuggee.</li>
<li>Note that this command should be used just after stop by <code>SIGINT</code>.</li>
</ul></li>
</ul>

<h3>Breakpoint</h3>

<ul>
<li><code>b[reak]</code>

<ul>
<li>Show all breakpoints.</li>
</ul></li>
<li><code>b[reak] &lt;line&gt;</code>

<ul>
<li>Set breakpoint on <code>&lt;line&gt;</code> at the current frame&#39;s file.</li>
</ul></li>
<li><code>b[reak] &lt;file&gt;:&lt;line&gt;</code> or <code>&lt;file&gt; &lt;line&gt;</code>

<ul>
<li>Set breakpoint on <code>&lt;file&gt;:&lt;line&gt;</code>.</li>
</ul></li>
<li><code>b[reak] &lt;class&gt;#&lt;name&gt;</code>

<ul>
<li>Set breakpoint on the method <code>&lt;class&gt;#&lt;name&gt;</code>.</li>
</ul></li>
<li><code>b[reak] &lt;expr&gt;.&lt;name&gt;</code>

<ul>
<li>Set breakpoint on the method <code>&lt;expr&gt;.&lt;name&gt;</code>.</li>
</ul></li>
<li><code>b[reak] ... if: &lt;expr&gt;</code>

<ul>
<li>break if <code>&lt;expr&gt;</code> is true at specified location.</li>
</ul></li>
<li><code>b[reak] ... pre: &lt;command&gt;</code>

<ul>
<li>break and run <code>&lt;command&gt;</code> before stopping.</li>
</ul></li>
<li><code>b[reak] ... do: &lt;command&gt;</code>

<ul>
<li>break and run <code>&lt;command&gt;</code>, and continue.</li>
</ul></li>
<li><code>b[reak] ... path: &lt;path&gt;</code>

<ul>
<li>break if the path matches to <code>&lt;path&gt;</code>. <code>&lt;path&gt;</code> can be a regexp with <code>/regexp/</code>.</li>
</ul></li>
<li><code>b[reak] if: &lt;expr&gt;</code>

<ul>
<li>break if: <code>&lt;expr&gt;</code> is true at any lines.</li>
<li>Note that this feature is super slow.</li>
</ul></li>
<li><code>catch &lt;Error&gt;</code>

<ul>
<li>Set breakpoint on raising <code>&lt;Error&gt;</code>.</li>
</ul></li>
<li><code>catch ... if: &lt;expr&gt;</code>

<ul>
<li>stops only if <code>&lt;expr&gt;</code> is true as well.</li>
</ul></li>
<li><code>catch ... pre: &lt;command&gt;</code>

<ul>
<li>runs <code>&lt;command&gt;</code> before stopping.</li>
</ul></li>
<li><code>catch ... do: &lt;command&gt;</code>

<ul>
<li>stops and run <code>&lt;command&gt;</code>, and continue.</li>
</ul></li>
<li><code>catch ... path: &lt;path&gt;</code>

<ul>
<li>stops if the exception is raised from a <code>&lt;path&gt;</code>. <code>&lt;path&gt;</code> can be a regexp with <code>/regexp/</code>.</li>
</ul></li>
<li><code>watch @ivar</code>

<ul>
<li>Stop the execution when the result of current scope&#39;s <code>@ivar</code> is changed.</li>
<li>Note that this feature is super slow.</li>
</ul></li>
<li><code>watch ... if: &lt;expr&gt;</code>

<ul>
<li>stops only if <code>&lt;expr&gt;</code> is true as well.</li>
</ul></li>
<li><code>watch ... pre: &lt;command&gt;</code>

<ul>
<li>runs <code>&lt;command&gt;</code> before stopping.</li>
</ul></li>
<li><code>watch ... do: &lt;command&gt;</code>

<ul>
<li>stops and run <code>&lt;command&gt;</code>, and continue.</li>
</ul></li>
<li><code>watch ... path: &lt;path&gt;</code>

<ul>
<li>stops if the path matches <code>&lt;path&gt;</code>. <code>&lt;path&gt;</code> can be a regexp with <code>/regexp/</code>.</li>
</ul></li>
<li><code>del[ete]</code>

<ul>
<li>delete all breakpoints.</li>
</ul></li>
<li><code>del[ete] &lt;bpnum&gt;</code>

<ul>
<li>delete specified breakpoint.</li>
</ul></li>
</ul>

<h3>Information</h3>

<ul>
<li><code>bt</code> or <code>backtrace</code>

<ul>
<li>Show backtrace (frame) information.</li>
</ul></li>
<li><code>bt &lt;num&gt;</code> or <code>backtrace &lt;num&gt;</code>

<ul>
<li>Only shows first <code>&lt;num&gt;</code> frames.</li>
</ul></li>
<li><code>bt /regexp/</code> or <code>backtrace /regexp/</code>

<ul>
<li>Only shows frames with method name or location info that matches <code>/regexp/</code>.</li>
</ul></li>
<li><code>bt &lt;num&gt; /regexp/</code> or <code>backtrace &lt;num&gt; /regexp/</code>

<ul>
<li>Only shows first <code>&lt;num&gt;</code> frames with method name or location info that matches <code>/regexp/</code>.</li>
</ul></li>
<li><code>l[ist]</code>

<ul>
<li>Show current frame&#39;s source code.</li>
<li>Next <code>list</code> command shows the successor lines.</li>
</ul></li>
<li><code>l[ist] -</code>

<ul>
<li>Show predecessor lines as opposed to the <code>list</code> command.</li>
</ul></li>
<li><code>l[ist] &lt;start&gt;</code> or <code>l[ist] &lt;start&gt;-&lt;end&gt;</code>

<ul>
<li>Show current frame&#39;s source code from the line <start> to <end> if given.</li>
</ul></li>
<li><code>whereami</code>

<ul>
<li>Show the current frame with source code.</li>
</ul></li>
<li><code>edit</code>

<ul>
<li>Open the current file on the editor (use <code>EDITOR</code> environment variable).</li>
<li>Note that edited file will not be reloaded.</li>
</ul></li>
<li><code>edit &lt;file&gt;</code>

<ul>
<li>Open <file> on the editor.</li>
</ul></li>
<li><code>i[nfo]</code>

<ul>
<li>Show information about current frame (local/instance variables and defined constants).</li>
</ul></li>
<li><code>i[nfo]</code> <subcommand>

<ul>
<li><code>info</code> has the following sub-commands.</li>
<li>Sub-commands can be specified with few letters which is unambiguous, like <code>l</code> for &#39;locals&#39;.</li>
</ul></li>
<li><code>i[nfo] l or locals or local_variables</code>

<ul>
<li>Show information about the current frame (local variables)</li>
<li>It includes <code>self</code> as <code>%self</code> and a return value as <code>_return</code>.</li>
</ul></li>
<li><code>i[nfo] i or ivars or instance_variables</code>

<ul>
<li>Show information about instance variables about <code>self</code>.</li>
<li><code>info ivars &lt;expr&gt;</code> shows the instance variables of the result of <code>&lt;expr&gt;</code>.</li>
</ul></li>
<li><code>i[nfo] c or consts or constants</code>

<ul>
<li>Show information about accessible constants except toplevel constants.</li>
<li><code>info consts &lt;expr&gt;</code> shows the constants of a class/module of the result of <code>&lt;expr&gt;</code></li>
</ul></li>
<li><code>i[nfo] g or globals or global_variables</code>

<ul>
<li>Show information about global variables</li>
</ul></li>
<li><code>i[nfo] th or threads</code>

<ul>
<li>Show all threads (same as <code>th[read]</code>).</li>
</ul></li>
<li><code>i[nfo] b or breakpoints or w or watchpoints</code>

<ul>
<li>Show all breakpoints and watchpoints.</li>
</ul></li>
<li><code>i[nfo] ... /regexp/</code>

<ul>
<li>Filter the output with <code>/regexp/</code>.</li>
</ul></li>
<li><code>o[utline]</code> or <code>ls</code>

<ul>
<li>Show you available methods, constants, local variables, and instance variables in the current scope.</li>
</ul></li>
<li><code>o[utline] &lt;expr&gt;</code> or <code>ls &lt;expr&gt;</code>

<ul>
<li>Show you available methods and instance variables of the given object.</li>
<li>If the object is a class/module, it also lists its constants.</li>
</ul></li>
<li><code>display</code>

<ul>
<li>Show display setting.</li>
</ul></li>
<li><code>display &lt;expr&gt;</code>

<ul>
<li>Show the result of <code>&lt;expr&gt;</code> at every suspended timing.</li>
</ul></li>
<li><code>undisplay</code>

<ul>
<li>Remove all display settings.</li>
</ul></li>
<li><code>undisplay &lt;displaynum&gt;</code>

<ul>
<li>Remove a specified display setting.</li>
</ul></li>
</ul>

<h3>Frame control</h3>

<ul>
<li><code>f[rame]</code>

<ul>
<li>Show the current frame.</li>
</ul></li>
<li><code>f[rame] &lt;framenum&gt;</code>

<ul>
<li>Specify a current frame. Evaluation are run on specified frame.</li>
</ul></li>
<li><code>up</code>

<ul>
<li>Specify the upper frame.</li>
</ul></li>
<li><code>down</code>

<ul>
<li>Specify the lower frame.</li>
</ul></li>
</ul>

<h3>Evaluate</h3>

<ul>
<li><code>p &lt;expr&gt;</code>

<ul>
<li>Evaluate like <code>p &lt;expr&gt;</code> on the current frame.</li>
</ul></li>
<li><code>pp &lt;expr&gt;</code>

<ul>
<li>Evaluate like <code>pp &lt;expr&gt;</code> on the current frame.</li>
</ul></li>
<li><code>eval &lt;expr&gt;</code>

<ul>
<li>Evaluate <code>&lt;expr&gt;</code> on the current frame.</li>
</ul></li>
<li><code>irb</code>

<ul>
<li>Invoke <code>irb</code> on the current frame.</li>
</ul></li>
</ul>

<h3>Trace</h3>

<ul>
<li><code>trace</code>

<ul>
<li>Show available tracers list.</li>
</ul></li>
<li><code>trace line</code>

<ul>
<li>Add a line tracer. It indicates line events.</li>
</ul></li>
<li><code>trace call</code>

<ul>
<li>Add a call tracer. It indicate call/return events.</li>
</ul></li>
<li><code>trace exception</code>

<ul>
<li>Add an exception tracer. It indicates raising exceptions.</li>
</ul></li>
<li><code>trace object &lt;expr&gt;</code>

<ul>
<li>Add an object tracer. It indicates that an object by <code>&lt;expr&gt;</code> is passed as a parameter or a receiver on method call.</li>
</ul></li>
<li><code>trace ... /regexp/</code>

<ul>
<li>Indicates only matched events to <code>/regexp/</code>.</li>
</ul></li>
<li><code>trace ... into: &lt;file&gt;</code>

<ul>
<li>Save trace information into: <code>&lt;file&gt;</code>.</li>
</ul></li>
<li><code>trace off &lt;num&gt;</code>

<ul>
<li>Disable tracer specified by <code>&lt;num&gt;</code> (use <code>trace</code> command to check the numbers).</li>
</ul></li>
<li><code>trace off [line|call|pass]</code>

<ul>
<li>Disable all tracers. If <code>&lt;type&gt;</code> is provided, disable specified type tracers.</li>
</ul></li>
<li><code>record</code>

<ul>
<li>Show recording status.</li>
</ul></li>
<li><code>record [on|off]</code>

<ul>
<li>Start/Stop recording.</li>
</ul></li>
<li><code>step back</code>

<ul>
<li>Start replay. Step back with the last execution log.</li>
<li><code>s[tep]</code> does stepping forward with the last log.</li>
</ul></li>
<li><code>step reset</code>

<ul>
<li>Stop replay .</li>
</ul></li>
</ul>

<h3>Thread control</h3>

<ul>
<li><code>th[read]</code>

<ul>
<li>Show all threads.</li>
</ul></li>
<li><code>th[read] &lt;thnum&gt;</code>

<ul>
<li>Switch thread specified by <code>&lt;thnum&gt;</code>.</li>
</ul></li>
</ul>

<h3>Configuration</h3>

<ul>
<li><code>config</code>

<ul>
<li>Show all configuration with description.</li>
</ul></li>
<li><code>config &lt;name&gt;</code>

<ul>
<li>Show current configuration of <name>.</li>
</ul></li>
<li><code>config set &lt;name&gt; &lt;val&gt;</code> or <code>config &lt;name&gt; = &lt;val&gt;</code>

<ul>
<li>Set <name> to <val>.</li>
</ul></li>
<li><code>config append &lt;name&gt; &lt;val&gt;</code> or <code>config &lt;name&gt; &lt;&lt; &lt;val&gt;</code>

<ul>
<li>Append <code>&lt;val&gt;</code> to <code>&lt;name&gt;</code> if it is an array.</li>
</ul></li>
<li><code>config unset &lt;name&gt;</code>

<ul>
<li>Set <name> to default.</li>
</ul></li>
<li><code>source &lt;file&gt;</code>

<ul>
<li>Evaluate lines in <code>&lt;file&gt;</code> as debug commands.</li>
</ul></li>
<li><code>open</code>

<ul>
<li>open debuggee port on UNIX domain socket and wait for attaching.</li>
<li>Note that <code>open</code> command is EXPERIMENTAL.</li>
</ul></li>
<li><code>open [&lt;host&gt;:]&lt;port&gt;</code>

<ul>
<li>open debuggee port on TCP/IP with given <code>[&lt;host&gt;:]&lt;port&gt;</code> and wait for attaching.</li>
</ul></li>
<li><code>open vscode</code>

<ul>
<li>open debuggee port for VSCode and launch VSCode if available.</li>
</ul></li>
<li><code>open chrome</code>

<ul>
<li>open debuggee port for Chrome and wait for attaching.</li>
</ul></li>
</ul>

<h3>Help</h3>

<ul>
<li><code>h[elp]</code>

<ul>
<li>Show help for all commands.</li>
</ul></li>
<li><code>h[elp] &lt;command&gt;</code>

<ul>
<li>Show help for the given command.</li>
</ul></li>
</ul>

<h2>Debugger API</h2>

<h3>Start debugging</h3>

<h4>Start by requiring a library</h4>

<p>You can start debugging without <code>rdbg</code> command by requiring the following libraries:</p>

<ul>
<li><code>require &#39;debug&#39;</code>: Same as <code>rdbg --nonstop --no-sigint-hook</code>.</li>
<li><code>require &#39;debug/start&#39;</code>: Same as <code>rdbg</code>.</li>
<li><code>require &#39;debug/open&#39;</code>: Same as <code>rdbg --open</code>.</li>
<li><code>require &#39;debug/open_nonstop&#39;</code>: Same as <code>rdbg --open --nonstop</code>.</li>
</ul>

<p>You need to require one of them at the very beginning of the application.
Using <code>ruby -r</code> (for example <code>ruby -r debug/start target.rb</code>) is another way to invoke with debugger.</p>

<p>NOTE: Until Ruby 3.0, there is old <code>lib/debug.rb</code> standard library. So that if this gem is not installed, or if <code>Gemfile</code> missed to list this gem and <code>bundle exec</code> is used, you will see the following output:</p>

<pre class="code shell"><code class="shell">$ ruby -r debug -e0
.../2.7.3/lib/ruby/2.7.0/x86_64-linux/continuation.so: warning: callcc is obsolete; use Fiber instead
Debug.rb
Emacs support available.

.../2.7.3/lib/ruby/2.7.0/rubygems/core_ext/kernel_require.rb:162:    if RUBYGEMS_ACTIVATION_MONITOR.respond_to?(:mon_owned?)
(rdb:1)
</code></pre>

<p><code>lib/debug.rb</code> was not maintained well in recent years, and the purpose of this library is to rewrite old <code>lib/debug.rb</code> with recent techniques.</p>

<h4>Start by method</h4>

<p>After loading <code>debug/session</code>, you can start debug session with the following methods. They are convenient if you want to specify debug configurations in your program.</p>

<ul>
<li><code>DEBUGGER__.start(**kw)</code>: start debug session with local console.</li>
<li><code>DEBUGGER__.open(**kw)</code>: open debug port with configuration (without configurations open with UNIX domain socket)</li>
<li><code>DEBUGGER__.open_unix(**kw)</code>: open debug port with UNIX domain socket</li>
<li><code>DEBUGGER__.open_tcp(**kw)</code>: open debug port with TCP/IP</li>
</ul>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>debug/session</span><span class='tstring_end'>&#39;</span></span>
<span class='const'><a href="DEBUGGER__.html" title="DEBUGGER__ (module)">DEBUGGER__</a></span>.<span class='id identifier rubyid_start'><a href="DEBUGGER__.html#start-class_method" title="DEBUGGER__.start (method)">start</a></span>(<span class='label'>no_color:</span> <span class='kw'>true</span><span class='comma'>,</span>    <span class='comment'># disable colorize
</span>                 <span class='label'>log_level:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>INFO</span><span class='tstring_end'>&#39;</span></span>) <span class='comment'># Change log_level to INFO
</span>
<span class='comment'>#... # your application code</span></code></pre>

<h3><code>binding.break</code> method</h3>

<p><code>binding.break</code> (or <code>binding.b</code>) set breakpoints at written line. It also has several keywords.</p>

<p>If <code>do: &#39;command&#39;</code> is specified, the debugger suspends the program and run the <code>command</code> as a debug command and continue the program.
It is useful if you only want to call a debug command and don&#39;t want to stop there.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@a</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_binding'>binding</span>.<span class='id identifier rubyid_b'>b</span> <span class='label'>do:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>info \n watch @a</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></code></pre>

<p>On this case, execute the <code>info</code> command then register a watch breakpoint for <code>@a</code> and continue to run. You can also use <code>;;</code> instead of <code>\n</code> to separate your commands.</p>

<p>If <code>pre: &#39;command&#39;</code> is specified, the debugger suspends the program and run the <code>command</code> as a debug command, and keep suspend.
It is useful if you have operations before suspend.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_foo'>foo</span>
  <span class='id identifier rubyid_binding'>binding</span>.<span class='id identifier rubyid_b'>b</span> <span class='label'>pre:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>p bar()</span><span class='tstring_end'>&#39;</span></span>
  <span class='comment'>#...
</span><span class='kw'>end</span></code></pre>

<p>On this case, you can see the result of <code>bar()</code> every time you stop there.</p>

<h2>rdbg command help</h2>

<pre class="code ruby"><code class="ruby">exe/rdbg [options] -- [debuggee options]

Debug console mode:
    -n, --nonstop                    Do not stop at the beginning of the script.
    -e DEBUG_COMMAND                 Execute debug command at the beginning of the script.
    -x, --init-script=FILE           Execute debug command in the FILE.
        --no-rc                      Ignore ~/.rdbgrc
        --no-color                   Disable colorize
        --no-sigint-hook             Disable to trap SIGINT
    -c, --command                    Enable command mode.
                                     The first argument should be a command name in $PATH.
                                     Example: &#39;rdbg -c bundle exec rake test&#39;

    -O, --open=[FRONTEND]            Start remote debugging with opening the network port.
                                     If TCP/IP options are not given, a UNIX domain socket will be used.
                                     If FRONTEND is given, prepare for the FRONTEND.
                                     Now rdbg, vscode and chrome is supported.
        --sock-path=SOCK_PATH        UNIX Domain socket path
        --port=PORT                  Listening TCP/IP port
        --host=HOST                  Listening TCP/IP host
        --cookie=COOKIE              Set a cookie for connection

  Debug console mode runs Ruby program with the debug console.

  &#39;rdbg target.rb foo bar&#39;                starts like &#39;ruby target.rb foo bar&#39;.
  &#39;rdbg -- -r foo -e bar&#39;                 starts like &#39;ruby -r foo -e bar&#39;.
  &#39;rdbg -c rake test&#39;                     starts like &#39;rake test&#39;.
  &#39;rdbg -c -- rake test -t&#39;               starts like &#39;rake test -t&#39;.
  &#39;rdbg -c bundle exec rake test&#39;         starts like &#39;bundle exec rake test&#39;.
  &#39;rdbg -O target.rb foo bar&#39;             starts and accepts attaching with UNIX domain socket.
  &#39;rdbg -O --port 1234 target.rb foo bar&#39; starts accepts attaching with TCP/IP localhost:1234.
  &#39;rdbg -O --port 1234 -- -r foo -e bar&#39;  starts accepts attaching with TCP/IP localhost:1234.
  &#39;rdbg target.rb -O chrome --port 1234&#39;  starts and accepts connecting from Chrome Devtools with localhost:1234.

Attach mode:
    -A, --attach                     Attach to debuggee process.

  Attach mode attaches the remote debug console to the debuggee process.

  &#39;rdbg -A&#39;           tries to connect via UNIX domain socket.
                      If there are multiple processes are waiting for the
                      debugger connection, list possible debuggee names.
  &#39;rdbg -A path&#39;      tries to connect via UNIX domain socket with given path name.
  &#39;rdbg -A port&#39;      tries to connect to localhost:port via TCP/IP.
  &#39;rdbg -A host port&#39; tries to connect to host:port via TCP/IP.

Other options:
    -h, --help                       Print help
        --util=NAME                  Utility mode (used by tools)
        --stop-at-load               Stop immediately when the debugging feature is loaded.

NOTE
  All messages communicated between a debugger and a debuggee are *NOT* encrypted.
  Please use the remote debugging feature carefully.</code></pre>

<h1>Additional Resources</h1>

<ul>
<li><a href="https://st0012.dev/from-byebug-to-ruby-debug">From byebug to ruby/debug</a> by Stan Lo - A migration guide for <code>byebug</code> users.</li>
<li><a href="https://st0012.dev/ruby-debug-cheatsheet">ruby/debug cheatsheet</a> by Stan Lo</li>
</ul>

<h1>Contributing</h1>

<p>Bug reports and pull requests are welcome on GitHub at <a href="https://github.com/ruby/debug">https://github.com/ruby/debug</a>.
This debugger is not mature so your feedback will help us.</p>

<p>Please also check the <a href="file.CONTRIBUTING.html">contributing guideline</a>.</p>

<h1>Acknowledgement</h1>

<ul>
<li>Some tests are based on <a href="https://github.com/deivid-rodriguez/byebug">deivid-rodriguez/byebug: Debugging in Ruby 2</a></li>
<li>Several codes in <code>server_cdp.rb</code> are based on <a href="https://github.com/geoffreylitt/ladybug">geoffreylitt/ladybug: Visual Debugger</a></li>
</ul>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>