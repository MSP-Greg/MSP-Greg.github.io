<!DOCTYPE html>
<html>
<head>

<meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen'       content='yes'>
<meta name='apple-mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>Class: Proc &mdash; Core Ruby-3.2.3 pp157</title>

<link rel='stylesheet'  type='text/css' href='../../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "Proc",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='../.'>Ruby-3.2.3</a> &raquo; 
      <a href='.'>Core</a> &raquo; 
      <a href='_index.html#alpha_P'>Index (P)</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>Proc&nbsp;&#x25B2;</a></span>
    </div>

    <a id='list_href' href="class_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='class'>
<h1>Class: Proc</h1>
<div id='t2_rel_sf_div'>
<table id='t2_rel_sf' class='y_box'>
  <thead>
    <tr><td id='t2_relations' colspan='2'>Relationships & Source Files</td></tr>
  </thead>
  <tbody>
    <tr>
      <td id='t2_inherits' class='box_2'>Inherits:</td>
      <td class='box_rel'>
        <span class='inheritName'><a href="Object.html" title="Object (class)">Object</a></span>
      </td>
    </tr>
    <tr class='single'>
      <td id='t2_defined_in' class='box_2 o'>Defined in:</td>
      <td class='box_rel'><a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L4272'>proc.c</a><span class='defines'>,<br /><a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L4265'>proc.c</a>,<br/> <a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/vm.c#L1075'>vm.c</a></span>
      </td>
    </tr>
  </tbody>
</table>
</div>
<h2 id='h2_overview'>Overview</h2>
<div id='overview_ds'>
<div class='docstring'>
  <div class='discussion'>
    
<p>A <code>Proc</code> object is an encapsulation of a block of code, which can be stored in a local variable, passed to a method or another <code>Proc</code>, and can be called. <code>Proc</code> is an essential concept in Ruby and a core of its functional programming features.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_square'>square</span> <span class='op'>=</span> <span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }

<span class='id identifier rubyid_square'>square</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>3</span>)  <span class='comment'>#=&gt; 9
</span><span class='comment'># shorthands:
</span><span class='id identifier rubyid_square'>square</span>.(<span class='int'>3</span>)      <span class='comment'>#=&gt; 9
</span><span class='id identifier rubyid_square'>square</span>[<span class='int'>3</span>]       <span class='comment'>#=&gt; 9</span></code></pre>

<p><code>Proc</code> objects are <em>closures</em>, meaning they remember and can use the entire context in which they were created.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_gen_times'>gen_times</span>(<span class='id identifier rubyid_factor'>factor</span>)
  <span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {<span class='op'>|</span><span class='id identifier rubyid_n'>n</span><span class='op'>|</span> <span class='id identifier rubyid_n'>n</span><span class='op'>*</span><span class='id identifier rubyid_factor'>factor</span> } <span class='comment'># remembers the value of factor at the moment of creation
</span><span class='kw'>end</span>

<span class='id identifier rubyid_times3'>times3</span> <span class='op'>=</span> <span class='id identifier rubyid_gen_times'>gen_times</span>(<span class='int'>3</span>)
<span class='id identifier rubyid_times5'>times5</span> <span class='op'>=</span> <span class='id identifier rubyid_gen_times'>gen_times</span>(<span class='int'>5</span>)

<span class='id identifier rubyid_times3'>times3</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>12</span>)               <span class='comment'>#=&gt; 36
</span><span class='id identifier rubyid_times5'>times5</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>5</span>)                <span class='comment'>#=&gt; 25
</span><span class='id identifier rubyid_times3'>times3</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='id identifier rubyid_times5'>times5</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>4</span>))   <span class='comment'>#=&gt; 60</span></code></pre>

<h3 id="label-Creation">Creation</h3>

<p>There are several methods to create a <code>Proc</code></p>
<ul><li>
<p>Use the <code>Proc</code> class constructor:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc1'>proc1</span> <span class='op'>=</span> <span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }</code></pre>
</li><li>
<p>Use the <a href="Kernel.html#proc-class_method" title="Kernel.proc (method)">Kernel.proc</a> method as a shorthand of <a href="#new-class_method" title="Proc.new (method)">.new</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc2'>proc2</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }</code></pre>
</li><li>
<p>Receiving a block of code into proc argument (note the <code>&amp;</code>):</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_make_proc'>make_proc</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_proc3'>proc3</span> <span class='op'>=</span> <span class='id identifier rubyid_make_proc'>make_proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }</code></pre>
</li><li>
<p>Construct a proc with lambda semantics using the <a href="Kernel.html#lambda-class_method" title="Kernel.lambda (method)">Kernel.lambda</a> method (see below for explanations about lambdas):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lambda1'>lambda1</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }</code></pre>
</li><li>
<p>Use the <code>Lambda proc literal</code> syntax (also constructs a proc with lambda semantics):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lambda2'>lambda2</span> <span class='op'>=</span> <span class='tlambda'>-&gt;</span>(<span class='id identifier rubyid_x'>x</span>) <span class='tlambeg'>{</span> <span class='id identifier rubyid_x'>x</span><span class='op'>**</span><span class='int'>2</span> }</code></pre>
</li></ul>

<h3 id="label-Lambda+and+non-lambda+semantics">Lambda and non-lambda semantics</h3>

<p>Procs are coming in two flavors: lambda and non-lambda (regular procs). Differences are:</p>
<ul><li>
<p>In lambdas, <code>return</code> and <code>break</code> means exit from this lambda;</p>
</li><li>
<p>In non-lambda procs, <code>return</code> means exit from embracing method (and will throw <code>LocalJumpError</code> if invoked outside the method);</p>
</li><li>
<p>In non-lambda procs, <code>break</code> means exit from the method which the block given for. (and will throw <code>LocalJumpError</code> if invoked after the method returns);</p>
</li><li>
<p>In lambdas, arguments are treated in the same way as in methods: strict, with <code>ArgumentError</code> for mismatching argument number, and no additional argument processing;</p>
</li><li>
<p>Regular procs accept arguments more generously: missing arguments are filled with <code>nil</code>, single Array arguments are deconstructed if the proc has multiple arguments, and there is no error raised on extra arguments.</p>
</li></ul>

<p>Examples:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># return in non-lambda proc, b, exits m2.
</span><span class='comment'># (The block +{ return }+ is given for m1 and embraced by m2.)
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>return</span> }<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; []
</span>
<span class='comment'># break in non-lambda proc, b, exits m1.
</span><span class='comment'># (The block +{ break }+ is given for m1 and embraced by m2.)
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>break</span> }<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m2]
</span>
<span class='comment'># next in non-lambda proc, b, exits the block.
</span><span class='comment'># (The block +{ next }+ is given for m1 and embraced by m2.)
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>next</span> }<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m1, :m2]
</span>
<span class='comment'># Using proc method changes the behavior as follows because
</span><span class='comment'># The block is given for proc method and embraced by m2.
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> { <span class='kw'>return</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; []
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> { <span class='kw'>break</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'># break from proc-closure (LocalJumpError)
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> { <span class='kw'>next</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m1, :m2]
</span>
<span class='comment'># return, break and next in the stubby lambda exits the block.
</span><span class='comment'># (lambda method behaves same.)
</span><span class='comment'># (The block is given for stubby lambda syntax and embraced by m2.)
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>return</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m1, :m2]
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>break</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m1, :m2]
</span><span class='gvar'>$a</span> <span class='op'>=</span> []<span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span><span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m1'>m1</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>() <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='kw'>next</span> })<span class='semicolon'>;</span> <span class='gvar'>$a</span> <span class='op'>&lt;&lt;</span> <span class='symbeg'>:</span><span class='id identifier rubyid_m2'>m2</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span><span class='semicolon'>;</span> <span class='id identifier rubyid_p'>p</span> <span class='gvar'>$a</span>
<span class='comment'>#=&gt; [:m1, :m2]
</span>
<span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='embexpr_end'>}</span><span class='tstring_content'>, y=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_y'>y</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
<span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>)      <span class='comment'>#=&gt; &quot;x=1, y=2&quot;
</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>([<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>])    <span class='comment'>#=&gt; &quot;x=1, y=2&quot;, array deconstructed
</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>8</span>)   <span class='comment'>#=&gt; &quot;x=1, y=2&quot;, extra argument discarded
</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)         <span class='comment'>#=&gt; &quot;x=1, y=&quot;, nil substituted instead of error
</span>
<span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_x'>x</span><span class='embexpr_end'>}</span><span class='tstring_content'>, y=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_y'>y</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
<span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>)      <span class='comment'>#=&gt; &quot;x=1, y=2&quot;
</span><span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>([<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>])    <span class='comment'># ArgumentError: wrong number of arguments (given 1, expected 2)
</span><span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>8</span>)   <span class='comment'># ArgumentError: wrong number of arguments (given 3, expected 2)
</span><span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)         <span class='comment'># ArgumentError: wrong number of arguments (given 1, expected 2)
</span>
<span class='kw'>def</span> <span class='id identifier rubyid_test_return'>test_return</span>
  <span class='comment'>#=&gt; { return 3 }.call      # just returns from lambda into method body
</span>  <span class='id identifier rubyid_proc'>proc</span> { <span class='kw'>return</span> <span class='int'>4</span> }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>    <span class='comment'># returns from method
</span>  <span class='kw'>return</span> <span class='int'>5</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_test_return'>test_return</span> <span class='comment'># =&gt; 4, return from proc</span></code></pre>

<p>Lambdas are useful as self-sufficient functions, in particular useful as arguments to higher-order functions, behaving exactly like Ruby methods.</p>

<p>Procs are useful for implementing iterators:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_test'>test</span>
  [[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]<span class='comma'>,</span> [<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]<span class='comma'>,</span> [<span class='int'>5</span><span class='comma'>,</span> <span class='int'>6</span>]].<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='kw'>return</span> <span class='id identifier rubyid_a'>a</span> <span class='kw'>if</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>+</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>&gt;</span> <span class='int'>10</span> }
                            <span class='comment'>#  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</span><span class='kw'>end</span></code></pre>

<p>Inside <code>map</code>, the block of code is treated as a regular (non-lambda) proc, which means that the internal arrays will be deconstructed to pairs of arguments, and <code>return</code> will exit from the method <code>test</code>. That would not be possible with a stricter lambda.</p>

<p>You can tell a lambda from a regular proc by using the <a href="#lambda%3F-instance_method" title="Proc#lambda? (method)">#lambda?</a> instance method.</p>

<p>Lambda semantics is typically preserved during the proc lifetime, including <code>&amp;</code>-deconstruction to a block of code:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> }
<span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> }
[[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]<span class='comma'>,</span> [<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_p'>p</span>) <span class='comment'>#=&gt; [1, 3]
</span>[[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>]<span class='comma'>,</span> [<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_l'>l</span>) <span class='comment'># ArgumentError: wrong number of arguments (given 1, expected 2)</span></code></pre>

<p>The only exception is dynamic method definition: even if defined by passing a non-lambda proc, methods still have normal semantics of argument checking.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {})
<span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_e'>e</span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>)       <span class='comment'>#=&gt; ArgumentError
</span><span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_lambda?'><a href="#lambda%3F-instance_method" title="Proc#lambda? (method)">lambda?</a></span>   <span class='comment'>#=&gt; true</span></code></pre>

<p>This exception ensures that methods never have unusual argument passing conventions, and makes it easy to have wrappers defining methods that behave as usual.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_def2'>def2</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_body'>body</span>)
    <span class='id identifier rubyid_define_method'>define_method</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_body'>body</span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_def2'>def2</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_f'>f</span>) {}
<span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_f'>f</span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>)       <span class='comment'>#=&gt; ArgumentError</span></code></pre>

<p>The wrapper <code>def2</code> receives <em>body</em> as a non-lambda proc, yet defines a method which has normal semantics.</p>

<h3 id="label-Conversion+of+other+objects+to+procs">Conversion of other objects to procs</h3>

<p>Any object that implements the <a href="#to_proc-instance_method" title="Proc#to_proc (method)">#to_proc</a> method can be converted into a proc by the <code>&amp;</code> operator, and therefore can be consumed by iterators.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Greeter</span>
  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>(<span class='id identifier rubyid_greeting'>greeting</span>)
    <span class='ivar'>@greeting</span> <span class='op'>=</span> <span class='id identifier rubyid_greeting'>greeting</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>
    <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@greeting</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span> }
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_hi'>hi</span> <span class='op'>=</span> <span class='const'>Greeter</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hi</span><span class='tstring_end'>&quot;</span></span>)
<span class='id identifier rubyid_hey'>hey</span> <span class='op'>=</span> <span class='const'>Greeter</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hey</span><span class='tstring_end'>&quot;</span></span>)
[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jane</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_hi'>hi</span>)    <span class='comment'>#=&gt; [&quot;Hi, Bob!&quot;, &quot;Hi, Jane!&quot;]
</span>[<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Bob</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Jane</span><span class='tstring_end'>&quot;</span></span>].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_hey'>hey</span>)   <span class='comment'>#=&gt; [&quot;Hey, Bob!&quot;, &quot;Hey, Jane!&quot;]</span></code></pre>

<p>Of the Ruby core classes, this method is implemented by <a href="Symbol.html" title="Symbol (class)"><code>::Symbol</code></a>, <a href="Method.html" title="Method (class)"><code>::Method</code></a>, and <a href="Hash.html" title="Hash (class)"><code>::Hash</code></a>.</p>

<pre class="code ruby"><code class="ruby"><span class='symbeg'>:</span><span class='id identifier rubyid_to_s'><a href="#to_s-instance_method" title="Proc#to_s (method)">to_s</a></span>.<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)           <span class='comment'>#=&gt; &quot;1&quot;
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>].<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span><span class='symbeg'>:</span><span class='id identifier rubyid_to_s'><a href="#to_s-instance_method" title="Proc#to_s (method)">to_s</a></span>)              <span class='comment'>#=&gt; [&quot;1&quot;, &quot;2&quot;]
</span>
<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_puts'>puts</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)   <span class='comment'># prints 1
</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>].<span class='id identifier rubyid_each'>each</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_puts'>puts</span>))     <span class='comment'># prints 1, 2
</span>
{<span class='label'>test:</span> <span class='int'>1</span>}.<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_test'>test</span>)       <span class='comment'>#=&gt; 1
</span><span class='qsymbols'><span class='qsymbols_beg'>%i[</span><span class='tstring_content'>test</span><span class='words_sep'> </span><span class='tstring_content'>many</span><span class='words_sep'> </span><span class='tstring_content'>keys</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_map'>map</span>(<span class='op'>&amp;</span>{<span class='label'>test:</span> <span class='int'>1</span>})  <span class='comment'>#=&gt; [1, nil, nil]</span></code></pre>

<h3 id="label-Orphaned+Proc">Orphaned Proc</h3>

<p><code>return</code> and <code>break</code> in a block exit a method. If a <code>Proc</code> object is generated from the block and the <code>Proc</code> object survives until the method is returned, <code>return</code> and <code>break</code> cannot work. In such case, <code>return</code> and <code>break</code> raises <a href="LocalJumpError.html" title="LocalJumpError (class)"><code>::LocalJumpError</code></a>. A Proc object in such situation is called as orphaned <code>Proc</code> object.</p>

<p>Note that the method to exit is different for <code>return</code> and <code>break</code>. There is a situation that orphaned for <code>break</code> but not orphaned for <code>return</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>return</span> } <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span> <span class='comment'># ok
</span><span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>break</span> } <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span> <span class='comment'># ok
</span>
<span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>return</span> }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span> <span class='comment'># ok
</span><span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>break</span> }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span> <span class='comment'># LocalJumpError
</span>
<span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>return</span> } <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='comment'># LocalJumpError
</span><span class='kw'>def</span> <span class='id identifier rubyid_m1'>m1</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span> <span class='kw'>end</span><span class='semicolon'>;</span> <span class='kw'>def</span> <span class='id identifier rubyid_m2'>m2</span>()<span class='semicolon'>;</span> <span class='id identifier rubyid_m1'>m1</span> { <span class='kw'>break</span> } <span class='kw'>end</span><span class='semicolon'>;</span> <span class='id identifier rubyid_m2'>m2</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span> <span class='comment'># LocalJumpError</span></code></pre>

<p>Since <code>return</code> and <code>break</code> exits the block itself in lambdas, lambdas cannot be orphaned.</p>

<h3 id="label-Numbered+parameters">Numbered parameters</h3>

<p>Numbered parameters are implicitly defined block parameters intended to simplify writing short blocks:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># Explicit parameter:
</span><span class='qwords'><span class='qwords_beg'>%w[</span><span class='tstring_content'>test</span><span class='words_sep'> </span><span class='tstring_content'>me</span><span class='words_sep'> </span><span class='tstring_content'>please</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_each'>each</span> { <span class='op'>|</span><span class='id identifier rubyid_str'>str</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_str'>str</span>.<span class='id identifier rubyid_upcase'>upcase</span> } <span class='comment'># prints TEST, ME, PLEASE
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>5</span>).<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_i'>i</span><span class='op'>**</span><span class='int'>2</span> } <span class='comment'># =&gt; [1, 4, 9, 16, 25]
</span>
<span class='comment'># Implicit parameter:
</span><span class='qwords'><span class='qwords_beg'>%w[</span><span class='tstring_content'>test</span><span class='words_sep'> </span><span class='tstring_content'>me</span><span class='words_sep'> </span><span class='tstring_content'>please</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_each'>each</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid__1'>_1</span>.<span class='id identifier rubyid_upcase'>upcase</span> } <span class='comment'># prints TEST, ME, PLEASE
</span>(<span class='int'>1</span><span class='op'>..</span><span class='int'>5</span>).<span class='id identifier rubyid_map'>map</span> { <span class='id identifier rubyid__1'>_1</span><span class='op'>**</span><span class='int'>2</span> } <span class='comment'># =&gt; [1, 4, 9, 16, 25]</span></code></pre>

<p>Parameter names from <code>_1</code> to <code>_9</code> are supported:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>10</span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='int'>30</span>].<span class='id identifier rubyid_zip'>zip</span>([<span class='int'>40</span><span class='comma'>,</span> <span class='int'>50</span><span class='comma'>,</span> <span class='int'>60</span>]<span class='comma'>,</span> [<span class='int'>70</span><span class='comma'>,</span> <span class='int'>80</span><span class='comma'>,</span> <span class='int'>90</span>]).<span class='id identifier rubyid_map'>map</span> { <span class='id identifier rubyid__1'>_1</span> <span class='op'>+</span> <span class='id identifier rubyid__2'>_2</span> <span class='op'>+</span> <span class='id identifier rubyid__3'>_3</span> }
<span class='comment'># =&gt; [120, 150, 180]</span></code></pre>

<p>Though, it is advised to resort to them wisely, probably limiting yourself to <code>_1</code> and <code>_2</code>, and to one-line blocks.</p>

<p>Numbered parameters can’t be used together with explicitly named ones:</p>

<pre class="code ruby"><code class="ruby">[<span class='int'>10</span><span class='comma'>,</span> <span class='int'>20</span><span class='comma'>,</span> <span class='int'>30</span>].<span class='id identifier rubyid_map'>map</span> { <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid__1'>_1</span><span class='op'>**</span><span class='int'>2</span> }
<span class='comment'># SyntaxError (ordinary parameter is defined)</span></code></pre>

<p>To avoid conflicts, naming local variables or method arguments <code>_1</code>, <code>_2</code> and so on, causes a warning.</p>

<pre class="code ruby"><code class="ruby">_1 = &#39;test&#39;
# warning: `_1&#39; is reserved as numbered parameter</code></pre>

<p>Using implicit numbered parameters affects block’s arity:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_p'>p</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='id identifier rubyid__1'>_1</span> <span class='op'>+</span> <span class='id identifier rubyid__2'>_2</span> }
<span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> { <span class='id identifier rubyid__1'>_1</span> <span class='op'>+</span> <span class='id identifier rubyid__2'>_2</span> }
<span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_parameters'><a href="#parameters-instance_method" title="Proc#parameters (method)">parameters</a></span>     <span class='comment'># =&gt; [[:opt, :_1], [:opt, :_2]]
</span><span class='id identifier rubyid_p'>p</span>.<span class='id identifier rubyid_arity'><a href="#arity-instance_method" title="Proc#arity (method)">arity</a></span>          <span class='comment'># =&gt; 2
</span><span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_parameters'><a href="#parameters-instance_method" title="Proc#parameters (method)">parameters</a></span>     <span class='comment'># =&gt; [[:req, :_1], [:req, :_2]]
</span><span class='id identifier rubyid_l'>l</span>.<span class='id identifier rubyid_arity'><a href="#arity-instance_method" title="Proc#arity (method)">arity</a></span>          <span class='comment'># =&gt; 2</span></code></pre>

<p>Blocks with numbered parameters can’t be nested:</p>

<pre class="code ruby"><code class="ruby"><span class='qwords'><span class='qwords_beg'>%w[</span><span class='tstring_content'>test</span><span class='words_sep'> </span><span class='tstring_content'>me</span><span class='tstring_end'>]</span></span>.<span class='id identifier rubyid_each'>each</span> { <span class='id identifier rubyid__1'>_1</span>.<span class='id identifier rubyid_each_char'>each_char</span> { <span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid__1'>_1</span> } }
<span class='comment'># SyntaxError (numbered parameter is already used in outer block here)
</span><span class='comment'># %w[test me].each { _1.each_char { p _1 } }
</span><span class='comment'>#                    ^~</span></code></pre>

<p>Numbered parameters were introduced in Ruby 2.7.</p>

  </div>
</div>
</div>
<h2 class='h2_sum' id='class_method_summary'>Class Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#new-class_method" title="new (class method)">.<strong>new</strong> {|...| ... } &#x21d2; Proc </a>
    </span>
    <span class='note title constructor'>constructor</span>
    <div class='summary_desc'>
      <div class='inline'><p>Creates a new <code>Proc</code> object, bound to the current context.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- class_method_summary -->

<h2 class='h2_sum' id='instance_attribute_summary'>Instance Attribute Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature ro'>
      <a href="#lambda%3F-instance_method" title="#lambda? (instance method)">#<strong>lambda?</strong>  &#x21d2; Boolean </a>
    </span>
    <span class='note title readonly'>readonly</span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns <code>true</code> if a <code>Proc</code> object is lambda.</p></div>
    </div>
  </li>
</ul>
</div>  <!-- instance_attribute_summary -->

<h2 class='h2_sum' id='instance_method_summary'>Instance Method Summary</h2>
<div class='div_sum'>
<ul class='summary full'>
  <li>
    <span class='summary_signature '>
      <a href="#<<-instance_method" title="#&lt;&lt; (instance method)">#<strong>&lt;&lt;</strong>(g)  &#x21d2; Proc </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a proc that is the composition of this proc and the given <em>g</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#==-instance_method" title="#== (instance method)">#<strong>==</strong>(other)  &#x21d2; Boolean </a>
      (also: #eql?)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Two procs are the same if, and only if, they were created from the same code block.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#===-instance_method" title="#call (instance method)">#<strong>call</strong>(params,...)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#>>-instance_method" title="#&gt;&gt; (instance method)">#<strong>&gt;&gt;</strong>(g)  &#x21d2; Proc </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a proc that is the composition of this proc and the given <em>g</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#[]-instance_method" title="#[] (instance method)">#<strong>[]</strong>(params,...)  &#x21d2; Object </a>
      (also: #call, #===, #yield)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Invokes the block, setting the block’s parameters to the values in <em>params</em> using something close to method calling semantics.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#arity-instance_method" title="#arity (instance method)">#<strong>arity</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the number of mandatory arguments.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#binding-instance_method" title="#binding (instance method)">#<strong>binding</strong>  &#x21d2; Binding </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the binding associated with <em>prc</em>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#call-instance_method" title="#call (instance method)">#<strong>call</strong>(params,...)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#curry-instance_method" title="#curry (instance method)">#<strong>curry</strong>  &#x21d2; Proc </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a curried proc.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#dup-instance_method" title="#dup (instance method)">#<strong>dup</strong>  </a>
    </span>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#eql%3F-instance_method" title="#eql? (instance method)">#<strong>eql?</strong>(other)  &#x21d2; Boolean </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#==-instance_method" title="Proc#== (method)">#==</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#hash-instance_method" title="#hash (instance method)">#<strong>hash</strong>  &#x21d2; Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns a hash value corresponding to proc body.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#to_s-instance_method" title="Proc#to_s (method)">#to_s</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#parameters-instance_method" title="#parameters (instance method)">#<strong>parameters</strong>(lambda: nil)  &#x21d2; Array </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the parameter information of this proc.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#ruby2_keywords-instance_method" title="#ruby2_keywords (instance method)">#<strong>ruby2_keywords</strong>  &#x21d2; Proc </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Marks the proc as passing keywords through a normal argument splat.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#source_location-instance_method" title="#source_location (instance method)">#<strong>source_location</strong>  &#x21d2; Array, Integer </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the Ruby source filename and line number containing this proc or <code>nil</code> if this proc was not defined in Ruby (i.e.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#to_proc-instance_method" title="#to_proc (instance method)">#<strong>to_proc</strong>  &#x21d2; Proc </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Part of the protocol for converting objects to <code>Proc</code> objects.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#inspect-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; String </a>
      (also: #inspect)
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Returns the unique identifier for this proc, along with an indication of where the proc was defined.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature '>
      <a href="#yield-instance_method" title="#yield (instance method)">#<strong>yield</strong>(params,...)  &#x21d2; Object </a>
    </span>
    <div class='summary_desc'>
      <div class='inline'><p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>.</p></div>
    </div>
  </li>
  <li>
    <span class='summary_signature nodoc'>
      <a href="#clone-instance_method" title="#clone (instance method)">#<strong>clone</strong>  </a>
    </span>
    <span class='nodoc note title'>Internal use only</span>
  </li>
</ul>
</div>  <!-- instance_method_summary -->
<h2 id='Constructor_Details' class='y_details'>Constructor Details</h2>

  <section class='method_details first' id="new-class_method">
  <h3 class='signature  first'>
    .<strong>new</strong> {|...| ... } &#x21d2; <code>Proc</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Creates a new <code>Proc</code> object, bound to the current context.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc'>proc</span> <span class='op'>=</span> <span class='const'>Proc</span>.<span class='id identifier rubyid_new'>new</span> { <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span> }
<span class='id identifier rubyid_proc'>proc</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>   <span class='comment'>#=&gt; &quot;hello&quot;</span></code></pre>

<p>Raises ArgumentError if called without a block.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Proc</span>.<span class='id identifier rubyid_new'>new</span>    <span class='comment'>#=&gt; ArgumentError</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L838-L845'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='838' data-end='845'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 838</span></pre>
<pre class='code cpp'>

static VALUE
rb_proc_s_new(int argc, VALUE *argv, VALUE klass)
{
    VALUE block = proc_new(klass, FALSE, FALSE);

    rb_obj_call_init_kw(block, argc, argv, RB_PASS_CALLED_KEYWORDS);
    return block;
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Attribute Details</h2>
<section class='method_details first' id="lambda?-instance_method">
  <h3 class='signature ro first'>
    #<strong>lambda?</strong>  &#x21d2; <code>Boolean</code>  <span class="extras">(<span class='readonly'>readonly</span>)</span>  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns <code>true</code> if a <code>Proc</code> object is lambda. <code>false</code> if non-lambda.</p>

<p>The lambda-ness affects argument handling and the behavior of <code>return</code> and <code>break</code>.</p>

<p>A Proc object generated by <code>proc</code> ignores extra arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span>)    <span class='comment'>#=&gt; [1,2]</span></code></pre>

<p>It provides <code>nil</code> for missing arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)        <span class='comment'>#=&gt; [1,nil]</span></code></pre>

<p>It expands a single array argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>([<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>])    <span class='comment'>#=&gt; [1,2]</span></code></pre>

<p>A Proc object generated by <code>lambda</code> doesn’t have such tricks.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span><span class='comma'>,</span><span class='int'>3</span>)  <span class='comment'>#=&gt; ArgumentError
</span><span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)      <span class='comment'>#=&gt; ArgumentError
</span><span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>([<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>])  <span class='comment'>#=&gt; ArgumentError</span></code></pre>

<p><code>lambda?</code> is a predicate for the tricks. It returns <code>true</code> if no tricks apply.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lambda'>lambda</span> {}.<span class='id identifier rubyid_lambda?'>lambda?</span>            <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_proc'>proc</span> {}.<span class='id identifier rubyid_lambda?'>lambda?</span>              <span class='comment'>#=&gt; false</span></code></pre>

<p><a href="#new-class_method" title="Proc.new (method)">.new</a> is the same as <code>proc</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {}.<span class='id identifier rubyid_lambda?'>lambda?</span>          <span class='comment'>#=&gt; false</span></code></pre>

<p><code>lambda</code>, <code>proc</code> and <a href="#new-class_method" title="Proc.new (method)">.new</a> preserve the tricks of a <code>Proc</code> object given by <code>&amp;</code> argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_lambda'>lambda</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_lambda'>lambda</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span>   <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_proc'>proc</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_lambda'>lambda</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span>     <span class='comment'>#=&gt; true
</span><span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_lambda'>lambda</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span> <span class='comment'>#=&gt; true
</span>
<span class='id identifier rubyid_lambda'>lambda</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span>     <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_proc'>proc</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span>       <span class='comment'>#=&gt; false
</span><span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {}).<span class='id identifier rubyid_lambda?'>lambda?</span>   <span class='comment'>#=&gt; false</span></code></pre>

<p>A Proc object generated by <code>&amp;</code> argument has the tricks</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_b'>b</span>) <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_lambda?'>lambda?</span> <span class='kw'>end</span>
<span class='id identifier rubyid_n'>n</span> {}                         <span class='comment'>#=&gt; false</span></code></pre>

<p>The <code>&amp;</code> argument preserves the tricks if a <code>Proc</code> object is given by <code>&amp;</code> argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_lambda'>lambda</span> {})                <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {})                  <span class='comment'>#=&gt; false
</span><span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {})              <span class='comment'>#=&gt; false</span></code></pre>

<p>A Proc object converted from a method has no tricks.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_m'>m</span>() <span class='kw'>end</span>
<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_m'>m</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_lambda?'>lambda?</span>   <span class='comment'>#=&gt; true
</span>
<span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_m'>m</span>))               <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_n'>n</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_m'>m</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>)       <span class='comment'>#=&gt; true</span></code></pre>

<p><code>define_method</code> is treated the same as method definition. The defined method has no tricks.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_d'>d</span>) {}
<span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_d'>d</span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>)       <span class='comment'>#=&gt; ArgumentError
</span><span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_d'>d</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_lambda?'>lambda?</span>   <span class='comment'>#=&gt; true</span></code></pre>

<p><code>define_method</code> always defines a method without the tricks, even if a non-lambda <code>Proc</code> object is given. This is the only exception for which the tricks are not preserved.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='id identifier rubyid_define_method'>define_method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_proc'>proc</span> {})
<span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_e'>e</span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>)       <span class='comment'>#=&gt; ArgumentError
</span><span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_method'>method</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_e'>e</span>).<span class='id identifier rubyid_to_proc'><a href="#to_proc-instance_method" title="Proc#to_proc (method)">to_proc</a></span>.<span class='id identifier rubyid_lambda?'>lambda?</span>   <span class='comment'>#=&gt; true</span></code></pre>

<p>This exception ensures that methods never have tricks and makes it easy to have wrappers to define methods that behave as usual.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>C</span>
  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_def2'>def2</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_body'>body</span>)
    <span class='id identifier rubyid_define_method'>define_method</span>(<span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_body'>body</span>)
  <span class='kw'>end</span>

  <span class='id identifier rubyid_def2'>def2</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_f'>f</span>) {}
<span class='kw'>end</span>
<span class='const'>C</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span>.<span class='id identifier rubyid_f'>f</span>(<span class='int'>1</span><span class='comma'>,</span><span class='int'>2</span>)       <span class='comment'>#=&gt; ArgumentError</span></code></pre>

<p>The wrapper <em>def2</em> defines a method which has no tricks.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L292-L299'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='292' data-end='299'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 292</span></pre>
<pre class='code cpp'>

VALUE
rb_proc_lambda_p(VALUE procval)
{
    rb_proc_t *proc;
    GetProcPtr(procval, proc);

    return RBOOL(proc-&gt;is_lambda);
}
</pre>
  </div>
</div>
</section>

<h2 class='y_details'>Instance Method Details</h2>
<section class='method_details first' id="<<-instance_method">
  <h3 class='signature  first'>
    #<strong>&lt;&lt;</strong>(g)  &#x21d2; <code>Proc</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a proc that is the composition of this proc and the given <em>g</em>. The returned proc takes a variable number of arguments, calls <em>g</em> with them then calls this proc with the result.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>*</span> <span class='id identifier rubyid_x'>x</span> }
<span class='id identifier rubyid_g'>g</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='id identifier rubyid_x'>x</span> }
<span class='id identifier rubyid_p'>p</span> (<span class='id identifier rubyid_f'>f</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_g'>g</span>).<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>2</span>) <span class='comment'>#=&gt; 16</span></code></pre>

<p>See <a href="#>>-instance_method" title="Proc#&gt;&gt; (method)">#&gt;&gt;</a> for detailed explanations.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L3732-L3736'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3732' data-end='3736'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 3732</span></pre>
<pre class='code cpp'>

static VALUE
proc_compose_to_left(VALUE self, VALUE g)
{
    return rb_proc_compose_to_left(self, to_callable(g));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="==-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>==</strong>(other)  &#x21d2; <code>Boolean</code> </span>
      <span class='overload'>#<strong>eql?</strong>(other)  &#x21d2; <code>Boolean</code> </span>
    </div>
    <span class='aliases'>Also known as: <span class='names'>#eql?</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Two procs are the same if, and only if, they were created from the same code block.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_return_block'>return_block</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='id identifier rubyid_block'>block</span>
<span class='kw'>end</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pass_block_twice'>pass_block_twice</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  [<span class='id identifier rubyid_return_block'>return_block</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)<span class='comma'>,</span> <span class='id identifier rubyid_return_block'>return_block</span>(<span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)]
<span class='kw'>end</span>

<span class='id identifier rubyid_block1'>block1</span><span class='comma'>,</span> <span class='id identifier rubyid_block2'>block2</span> <span class='op'>=</span> <span class='id identifier rubyid_pass_block_twice'>pass_block_twice</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }
<span class='comment'># Blocks might be instantiated into Proc&#39;s lazily, so they may, or may not,
</span><span class='comment'># be the same object.
</span><span class='comment'># But they are produced from the same code block, so they are equal
</span><span class='id identifier rubyid_block1'>block1</span> <span class='op'>==</span> <span class='id identifier rubyid_block2'>block2</span>
<span class='comment'>#=&gt; true
</span>
<span class='comment'># Another Proc will never be equal, even if the code is the &quot;same&quot;
</span><span class='id identifier rubyid_block1'>block1</span> <span class='op'>==</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>test</span><span class='tstring_end'>&#39;</span></span> }
<span class='comment'>#=&gt; false</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1305-L1360'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1305' data-end='1360'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1305</span></pre>
<pre class='code cpp'>

static VALUE
proc_eq(VALUE self, VALUE other)
{
    const rb_proc_t *self_proc, *other_proc;
    const struct rb_block *self_block, *other_block;

    if (rb_obj_class(self) !=  rb_obj_class(other)) {
        return Qfalse;
    }

    GetProcPtr(self, self_proc);
    GetProcPtr(other, other_proc);

    if (self_proc-&gt;is_from_method != other_proc-&gt;is_from_method ||
            self_proc-&gt;is_lambda != other_proc-&gt;is_lambda) {
        return Qfalse;
    }

    self_block = &amp;self_proc-&gt;block;
    other_block = &amp;other_proc-&gt;block;

    if (vm_block_type(self_block) != vm_block_type(other_block)) {
        return Qfalse;
    }

    switch (vm_block_type(self_block)) {
      case block_type_iseq:
        if (self_block-&gt;as.captured.ep != \
                other_block-&gt;as.captured.ep ||
                self_block-&gt;as.captured.code.iseq != \
                other_block-&gt;as.captured.code.iseq) {
            return Qfalse;
        }
        break;
      case block_type_ifunc:
        if (self_block-&gt;as.captured.ep != \
                other_block-&gt;as.captured.ep ||
                self_block-&gt;as.captured.code.ifunc != \
                other_block-&gt;as.captured.code.ifunc) {
            return Qfalse;
        }
        break;
      case block_type_proc:
        if (self_block-&gt;as.proc != other_block-&gt;as.proc) {
            return Qfalse;
        }
        break;
      case block_type_symbol:
        if (self_block-&gt;as.symbol != other_block-&gt;as.symbol) {
            return Qfalse;
        }
        break;
    }

    return Qtrue;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="===-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>call</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>[]</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>yield</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>. Invokes the block with <code>obj</code> as the proc’s parameter like <a href="#call-instance_method" title="Proc#call (method)">#call</a>. This allows a proc object to be the target of a <code>when</code> clause in a case statement.</p>

  </div>
</div>
<div class='tags'>
  
</div>

</section>

<section class='method_details' id=">>-instance_method">
  <h3 class='signature '>
    #<strong>&gt;&gt;</strong>(g)  &#x21d2; <code>Proc</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a proc that is the composition of this proc and the given <em>g</em>. The returned proc takes a variable number of arguments, calls this proc with them then calls <em>g</em> with the result.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>*</span> <span class='id identifier rubyid_x'>x</span> }
<span class='id identifier rubyid_g'>g</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='id identifier rubyid_x'>x</span> }
<span class='id identifier rubyid_p'>p</span> (<span class='id identifier rubyid_f'>f</span> <span class='op'>&gt;&gt;</span> <span class='id identifier rubyid_g'>g</span>).<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>2</span>) <span class='comment'>#=&gt; 8</span></code></pre>

<p><em>g</em> could be other <code>Proc</code>, or <a href="Method.html" title="Method (class)"><code>::Method</code></a>, or any other object responding to <a href="#call-instance_method" title="Proc#call (method)">#call</a> method:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Parser</span>
  <span class='kw'>def</span> <span class='kw'>self</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='id identifier rubyid_text'>text</span>)
     <span class='comment'># ...some complicated parsing logic...
</span>  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_pipeline'>pipeline</span> <span class='op'>=</span> <span class='const'><a href="File.html" title="File (class)">File</a></span>.<span class='id identifier rubyid_method'><a href="Object.html#method-instance_method" title="Object#method (method)">method</a></span>(<span class='symbeg'>:</span><span class='id identifier rubyid_read'>read</span>) <span class='op'>&gt;&gt;</span> <span class='const'>Parser</span> <span class='op'>&gt;&gt;</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span> <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data size: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span>.<span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> }
<span class='id identifier rubyid_pipeline'>pipeline</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>data.json</span><span class='tstring_end'>&#39;</span></span>)</code></pre>

<p>See also <a href="Method.html#>>-instance_method" title="Method#&gt;&gt; (method)">Method#&gt;&gt;</a> and <a href="Method.html#<<-instance_method" title="Method#&lt;&lt; (method)">Method#&lt;&lt;</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L3791-L3795'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3791' data-end='3795'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 3791</span></pre>
<pre class='code cpp'>

static VALUE
proc_compose_to_right(VALUE self, VALUE g)
{
    return rb_proc_compose_to_right(self, to_callable(g));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="[]-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>call</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>[]</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>yield</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
    </div>
    <span class='aliases'>Also known as: <span class='names'>#call, #===, #yield</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Invokes the block, setting the block’s parameters to the values in <em>params</em> using something close to method calling semantics. Returns the value of the last expression evaluated in the block.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a_proc'>a_proc</span> <span class='op'>=</span> <span class='const'>Proc</span>.<span class='id identifier rubyid_new'><a href="#new-class_method" title="Proc.new (method)">new</a></span> {<span class='op'>|</span><span class='id identifier rubyid_scalar'>scalar</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_values'>values</span><span class='op'>|</span> <span class='id identifier rubyid_values'>values</span>.<span class='id identifier rubyid_map'>map</span> {<span class='op'>|</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span> <span class='id identifier rubyid_value'>value</span><span class='op'>*</span><span class='id identifier rubyid_scalar'>scalar</span> } }
<span class='id identifier rubyid_a_proc'>a_proc</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>9</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>)    <span class='comment'>#=&gt; [9, 18, 27]
</span><span class='id identifier rubyid_a_proc'>a_proc</span>[<span class='int'>9</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>]         <span class='comment'>#=&gt; [9, 18, 27]
</span><span class='id identifier rubyid_a_proc'>a_proc</span>.(<span class='int'>9</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>)        <span class='comment'>#=&gt; [9, 18, 27]
</span><span class='id identifier rubyid_a_proc'>a_proc</span>.<span class='id identifier rubyid_yield'><a href="#yield-instance_method" title="Proc#yield (method)">yield</a></span>(<span class='int'>9</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='comma'>,</span> <span class='int'>3</span>)   <span class='comment'>#=&gt; [9, 18, 27]</span></code></pre>

<p>Note that <code>prc.()</code> invokes <code>prc.call()</code> with the parameters given.  It’s syntactic sugar to hide “call”.</p>

<p>For procs created using <code>#lambda</code> or <code>-&gt;()</code> an error is generated if the wrong number of parameters are passed to the proc.  For procs created using <a href="#new-class_method" title="Proc.new (method)">.new</a> or <a href="Kernel.html#proc-class_method" title="Kernel.proc (method)">Kernel.proc</a>, extra parameters are silently discarded and missing parameters are set to <code>nil</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_a_proc'>a_proc</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }
<span class='id identifier rubyid_a_proc'>a_proc</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)   <span class='comment'>#=&gt; [1, nil]
</span>
<span class='id identifier rubyid_a_proc'>a_proc</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> [<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span>] }
<span class='id identifier rubyid_a_proc'>a_proc</span>.<span class='id identifier rubyid_call'><a href="#call-instance_method" title="Proc#call (method)">call</a></span>(<span class='int'>1</span>)   <span class='comment'># ArgumentError: wrong number of arguments (given 1, expected 2)</span></code></pre>

<p>See also <a href="#lambda%3F-instance_method" title="Proc#lambda? (method)">#lambda?</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L966-L970'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='966' data-end='970'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 966</span></pre>
<pre class='code cpp'>

static VALUE
proc_call(int argc, VALUE *argv, VALUE procval)
{
    /* removed */
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="arity-instance_method">
  <h3 class='signature '>
    #<strong>arity</strong>  &#x21d2; <a href="Integer.html" title="Integer (class)">Integer</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the number of mandatory arguments. If the block is declared to take no arguments, returns 0. If the block is known to take exactly n arguments, returns n. If the block has optional arguments, returns -n-1, where n is the number of mandatory arguments, with the exception for blocks that are not lambdas and have only a finite number of optional arguments; in this latter case, returns n. Keyword arguments will be considered as a single additional argument, that argument being mandatory if any keyword argument is mandatory. A <code>#proc</code> with no argument declarations is the same as a block declaring <code>||</code> as its arguments.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_proc'>proc</span> {}.<span class='id identifier rubyid_arity'>arity</span>                  <span class='comment'>#=&gt;  0
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>              <span class='comment'>#=&gt;  0
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>             <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>          <span class='comment'>#=&gt;  2
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>       <span class='comment'>#=&gt;  3
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>            <span class='comment'>#=&gt; -1
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>         <span class='comment'>#=&gt; -2
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>      <span class='comment'>#=&gt; -3
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='label'>x:</span><span class='comma'>,</span> <span class='label'>y:</span><span class='comma'>,</span> <span class='label'>z:</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>   <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_proc'>proc</span> { <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>x:</span><span class='comma'>,</span> <span class='label'>y:</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>   <span class='comment'>#=&gt; -2
</span>
<span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>         <span class='comment'>#=&gt;  0
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>         <span class='comment'>#=&gt; -1
</span><span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>      <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>      <span class='comment'>#=&gt; -2
</span><span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>    <span class='comment'>#=&gt;  0
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>=</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>    <span class='comment'>#=&gt; -1
</span><span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>      <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span>      <span class='comment'>#=&gt; -2
</span><span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)<span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span> <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span>(<span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>)<span class='comma'>,</span> <span class='id identifier rubyid_c'>c</span><span class='op'>=</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span> <span class='comment'>#=&gt; -2
</span><span class='id identifier rubyid_proc'>proc</span>   { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>x:</span><span class='int'>0</span><span class='comma'>,</span> <span class='label'>y:</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span> <span class='comment'>#=&gt;  1
</span><span class='id identifier rubyid_lambda'>lambda</span> { <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>x:</span><span class='int'>0</span><span class='comma'>,</span> <span class='label'>y:</span><span class='int'>0</span><span class='op'>|</span> }.<span class='id identifier rubyid_arity'>arity</span> <span class='comment'>#=&gt; -2</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1074-L1079'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1074' data-end='1079'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1074</span></pre>
<pre class='code cpp'>

static VALUE
proc_arity(VALUE self)
{
    int arity = rb_proc_arity(self);
    return INT2FIX(arity);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="binding-instance_method">
  <h3 class='signature '>
    #<strong>binding</strong>  &#x21d2; <a href="Binding.html" title="Binding (class)">Binding</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the binding associated with <em>prc</em>.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_fred'>fred</span>(<span class='id identifier rubyid_param'>param</span>)
  <span class='id identifier rubyid_proc'>proc</span> {}
<span class='kw'>end</span>

<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_fred'>fred</span>(<span class='int'>99</span>)
<span class='id identifier rubyid_eval'>eval</span>(<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>param</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_binding'>binding</span>)   <span class='comment'>#=&gt; 99</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L3469-L3537'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3469' data-end='3537'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 3469</span></pre>
<pre class='code cpp'>

static VALUE
proc_binding(VALUE self)
{
    VALUE bindval, binding_self = Qundef;
    rb_binding_t *bind;
    const rb_proc_t *proc;
    const rb_iseq_t *iseq = NULL;
    const struct rb_block *block;
    const rb_env_t *env = NULL;

    GetProcPtr(self, proc);
    block = &amp;proc-&gt;block;

    if (proc-&gt;is_isolated) rb_raise(rb_eArgError, &quot;Can&#39;t create Binding from isolated Proc&quot;);

  again:
    switch (vm_block_type(block)) {
      case block_type_iseq:
        iseq = block-&gt;as.captured.code.iseq;
        binding_self = block-&gt;as.captured.self;
        env = VM_ENV_ENVVAL_PTR(block-&gt;as.captured.ep);
        break;
      case block_type_proc:
        GetProcPtr(block-&gt;as.proc, proc);
        block = &amp;proc-&gt;block;
        goto again;
      case block_type_ifunc:
        {
            const struct vm_ifunc *ifunc = block-&gt;as.captured.code.ifunc;
            if (IS_METHOD_PROC_IFUNC(ifunc)) {
                VALUE method = (VALUE)ifunc-&gt;data;
                VALUE name = rb_fstring_lit(&quot;&lt;empty_iseq&gt;&quot;);
                rb_iseq_t *empty;
                binding_self = method_receiver(method);
                iseq = rb_method_iseq(method);
                env = VM_ENV_ENVVAL_PTR(block-&gt;as.captured.ep);
                env = env_clone(env, method_cref(method));
                /* set empty iseq */
                empty = rb_iseq_new(NULL, name, name, Qnil, 0, ISEQ_TYPE_TOP);
                RB_OBJ_WRITE(env, &amp;env-&gt;iseq, empty);
                break;
            }
        }
        /* FALLTHROUGH */
      case block_type_symbol:
        rb_raise(rb_eArgError, &quot;Can&#39;t create Binding from C level Proc&quot;);
        UNREACHABLE_RETURN(Qnil);
    }

    bindval = rb_binding_alloc(rb_cBinding);
    GetBindingPtr(bindval, bind);
    RB_OBJ_WRITE(bindval, &amp;bind-&gt;block.as.captured.self, binding_self);
    RB_OBJ_WRITE(bindval, &amp;bind-&gt;block.as.captured.code.iseq, env-&gt;iseq);
    rb_vm_block_ep_update(bindval, &amp;bind-&gt;block, env-&gt;ep);
    RB_OBJ_WRITTEN(bindval, Qundef, VM_ENV_ENVVAL(env-&gt;ep));

    if (iseq) {
        rb_iseq_check(iseq);
        RB_OBJ_WRITE(bindval, &amp;bind-&gt;pathobj, ISEQ_BODY(iseq)-&gt;location.pathobj);
        bind-&gt;first_lineno = ISEQ_BODY(iseq)-&gt;location.first_lineno;
    }
    else {
        RB_OBJ_WRITE(bindval, &amp;bind-&gt;pathobj,
                     rb_iseq_pathobj_new(rb_fstring_lit(&quot;(binding)&quot;), Qnil));
        bind-&gt;first_lineno = 1;
    }

    return bindval;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="call-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>call</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>[]</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>yield</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>

</section>

<section class='method_details' id="clone-instance_method">
  <h3 class='signature nodoc'>
    #<strong>clone</strong>  
  </h3>
  <div class='note nodoc inline-block'>
    <strong>This method is for internal use only.</strong>
  </div><div></div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L181-L187'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='181' data-end='187'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 181</span></pre>
<pre class='code cpp'>

static VALUE
proc_clone(VALUE self)
{
    VALUE procval = rb_proc_dup(self);
    CLONESETUP(procval, self);
    return procval;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="curry-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>curry</strong>  &#x21d2; <code>Proc</code> </span>
      <span class='overload'>#<strong>curry</strong>(arity)  &#x21d2; <code>Proc</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a curried proc. If the optional <em>arity</em> argument is given, it determines the number of arguments. A curried proc receives some arguments. If a sufficient number of arguments are supplied, it passes the supplied arguments to the original proc and returns the result. Otherwise, returns another curried proc that takes the rest of arguments.</p>

<p>The optional <em>arity</em> argument should be supplied when currying procs with variable arguments to determine how many arguments are needed before the proc is called.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='op'>|</span> (<span class='id identifier rubyid_x'>x</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_y'>y</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_z'>z</span><span class='op'>||</span><span class='int'>0</span>) }
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>]           <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]        <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>][<span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>1</span>)[<span class='int'>1</span>]              <span class='comment'>#=&gt; 1
</span>
<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span> (<span class='id identifier rubyid_x'>x</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_y'>y</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_z'>z</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> <span class='id identifier rubyid_w'>w</span>.<span class='id identifier rubyid_inject'>inject</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbeg'>:</span><span class='op'>+</span>) }
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>]           <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]        <span class='comment'>#=&gt; 10
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>][<span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 15
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 15
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>1</span>)[<span class='int'>1</span>]              <span class='comment'>#=&gt; 1
</span>
<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='op'>|</span> (<span class='id identifier rubyid_x'>x</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_y'>y</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_z'>z</span><span class='op'>||</span><span class='int'>0</span>) }
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>]           <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]        <span class='comment'>#=&gt; wrong number of arguments (given 4, expected 3)
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)                 <span class='comment'>#=&gt; wrong number of arguments (given 5, expected 3)
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>1</span>)                 <span class='comment'>#=&gt; wrong number of arguments (given 1, expected 3)
</span>
<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> {<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='comma'>,</span> <span class='id identifier rubyid_z'>z</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_w'>w</span><span class='op'>|</span> (<span class='id identifier rubyid_x'>x</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_y'>y</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> (<span class='id identifier rubyid_z'>z</span><span class='op'>||</span><span class='int'>0</span>) <span class='op'>+</span> <span class='id identifier rubyid_w'>w</span>.<span class='id identifier rubyid_inject'>inject</span>(<span class='int'>0</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbeg'>:</span><span class='op'>+</span>) }
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>]           <span class='comment'>#=&gt; 6
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>]        <span class='comment'>#=&gt; 10
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span>][<span class='int'>2</span>][<span class='int'>3</span>][<span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 15
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>5</span>)[<span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span>][<span class='int'>3</span><span class='comma'>,</span> <span class='int'>4</span>][<span class='int'>5</span>]  <span class='comment'>#=&gt; 15
</span><span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>(<span class='int'>1</span>)                 <span class='comment'>#=&gt; wrong number of arguments (given 1, expected 3)
</span>
<span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> { <span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span> }
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_b'>b</span>.<span class='id identifier rubyid_curry'>curry</span>[]                  <span class='comment'>#=&gt; :foo</span></code></pre>

  </div>
</div>
<div class='tags'>
  
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L3627-L3644'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3627' data-end='3644'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 3627</span></pre>
<pre class='code cpp'>

static VALUE
proc_curry(int argc, const VALUE *argv, VALUE self)
{
    int sarity, max_arity, min_arity = rb_proc_min_max_arity(self, &amp;max_arity);
    VALUE arity;

    if (rb_check_arity(argc, 0, 1) == 0 || NIL_P(arity = argv[0])) {
        arity = INT2FIX(min_arity);
    }
    else {
        sarity = FIX2INT(arity);
        if (rb_proc_lambda_p(self)) {
            rb_check_arity(sarity, min_arity, max_arity);
        }
    }

    return make_curry_proc(self, rb_ary_new(), arity);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="dup-instance_method">
  <h3 class='signature '>
    #<strong>dup</strong>  
  </h3>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/vm.c#L1075-L1086'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1075' data-end='1086'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'vm.c', line 1075</span></pre>
<pre class='code cpp'>

VALUE
rb_proc_dup(VALUE self)
{
    VALUE procval;
    rb_proc_t *src;

    GetProcPtr(self, src);
    procval = proc_create(rb_obj_class(self), &amp;src-&gt;block, src-&gt;is_from_method, src-&gt;is_lambda);
    if (RB_OBJ_SHAREABLE_P(self)) FL_SET_RAW(procval, RUBY_FL_SHAREABLE);
    RB_GC_GUARD(self); /* for: body = rb_proc_dup(body) */
    return procval;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="eql?-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>==</strong>(other)  &#x21d2; <code>Boolean</code> </span>
      <span class='overload'>#<strong>eql?</strong>(other)  &#x21d2; <code>Boolean</code> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#==-instance_method" title="Proc#== (method)">#==</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>

</section>

<section class='method_details' id="hash-instance_method">
  <h3 class='signature '>
    #<strong>hash</strong>  &#x21d2; <a href="Integer.html" title="Integer (class)">Integer</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns a hash value corresponding to proc body.</p>

<p>See also <a href="Object.html#hash-instance_method" title="Object#hash (method)">Object#hash</a>.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1525-L1533'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1525' data-end='1533'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1525</span></pre>
<pre class='code cpp'>

static VALUE
proc_hash(VALUE self)
{
    st_index_t hash;
    hash = rb_hash_start(0);
    hash = rb_hash_proc(hash, self);
    hash = rb_hash_end(hash);
    return ST2FIX(hash);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="inspect-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>to_s</strong>  &#x21d2; <a href="String.html" title="String (class)">String</a> </span>
      <span class='overload'>#<strong>inspect</strong>  &#x21d2; <a href="String.html" title="String (class)">String</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#to_s-instance_method" title="Proc#to_s (method)">#to_s</a>.</p>

  </div>
</div>

</section>

<section class='method_details' id="parameters-instance_method">
  <h3 class='signature '>
    #<strong>parameters</strong>(lambda: nil)  &#x21d2; <a href="Array.html" title="Array (class)">Array</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the parameter information of this proc.  If the lambda keyword is provided and not nil, treats the proc as a lambda if true and as a non-lambda if false.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_prc'>prc</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span>{<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>=</span><span class='int'>42</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='op'>|</span>}
<span class='id identifier rubyid_prc'>prc</span>.<span class='id identifier rubyid_parameters'>parameters</span>  <span class='comment'>#=&gt; [[:opt, :x], [:opt, :y], [:rest, :other]]
</span><span class='id identifier rubyid_prc'>prc</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span>{<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>=</span><span class='int'>42</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='op'>|</span>}
<span class='id identifier rubyid_prc'>prc</span>.<span class='id identifier rubyid_parameters'>parameters</span>  <span class='comment'>#=&gt; [[:req, :x], [:opt, :y], [:rest, :other]]
</span><span class='id identifier rubyid_prc'>prc</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span>{<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>=</span><span class='int'>42</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='op'>|</span>}
<span class='id identifier rubyid_prc'>prc</span>.<span class='id identifier rubyid_parameters'>parameters</span>(<span class='label'>lambda:</span> <span class='kw'>true</span>)  <span class='comment'>#=&gt; [[:req, :x], [:opt, :y], [:rest, :other]]
</span><span class='id identifier rubyid_prc'>prc</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span>{<span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='comma'>,</span> <span class='id identifier rubyid_y'>y</span><span class='op'>=</span><span class='int'>42</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='op'>|</span>}
<span class='id identifier rubyid_prc'>prc</span>.<span class='id identifier rubyid_parameters'>parameters</span>(<span class='label'>lambda:</span> <span class='kw'>false</span>) <span class='comment'>#=&gt; [[:opt, :x], [:opt, :y], [:rest, :other]]</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1432-L1460'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1432' data-end='1460'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1432</span></pre>
<pre class='code cpp'>

static VALUE
rb_proc_parameters(int argc, VALUE *argv, VALUE self)
{
    static ID keyword_ids[1];
    VALUE opt, lambda;
    VALUE kwargs[1];
    int is_proc ;
    const rb_iseq_t *iseq;

    iseq = rb_proc_get_iseq(self, &amp;is_proc);

    if (!keyword_ids[0]) {
        CONST_ID(keyword_ids[0], &quot;lambda&quot;);
    }

    rb_scan_args(argc, argv, &quot;0:&quot;, &amp;opt);
    if (!NIL_P(opt)) {
        rb_get_kwargs(opt, keyword_ids, 0, 1, kwargs);
        lambda = kwargs[0];
        if (!NIL_P(lambda)) {
            is_proc = !RTEST(lambda);
        }
    }

    if (!iseq) {
        return rb_unnamed_parameters(rb_proc_arity(self));
    }
    return rb_iseq_parameters(iseq, is_proc);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="ruby2_keywords-instance_method">
  <h3 class='signature '>
    #<strong>ruby2_keywords</strong>  &#x21d2; <code>Proc</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Marks the proc as passing keywords through a normal argument splat. This should only be called on procs that accept an argument splat (<code>*args</code>) but not explicit keywords or a keyword splat.  It marks the proc such that if the proc is called with keyword arguments, the final hash argument is marked with a special flag such that if it is the final element of a normal argument splat to another method call, and that method call does not include explicit keywords or a keyword splat, the final element is interpreted as keywords.  In other words, keywords will be passed through the proc to other methods.</p>

<p>This should only be used for procs that delegate keywords to another method, and only for backwards compatibility with Ruby versions before 2.7.</p>

<p>This method will probably be removed at some point, as it exists only for backwards compatibility. As it does not exist in Ruby versions before 2.7, check that the proc responds to this method before calling it. Also, be aware that if this method is removed, the behavior of the proc will change so that it does not pass through keywords.</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>module</span> <span class='const'>Mod</span>
  <span class='id identifier rubyid_foo'>foo</span> <span class='op'>=</span> <span class='tlambda'>-&gt;</span>(<span class='id identifier rubyid_meth'>meth</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>) <span class='kw'>do</span>
    <span class='id identifier rubyid_send'>send</span>(<span class='symbeg'>:&quot;</span><span class='tstring_content'>do_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_meth'>meth</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>)
  <span class='kw'>end</span>
  <span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_ruby2_keywords'>ruby2_keywords</span> <span class='kw'>if</span> <span class='id identifier rubyid_foo'>foo</span>.<span class='id identifier rubyid_respond_to?'>respond_to?</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_ruby2_keywords'>ruby2_keywords</span>)
<span class='kw'>end</span></code></pre>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L3898-L3928'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='3898' data-end='3928'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 3898</span></pre>
<pre class='code cpp'>

static VALUE
proc_ruby2_keywords(VALUE procval)
{
    rb_proc_t *proc;
    GetProcPtr(procval, proc);

    rb_check_frozen(procval);

    if (proc-&gt;is_from_method) {
            rb_warn(&quot;Skipping set of ruby2_keywords flag for proc (proc created from method)&quot;);
            return procval;
    }

    switch (proc-&gt;block.type) {
      case block_type_iseq:
        if (ISEQ_BODY(proc-&gt;block.as.captured.code.iseq)-&gt;param.flags.has_rest &amp;&amp;
                !ISEQ_BODY(proc-&gt;block.as.captured.code.iseq)-&gt;param.flags.has_kw &amp;&amp;
                !ISEQ_BODY(proc-&gt;block.as.captured.code.iseq)-&gt;param.flags.has_kwrest) {
            ISEQ_BODY(proc-&gt;block.as.captured.code.iseq)-&gt;param.flags.ruby2_keywords = 1;
        }
        else {
            rb_warn(&quot;Skipping set of ruby2_keywords flag for proc (proc accepts keywords or proc does not accept argument splat)&quot;);
        }
        break;
      default:
        rb_warn(&quot;Skipping set of ruby2_keywords flag for proc (proc not defined in Ruby)&quot;);
        break;
    }

    return procval;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="source_location-instance_method">
  <h3 class='signature '>
    #<strong>source_location</strong>  &#x21d2; <a href="Array.html" title="Array (class)">Array</a>, <a href="Integer.html" title="Integer (class)">Integer</a>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the Ruby source filename and line number containing this proc or <code>nil</code> if this proc was not defined in Ruby (i.e. native).</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1389-L1393'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1389' data-end='1393'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1389</span></pre>
<pre class='code cpp'>

VALUE
rb_proc_location(VALUE self)
{
    return iseq_location(rb_proc_get_iseq(self, 0));
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_proc-instance_method">
  <h3 class='signature '>
    #<strong>to_proc</strong>  &#x21d2; <code>Proc</code>   </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Part of the protocol for converting objects to <code>Proc</code> objects. Instances of class <code>Proc</code> simply return themselves.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1591-L1595'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1591' data-end='1595'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1591</span></pre>
<pre class='code cpp'>

static VALUE
proc_to_proc(VALUE self)
{
    return self;
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="to_s-instance_method">
  <h3 class='signature '>
    #<strong>to_s</strong>  &#x21d2; <a href="String.html" title="String (class)">String</a>     <span class='aliases'>Also known as: <span class='names'>#inspect</span></span>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Returns the unique identifier for this proc, along with an indication of where the proc was defined.</p>

  </div>
</div>
  <span class='link_repo'>[&#8202;<a class='repo' href='https://github.com/ruby/ruby/blob/v3_2_3/proc.c#L1575-L1581'>GitHub</a>&#8202;]</span>
<div class='source_code h'>
  <pre class='lines_num' data-start='1575' data-end='1581'></pre>
  <div class='lines_code'>
<pre><span class='info file'># File 'proc.c', line 1575</span></pre>
<pre class='code cpp'>

static VALUE
proc_to_s(VALUE self)
{
    const rb_proc_t *proc;
    GetProcPtr(self, proc);
    return rb_block_to_s(self, &amp;proc-&gt;block, proc-&gt;is_lambda ? &quot; (lambda)&quot; : NULL);
}
</pre>
  </div>
</div>
</section>

<section class='method_details' id="yield-instance_method">
  <h3 class='signature '>
    <div class='inline-block'>
      <span class='overload'>#<strong>call</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>[]</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
      <span class='overload'>#<strong>yield</strong>(params,...)  &#x21d2; <a href="Object.html" title="Object (class)">Object</a> </span>
    </div>
  </h3>
<div class='docstring'>
  <div class='discussion'>
    
<p>Alias for <a href="#[]-instance_method" title="Proc#[] (method)">#[]</a>.</p>

  </div>
</div>
<div class='tags'>
  
</div>

</section>


<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>