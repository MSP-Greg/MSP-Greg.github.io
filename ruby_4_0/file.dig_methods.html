<!DOCTYPE html>
<html>
<head>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=no'>
<meta name='apple-touch-fullscreen' content='yes'>
<meta name='mobile-web-app-capable' content='yes'>
<meta name='apple-mobile-web-app-status-bar-style' content='rgba(228,228,228,1.0)'>

<title>File: Dig Methods &mdash; Ruby-4.0.1</title>

<link rel='stylesheet'  type='text/css' href='../css/y_fonts.css' />
<link rel='stylesheet'  type='text/css' href='../css/highlight.github.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_style.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_list.css' />
<link rel='stylesheet'  type='text/css' href='../css/y_color.css' />

<script type='text/javascript'>
  var pathId = "dig_methods",
    relpath = '';

  var t2Info = {
    CSEP: '.',
    ISEP: '#',
    NSEP: '::'
  };
</script>

<script type='text/javascript' charset='utf-8' src='../js/highlight.pack.js'></script>
<script type='text/javascript' charset='utf-8' src='../js/y_app.js'></script>

</head>
<body>
<svg id='y_wait' class viewBox='0 0 90 90'></svg>
<div id='settings' class='hidden'></div>
<div id='y_list' class='d h'>
  <header id='list_header'></header>
  <nav id= 'list_nav' class='y_nav l_nav'>
    <ul id='list_items'></ul>
  </nav>
</div>
<div id='y_toc' class='f h'>
  <header id='toc_header'></header>
  <nav id= 'toc_nav' class='y_nav t_nav'>
  <ol id='toc_items'></ol>
  </nav>
</div>
<div id='y_main' tabindex='-1'>
  <header id='y_header'>
    <div id='y_menu'>
      <a id='home_no_xhr' href='/'>Home</a> &raquo; 
      <a href='.'>Ruby-4.0.1</a> &raquo; 
      <a href='_index.html'>Index</a> &raquo; 
      <span class='title'><a id='t2_doc_top' href='#'>File: Dig Methods&nbsp;&#x25B2;</a></span>
          </div>

    <a id='list_href' href="file_list.html"></a>
    <div id='y_measure_em' class='y_measure'></div>
    <div id='y_measure_vh' class='y_measure'></div>
    <span id='y_measure_50pre' class='y_measure'><code>123456789_123456789_123456789_123456789_123456789_</code></span>
  </header>
<div id='content' class='file'>

<h1 id="label-Dig+Methods">Dig Methods</h1>

<p>Ruby’s <code>dig</code> methods are useful for accessing nested data structures.</p>

<p>Consider this data:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_item'>item</span> <span class='op'>=</span> {
  <span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0001</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>donut</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cake</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='label'>ppu:</span> <span class='float'>0.55</span><span class='comma'>,</span>
  <span class='label'>batters:</span> {
    <span class='label'>batter:</span> [
      {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1001</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Regular</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
      {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1002</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Chocolate</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
      {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1003</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Blueberry</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
      {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1004</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Devil&#39;s Food</span><span class='tstring_end'>&quot;</span></span>}
    ]
  }<span class='comma'>,</span>
  <span class='label'>topping:</span> [
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5001</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>None</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5002</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Glazed</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5005</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sugar</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5007</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Powdered Sugar</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5006</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Chocolate with Sprinkles</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5003</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Chocolate</span><span class='tstring_end'>&quot;</span></span>}<span class='comma'>,</span>
    {<span class='label'>id:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>5004</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Maple</span><span class='tstring_end'>&quot;</span></span>}
  ]
}</code></pre>

<p>Without a <code>dig</code> method, you can write:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_item'>item</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_batters'>batters</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_batter'>batter</span>][<span class='int'>1</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>] <span class='comment'># =&gt; &quot;Chocolate&quot;</span></code></pre>

<p>With a <code>dig</code> method, you can write:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_batters'>batters</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_batter'>batter</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>) <span class='comment'># =&gt; &quot;Chocolate&quot;</span></code></pre>

<p>Without a <code>dig</code> method, you can write, erroneously (raises <code>NoMethodError (undefined method `[]&#39; for nil:NilClass)</code>):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_item'>item</span>[<span class='symbeg'>:</span><span class='id identifier rubyid_batters'>batters</span>][<span class='symbeg'>:</span><span class='const'>BATTER</span>][<span class='int'>1</span>][<span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>]</code></pre>

<p>With a <code>dig</code> method, you can write (still erroneously, but avoiding the exception):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_item'>item</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_batters'>batters</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='const'>BATTER</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_type'>type</span>) <span class='comment'># =&gt; nil</span></code></pre>

<h2 id="label-Why+Is+dig+Better-3F">Why Is <code>dig</code> Better?</h2>
<ul><li>
<p>It has fewer syntactical elements (to get wrong).</p>
</li><li>
<p>It reads better.</p>
</li><li>
<p>It does not raise an exception if an item is not found.</p>
</li></ul>

<h2 id="label-How+Does+dig+Work-3F">How Does <code>dig</code> Work?</h2>

<p>The call sequence is:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_obj'>obj</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='op'>*</span><span class='id identifier rubyid_identifiers'>identifiers</span>)</code></pre>

<p>The <code>identifiers</code> define a “path” into the nested data structures:</p>
<ul><li>
<p>For each identifier in <code>identifiers</code>, calls method #dig on a receiver with that identifier.</p>
</li><li>
<p>The first receiver is <code>self</code>.</p>
</li><li>
<p>Each successive receiver is the value returned by the previous call to <code>dig</code>.</p>
</li><li>
<p>The value finally returned is the value returned by the last call to <code>dig</code>.</p>
</li></ul>

<p>A <code>dig</code> method raises an exception if any receiver does not respond to #dig:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_h'>h</span> <span class='op'>=</span> { <span class='label'>foo:</span> <span class='int'>1</span> }
<span class='comment'># Raises TypeError (Integer does not have #dig method):
</span><span class='id identifier rubyid_h'>h</span>.<span class='id identifier rubyid_dig'>dig</span>(<span class='symbeg'>:</span><span class='id identifier rubyid_foo'>foo</span><span class='comma'>,</span> <span class='symbeg'>:</span><span class='id identifier rubyid_bar'>bar</span>)</code></pre>

<h2 id="label-What+Else-3F">What Else?</h2>

<p>The structure above has Hash objects and Array objects, both of which have instance method <code>dig</code>.</p>

<p>Altogether there are six built-in Ruby classes that have method <code>dig</code>, three in the core classes and three in the standard library.</p>

<p>In the core:</p>
<ul><li>
<p>Array#dig: the first argument is an Integer index.</p>
</li><li>
<p>Hash#dig: the first argument is a key.</p>
</li><li>
<p>Struct#dig: the first argument is a key.</p>
</li></ul>

<p>In the standard library:</p>
<ul><li>
<p>OpenStruct#dig: the first argument is a String name.</p>
</li><li>
<p>CSV::Table#dig: the first argument is an Integer index or a String header.</p>
</li><li>
<p>CSV::Row#dig: the first argument is an Integer index or a String header.</p>
</li></ul>

<div id='footer'></div>
</div> <!-- content  -->
</div> <!-- y_main   -->
</body>
</html>